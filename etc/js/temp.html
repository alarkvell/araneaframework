<html><head>
<meta content="application/xhtml+xml; charset=UTF-8" http-equiv="Content-Type"/>
<title>Aranea Template Application Login Screen</title></head>
<script>
function AraneaStore() {
  var objects = new Array();

  this.add = function(object) {
    var len = objects.length;
	objects[len] = object;
  }
  
  this.clear = function() {
  	objects = new Array();
  }
  
  this.length = function() {
    return objects.length;
  }

  this.getContents = function() {
    return objects;
  }
  
  this.forEach = function(f) {
    for(var i = 0; i < objects.length; i++) {
      f(objects[i]);
    }
  }
}

AraneaEventStore.prototype = new AraneaStore();
function AraneaEventStore() {
  var that = this;

  var processEvent = function(event) {
    if (typeof event != "function") {
      event;
    } else {
      event();
    }
  }

  this.execute = function() {
    that.forEach(processEvent);
    that.clear();
  }
}

// AraneaPage object is present on each page served by Aranea and contains common
// functionality for setting page related variables, events and functions.
function AraneaPage() {
  /** Variable that shows if page is active (form has not been submitted yet). */
  var pageActive = true;

  /** Variables holding different (un)load events that should be executed when page loads (body unload or alike) */
  var systemLoadEvents = new AraneaEventStore();
  var clientLoadEvents = new AraneaEventStore();
  var systemUnLoadEvents = new AraneaEventStore();

  loadEvents = new AraneaStore();
  loadEvents.add(systemLoadEvents);
  loadEvents.add(clientLoadEvents);
  
  unloadEvents = new AraneaStore();
  unloadEvents.add(systemUnLoadEvents);

  /** Return whether this page is active (has not been submitted yet). */
  this.isPageActive = function() {
    return pageActive;
  }

  /** Sets page status. */
  this.setPageActive = function(active) {
    if (typeof active == "boolean")
      pageActive = active;
  }

  this.addClientLoadEvent = function(event) {
  	clientLoadEvents.add(event);
	document.getElementsbytagnamen
  }
  
  this.addSystemLoadEvent = function(event) {
  	systemLoadEvents.add(event);
  } 
  
  this.onload = function() {
    loadEvents.forEach(function(eventHolder) {eventHolder.execute();});
  }

  this.onunload = function() {
    unloadEvents.forEach(function(eventHolder) {eventHolder.execute();});
  }
}

AraneaPage.prototype.submit = function(element, submitter) {
  submitter(element);
}

AraneaPage.prototype.standardSubmit = function(element) {
/*
  var w = window.open('', 'debug', 'width=1000,height=800,scrollbars=yes');
  w.document.write(element);

  w.document.write('<br />');
  for (var i in element) {
  	w.document.write("property '" + i+ "'=" + element[i]);
	w.document.write('<br />');
  }

  w.document.write("----------TRAVERSING---------------------------------");
  w.document.write('<br />');
  */
/*
	var i = 0;
  
  var pNode = element.parentNode;
  while (pNode) {
  	w.document.write(pNode.tagName);
	pNode = pNode.parentNode;
  	w.document.write('<br />');
  } 
  
  w.document.write('searching surrounding systemform');*/
  var t = new AraneaTraverser();
  var systemForm = t.findSurroundingSystemForm(element);
  
  /*w.document.write('teh systemform ' + systemForm +  '<br />');
  
  for (var i in systemForm) {
  	w.document.write("property '" + i+ "'=" + systemForm[i]);
	w.document.write('<br />');
  } */
}
  
function AraneaTraverser() {
  this.findSurroundingSystemForm = function(element) {
    if (element.getAttributeNS("http://www.araneaframework.org/", "systemForm"))
	  return element;

    var pNode = element.parentNode;
    while (pNode) {
      if (pNode.tagName == 'FORM') {
	//alert(pNode["systemForm"]);

         var w = window.open('', 'aaaa', 'width=1000,height=800,scrollbars=yes');
         for (var z in pNode) {
   		w.document.write(z + ' = ' + pNode[z] + '<br />');
		if (typeof pNode[z] == 'function') {
		    try {
 			if (z != 'submit')
				w.document.write('executed ' + z + '() = ' + pNode[z]() + '<br />');
                    } catch (e) {}
 		}
         }

	 for (var a in pNode.attributes) {
		w.document.write(pNode[a]);
		}
	  w.document.write('dom dom dom dam dam duuh' + '<br />');
	  w.document.write("pNode['arn:systemForm]'=" + pNode['arn:systemForm']+ '<br />');
	  w.document.write("pNode['enctype']=" + pNode['enctype']+ '<br />');
	  w.document.write("pNode['name']=" + pNode['name']+ '<br />');
	  w.document.write("pNode['method']=" + pNode['method']+ '<br />');
	  w.document.write("pNode['action']=" + pNode['action']+ '<br />');

         alert(pNode.hasAttribute("arn-systemForm"));
      }
      
  	  pNode = pNode.parentNode;
    }
	return null;
  }
}
  
/*		systemForm, 
		widgetId, 
		eventId, 
		eventParam, */ 

// new aranea page
_ap = new AraneaPage();


</script>
<body><form id="system_form_0" name="system_form_0" method="post" accept-charset="UTF-8" action="/mainExample/main" style="margin: 0px" onsubmit="javascript:return false" arn-systemForm="true">
<input name="topServiceId" type="hidden" value="application"/>
<input name="transactionId" type="hidden" value="-5358051433540041611"/>
<input name="threadServiceId" type="hidden" value="mainThread"/>
<input name="widgetEventHandler" type="hidden" value=""/>
<input name="widgetEventPath" type="hidden" value=""/>
<input name="widgetEventParameter" type="hidden" value=""/>
<div id="outer"><div id="middle"><div id="inner"><div class="login"><div id="login-logo"><img class="aranea-image" src="http://localhost:2000/mainExample/main/fileimporter/gfx/logo_aranea_login.jpg" border="0"/></div><div class="a"><arn:f><span id="fe-span-0">
<span><label for="r.f.loginForm.username">User:</label></span>
</span><arn:fe><span id="fe-span-1">
<input id="r.f.loginForm.username" name="r.f.loginForm.username" class="aranea-text usr" type="text" label="User" maxLength="null"/></span></arn:fe><span id="fe-span-2">
<span><label for="r.f.loginForm.password">Password:</label></span>

</span><arn:fe><span id="fe-span-3">
<input id="r.f.loginForm.password" name="r.f.loginForm.password" class="aranea-text pwd" type="password" label="Password" maxLength="null"/></span></arn:fe><div class="clear1">&nbsp;</div><div class="actions"><button class="aranea-button" arn:eventId="login" onclick="_ap.submit(this, _ap.standardSubmit);">Login</button>
<button id="bypassButton" class="aranea-button" arn:eventId="bypass" onclick="_ap.submit(this, _ap.standardSubmit);">Bypass login</button>
</div><div class="clear1">&nbsp;</div></arn:f></div></div></div></div></div></form>
</body></html>
