<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Aranea&#8212;Java Web Framework Construction and Integration Kit</title><link rel="stylesheet" href="../css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a name="d0e2"></a>Aranea&#8212;Java Web Framework Construction and Integration Kit</h1></div><div><h2 class="subtitle">Reference Manual</h2></div><div><div class="authorgroup"><div class="author"><h3 class="author"><span class="firstname">Jevgeni</span> <span class="surname">Kabanov</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Rein</span> <span class="surname">Raudj&auml;rv</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Toomas</span> <span class="surname">R&ouml;mer</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Taimo</span> <span class="surname">Peelo</span></h3></div><div class="author"><h3 class="author"><span class="firstname">Martti</span> <span class="surname">Tamm</span></h3></div></div></div><div><p class="releaseinfo">Version 1.2 (Work In Progress)</p></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="chapter"><a href="#intro">1. Introduction</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e43">1.1. Overview</a></span></dt><dt><span class="sect1"><a href="#d0e159">1.2. Organization</a></span></dt></dl></dd><dt><span class="chapter"><a href="#core">2. Components, Widgets and Services</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e220">2.1. Introduction</a></span></dt><dt><span class="sect1"><a href="#d0e244">2.2. Coding Conventions</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e247">2.2.1. Checked versus Unchecked Exceptions</a></span></dt><dt><span class="sect2"><a href="#d0e258">2.2.2. Public versus Framework Interfaces</a></span></dt><dt><span class="sect2"><a href="#d0e273">2.2.3. Components and Their Orthogonal Properties</a></span></dt></dl></dd><dt><span class="sect1"><a href="#core-components-environment">2.3. Components and Environment</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e381">2.3.1. Composite Pattern and Paths</a></span></dt><dt><span class="sect2"><a href="#core-environment">2.3.2. Environment</a></span></dt><dt><span class="sect2"><a href="#components-messaging">2.3.3. Messaging Components</a></span></dt><dt><span class="sect2"><a href="#components-persistence">2.3.4. State and Synchronization</a></span></dt></dl></dd><dt><span class="sect1"><a href="#core-io-data">2.4. InputData and OutputData</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e732">2.4.1. Extensions</a></span></dt><dt><span class="sect2"><a href="#d0e760">2.4.2. HttpInputData and HttpOutputData</a></span></dt></dl></dd><dt><span class="sect1"><a href="#core-services">2.5. Services</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e1028">2.5.1. Filter Services</a></span></dt></dl></dd><dt><span class="sect1"><a href="#core-widgets">2.6. Widgets</a></span></dt><dd><dl><dt><span class="sect2"><a href="#components-render">2.6.1. ViewModel and Rendering</a></span></dt></dl></dd><dt><span class="sect1"><a href="#core-application-widgets">2.7. Application Widgets</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e1198">2.7.1. Children Management</a></span></dt><dt><span class="sect2"><a href="#EventListeners">2.7.2. Event Listeners</a></span></dt><dt><span class="sect2"><a href="#actionlisteners">2.7.3. Action Listeners</a></span></dt><dt><span class="sect2"><a href="#widgets-environment">2.7.4. Environment</a></span></dt><dt><span class="sect2"><a href="#d0e1392">2.7.5. Overridable Methods</a></span></dt><dt><span class="sect2"><a href="#d0e1418">2.7.6. InputData and OuputData</a></span></dt><dt><span class="sect2"><a href="#widget-view-selector">2.7.7. View Model and Rendering</a></span></dt><dt><span class="sect2"><a href="#widgets-example-widget">2.7.8. Putting It All Together</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e1516">2.8. Standard Contexts</a></span></dt><dd><dl><dt><span class="sect2"><a href="#MessageContext">2.8.1. MessageContext</a></span></dt><dt><span class="sect2"><a href="#LocalizationContext">2.8.2. LocalizationContext</a></span></dt><dt><span class="sect2"><a href="#FlowContext">2.8.3. FlowContext</a></span></dt><dt><span class="sect2"><a href="#PopupWindowContext">2.8.4. PopupWindowContext</a></span></dt><dt><span class="sect2"><a href="#OverlayContext">2.8.5. OverlayContext</a></span></dt><dt><span class="sect2"><a href="#MenuContext">2.8.6. MenuContext</a></span></dt><dt><span class="sect2"><a href="#ConfirmationContext">2.8.7. ConfirmationContext</a></span></dt><dt><span class="sect2"><a href="#ManagedServiceContext">2.8.8. ManagedServiceContext, ThreadContext, and TopServiceContext</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#framework">3. Framework and Configuration</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e2467">3.1. Overview</a></span></dt><dt><span class="sect1"><a href="#application-configuration">3.2. Application Configuration</a></span></dt><dd><dl><dt><span class="sect2"><a href="#web.xml">3.2.1. web.xml</a></span></dt><dt><span class="sect2"><a href="#aranea-conf.xml">3.2.2. aranea-conf.xml</a></span></dt><dt><span class="sect2"><a href="#aranea-conf.properties">3.2.3. aranea-conf.properties</a></span></dt><dt><span class="sect2"><a href="#AraneaSpringDispatcherServlet">3.2.4. AraneaSpringDispatcherServlet</a></span></dt><dt><span class="sect2"><a href="#ExtendingDispatcher">3.2.5. Extending Dispatcher</a></span></dt><dt><span class="sect2"><a href="#ConfigurationContext">3.2.6. ConfigurationContext</a></span></dt><dt><span class="sect2"><a href="#StateVersioningContext">3.2.7. StateVersioningContext</a></span></dt></dl></dd><dt><span class="sect1"><a href="#framework-assembly">3.3. Framework Assembly</a></span></dt><dt><span class="sect1"><a href="#framework-configuration">3.4. Framework Configuration</a></span></dt><dt><span class="sect1"><a href="#d0e2979">3.5. Framework Components</a></span></dt><dd><dl><dt><span class="sect2"><a href="#araneaSpringLocalizationFilter">3.5.1. Localization Filter</a></span></dt><dt><span class="sect2"><a href="#araneaUpdateRegionFilter">3.5.2. AJAX Update Regions Filter</a></span></dt><dt><span class="sect2"><a href="#araneaEnvContextFilter">3.5.3. Environment Configuration Filter</a></span></dt><dt><span class="sect2"><a href="#araneaCriticalErrorHandler">3.5.4. Critical Exception Handler</a></span></dt><dt><span class="sect2"><a href="#araneaFileUploadFilter">3.5.5. File Uploading Filter</a></span></dt><dt><span class="sect2"><a href="#araneaResponseHeaderFilter">3.5.6. HTTP Response Headers Filter</a></span></dt><dt><span class="sect2"><a href="#araneaJspConfigFilter">3.5.7. JSP Configuration Filter</a></span></dt><dt><span class="sect2"><a href="#araneaMessagingFilter">3.5.8. User Messages Filter</a></span></dt><dt><span class="sect2"><a href="#araneaPopupFilter">3.5.9. Popup Windows Filter</a></span></dt><dt><span class="sect2"><a href="#araneaSerializingAudit">3.5.10. Component Serialization Auditing Filter</a></span></dt><dt><span class="sect2"><a href="#araneaStatisticFilter">3.5.11. Statistics Logging Filter</a></span></dt><dt><span class="sect2"><a href="#araneaThreadCloningFilter">3.5.12. Browser Window Cloning Filter</a></span></dt><dt><span class="sect2"><a href="#araneaTransactionFilter">3.5.13. Multi-submit Protection Filter</a></span></dt><dt><span class="sect2"><a href="#araneaClassReloadingFilter">3.5.14. Class Reloading Filter</a></span></dt><dt><span class="sect2"><a href="#araneaClientStateFilter">3.5.15. Client State Serialization Filter</a></span></dt><dt><span class="sect2"><a href="#araneaFileImportFilter">3.5.16. Extension File Import Filter</a></span></dt><dt><span class="sect2"><a href="#araneaMountingFilter">3.5.17. Bookmarking/URL Mounting Filter</a></span></dt><dt><span class="sect2"><a href="#araneaRootFlowContainer">3.5.18. Root Flow Container</a></span></dt><dt><span class="sect2"><a href="#StandardOverlayContainerWidget">3.5.19. Overlay Container</a></span></dt><dt><span class="sect2"><a href="#StandardSystemFormFilterService">3.5.20. System Form Field Storage Filter</a></span></dt><dt><span class="sect2"><a href="#StandardWindowScrollPositionFilterWidget">3.5.21. Window Scroll Position Filter</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e4427">3.6. Other</a></span></dt><dd><dl><dt><span class="sect2"><a href="#framework-extensions">3.6.1. Extension Resources</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#jsp">4. JSP and Custom Tags</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e4500">4.1. Aranea Standard Tag Library</a></span></dt><dt><span class="sect1"><a href="#systemTags">4.2. System Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e4541">4.2.1. &lt;ui:importScripts&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e4712">4.2.2. &lt;ui:importStyles&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e4826">4.2.3. &lt;ui:body&gt;</a></span></dt><dt><span class="sect2"><a href="#systemForm">4.2.4. &lt;ui:systemForm&gt;</a></span></dt><dt><span class="sect2"><a href="#uimessagesjsp">4.2.5. &lt;ui:messages&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e5072">4.3. Basic Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e5075">4.3.1. &lt;ui:attribute&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e5120">4.3.2. &lt;ui:elementContent&gt;</a></span></dt><dt><span class="sect2"><a href="#uielementTag">4.3.3. &lt;ui:element&gt;</a></span></dt><dt><span class="sect2"><a href="#keyboardHandlerTag">4.3.4. &lt;ui:keyboardHandler&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e5231">4.3.5. &lt;ui:eventKeyboardHandler&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e5328">4.4. Widget Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e5331">4.4.1. &lt;ui:widgetContext&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e5421">4.4.2. &lt;ui:widget&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e5507">4.4.3. &lt;ui:widgetInclude&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e5559">4.5. Event-producing Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e5562">4.5.1. &lt;ui:eventButton&gt; and &lt;ui:eventLinkButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e5719">4.5.2. &lt;ui:onLoadEvent&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e5754">4.5.3. &lt;ui:registerPopups&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e5777">4.6. HTML entity Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e5829">4.6.1. Predefined entity tags</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e5912">4.7. Putting Widgets to Work with JSP</a></span></dt><dt><span class="sect1"><a href="#d0e5928">4.8. Layout Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e5931">4.8.1. &lt;ui:layout&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6016">4.8.2. &lt;ui:row&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6093">4.8.3. &lt;ui:cell&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6168">4.8.4. &lt;ui:updateRegion&gt;,  &lt;ui:updateRegionRow&gt;, and &lt;ui:updateRegionRows&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e6249">4.9. Presentation Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e6253">4.9.1. &lt;ui:bold&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6261">4.9.2. &lt;ui:italic&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6269">4.9.3. &lt;ui:font&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6314">4.9.4. &lt;ui:style&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6352">4.9.5. &lt;ui:newline&gt;</a></span></dt><dt><span class="sect2"><a href="#tooltiphtmltag">4.9.6. &lt;ui:tooltip&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6412">4.9.7. &lt;ui:basicButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6496">4.9.8. &lt;ui:basicLinkButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e6570">4.9.9. &lt;ui:link&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e6671">4.10. Programming JSPs without HTML</a></span></dt><dt><span class="sect1"><a href="#d0e6701">4.11. Customizing Tag Styles</a></span></dt><dt><span class="sect1"><a href="#d0e6846">4.12. Making New JSP Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e6850">4.12.1. Utilities and base classes</a></span></dt><dt><span class="sect2"><a href="#tagattributeinheritance">4.12.2. Inheriting tag attributes from base tags.</a></span></dt><dt><span class="sect2"><a href="#d0e6938">4.12.3. Widgets and events</a></span></dt><dt><span class="sect2"><a href="#d0e6960">4.12.4. Layouts</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#forms">5. Forms and Data Binding</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e7002">5.1. Forms</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e7018">5.1.1. FormWidget</a></span></dt><dt><span class="sect2"><a href="#d0e7114">5.1.2. Controls</a></span></dt><dt><span class="sect2"><a href="#d0e7349">5.1.3. Constraints</a></span></dt><dt><span class="sect2"><a href="#d0e7484">5.1.4. Data</a></span></dt><dt><span class="sect2"><a href="#d0e7646">5.1.5. Converters</a></span></dt><dt><span class="sect2"><a href="#formvalidation">5.1.6. Form validation</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e7782">5.2. Forms JSP Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#common-formelement-attributes">5.2.1. Common attributes for all form element rendering tags.</a></span></dt><dt><span class="sect2"><a href="#d0e7890">5.2.2. &lt;ui:form&gt;</a></span></dt><dt><span class="sect2"><a href="#uiFormElementTag">5.2.3. &lt;ui:formElement&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8052">5.2.4. &lt;ui:label&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8123">5.2.5. &lt;ui:simpleLabel&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8202">5.2.6. &lt;ui:button&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8284">5.2.7. &lt;ui:linkButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8348">5.2.8. &lt;ui:formKeyboardHandler&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8471">5.2.9. &lt;ui:formEnterKeyboardHandler&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8486">5.2.10. &lt;ui:formEscapeKeyboardHandler&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8501">5.2.11. &lt;ui:textInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8570">5.2.12. &lt;ui:autoCompleteTextInput&gt;</a></span></dt><dt><span class="sect2"><a href="#comboTextInput">5.2.13. &lt;ui:comboTextInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8708">5.2.14. &lt;ui:textInputDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8739">5.2.15. &lt;ui:numberInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8803">5.2.16. &lt;ui:numberInputDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8829">5.2.17. &lt;ui:floatInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8893">5.2.18. &lt;ui:floatInputDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8919">5.2.19. &lt;ui:passwordInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e8984">5.2.20. &lt;ui:textDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9010">5.2.21. &lt;ui:valueDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9051">5.2.22. &lt;ui:textarea&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9112">5.2.23. &lt;ui:richtextarea&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9135">5.2.24. &lt;ui:richTextAreaInit&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9180">5.2.25. &lt;ui:textareaDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9233">5.2.26. &lt;ui:hiddenInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9253">5.2.27. &lt;ui:checkbox&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9303">5.2.28. &lt;ui:checkboxDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9332">5.2.29. &lt;ui:fileUpload&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9358">5.2.30. &lt;ui:dateInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9403">5.2.31. &lt;ui:dateInputDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9426">5.2.32. &lt;ui:timeInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9487">5.2.33. &lt;ui:timeInputDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9509">5.2.34. &lt;ui:dateTimeInput&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9591">5.2.35. &lt;ui:dateTimeInputDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#ui_select">5.2.36. &lt;ui:select&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9683">5.2.37. &lt;ui:selectDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9731">5.2.38. &lt;ui:multiSelect&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9787">5.2.39. &lt;ui:multiSelectDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9847">5.2.40. &lt;ui:radioSelect&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9919">5.2.41. &lt;ui:radioSelectItem&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e9978">5.2.42. &lt;ui:radioSelectItemLabel&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10056">5.2.43. &lt;ui:checkboxMultiSelect&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10128">5.2.44. &lt;ui:checkboxMultiSelectItem&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10174">5.2.45. &lt;ui:checkboxMultiSelectItemLabel&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10252">5.2.46. &lt;ui:conditionalDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10281">5.2.47. &lt;ui:conditionFalse&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10293">5.2.48. &lt;ui:conditionTrue&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10309">5.2.49. &lt;ui:listDisplay&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10355">5.2.50. &lt;ui:automaticFormElement&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#form_lists">5.3. Form Lists</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e10426">5.3.1. FormListWidget</a></span></dt><dt><span class="sect2"><a href="#form-list-util">5.3.2. FormListUtil</a></span></dt><dt><span class="sect2"><a href="#d0e10553">5.3.3. Form Row Handlers</a></span></dt><dt><span class="sect2"><a href="#d0e10598">5.3.4. Models</a></span></dt><dt><span class="sect2"><a href="#form-list-in-memory-helper">5.3.5. In Memory Form List</a></span></dt></dl></dd><dt><span class="sect1"><a href="#d0e10619">5.4. Form Lists JSP Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e10622">5.4.1. &lt;ui:formList&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10691">5.4.2. &lt;ui:formListRows&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e10762">5.4.3. &lt;ui:formListAddForm&gt;</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#lists">6. Lists and Query Browsing</a></span></dt><dd><dl><dt><span class="sect1"><a href="#Introduction">6.1. Introduction</a></span></dt><dt><span class="sect1"><a href="#ListsAPI">6.2. Lists API</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e10908">6.2.1. A Typical List</a></span></dt><dt><span class="sect2"><a href="#d0e11002">6.2.2. Fields</a></span></dt><dt><span class="sect2"><a href="#d0e11073">6.2.3. Ordering</a></span></dt><dt><span class="sect2"><a href="#d0e11115">6.2.4. Filtering</a></span></dt><dt><span class="sect2"><a href="#d0e11667">6.2.5. Backend Data Provider</a></span></dt><dt><span class="sect2"><a href="#d0e12353">6.2.6. Quick Overview on How to Use</a></span></dt></dl></dd><dt><span class="sect1"><a href="#SelectingListRows">6.3. Selecting List Rows</a></span></dt><dt><span class="sect1"><a href="#ListJSPTags">6.4. List JSP Tags</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e12442">6.4.1. &lt;ui:list&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e12540">6.4.2. &lt;ui:listFilter&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e12553">6.4.3. &lt;ui:listFilterButton&gt; and &lt;ui:listFilterClearButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e12659">6.4.4. &lt;ui:listRows&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e12725">6.4.5. &lt;ui:listRowButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e12821">6.4.6. &lt;ui:listRowLinkButton&gt;</a></span></dt><dt><span class="sect2"><a href="#d0e12919">6.4.7. &lt;ui:listRowCheckBox&gt; And &lt;ui:listRowRadioButton&gt;</a></span></dt></dl></dd><dt><span class="sect1"><a href="#EditableLists">6.5. Editable Lists</a></span></dt></dl></dd><dt><span class="chapter"><a href="#uilibwchapter">7. Other Uilib Widgets</a></span></dt><dd><dl><dt><span class="sect1"><a href="#trees">7.1. Trees</a></span></dt><dd><dl><dt><span class="sect2"><a href="#treewidget_and_treenodewidget">7.1.1. TreeWidget &amp; TreeNodeWidget</a></span></dt><dt><span class="sect2"><a href="#treeJSPtags">7.1.2. Tree JSP tags</a></span></dt></dl></dd><dt><span class="sect1"><a href="#tabs">7.2. Tabs</a></span></dt><dd><dl><dt><span class="sect2"><a href="#TabContainerWidget">7.2.1. TabContainerWidget</a></span></dt><dt><span class="sect2"><a href="#TabJsptags">7.2.2. Tab JSP tags</a></span></dt></dl></dd><dt><span class="sect1"><a href="#contextmenu">7.3. Context Menu</a></span></dt><dd><dl><dt><span class="sect2"><a href="#ContextMenuWidget_ContextMenuItem">7.3.1. ContextMenuWidget &amp; ContextMenuItem</a></span></dt><dt><span class="sect2"><a href="#ContextMenuJSP">7.3.2. Rendering context menus with JSP template</a></span></dt></dl></dd><dt><span class="sect1"><a href="#PartialRendering">7.4. Partial Rendering</a></span></dt><dd><dl><dt><span class="sect2"><a href="#The_Two_Steps">7.4.1. The Two Steps</a></span></dt><dt><span class="sect2"><a href="#Partial_Rendering_Example">7.4.2. Partial Rendering Example</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#integration">8. Third-party Integration</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e13641">8.1. Spring Application Framework</a></span></dt><dd><dl><dt><span class="sect2"><a href="#d0e13644">8.1.1. BeanFactory, ApplicationContext, WebApplicationContext</a></span></dt><dt><span class="sect2"><a href="#araneaLocalizationFilter">8.1.2. Spring Localization Filter</a></span></dt><dt><span class="sect2"><a href="#d0e13730">8.1.3. Widget Dependency Injection</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#javascript">9. Javascript Libraries</a></span></dt><dd><dl><dt><span class="sect1"><a href="#d0e13756">9.1. Third-party Javascript Libraries</a></span></dt><dd><dl><dt><span class="sect2"><a href="#dhtmlcalendar">9.1.1. The DHTML Calendar (http://www.dynarch.com/projects/calendar/)</a></span></dt><dt><span class="sect2"><a href="#prototype">9.1.2. Prototype (http://www.prototypejs.org/)</a></span></dt><dt><span class="sect2"><a href="#scriptaculous">9.1.3. script.aculo.us (http://script.aculo.us/)</a></span></dt><dt><span class="sect2"><a href="#tinymce">9.1.4. TinyMCE (http://tinymce.moxiecode.com/)</a></span></dt><dt><span class="sect2"><a href="#prototip">9.1.5. Prototip (http://www.nickstakenburg.com/projects/prototip/)</a></span></dt><dt><span class="sect2"><a href="#modalbox">9.1.6. ModalBox (http://www.wildbit.com/labs/modalbox/)</a></span></dt><dt><span class="sect2"><a href="#log4javascript">9.1.7. log4javascript (http://log4javascript.org/)</a></span></dt></dl></dd><dt><span class="sect1"><a href="#aranea_clientside_js">9.2. Aranea Clientside Javascript</a></span></dt></dl></dd></dl></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="intro"></a>Chapter&nbsp;1.&nbsp;Introduction</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e43"></a>1.1.&nbsp;Overview</h2></div></div></div><p>Aranea is a <span class="emphasis"><em>Java Hierarchical Model-View-Controller Web
    Framework</em></span> that provides a common simple approach to building
    the web application components, reusing custom or general GUI logic and
    extending the framework. The framework is assembled from a number of
    independent modules with well-defined responsibilities and thus can be
    easily reconfigured to perform new and unexpected tasks. The controller is
    separated into a hierarchy of components that can react to user or system
    events. The framework is completely view agnostic, but provides a thorough
    library of JSP custom tags that target building GUIs without writing a
    line of HTML. All components and modules are simple <span class="emphasis"><em>Plain Old
    Java</em></span> classes without any XML mappings and thus usual
    Object-Oriented design techniques can be applied. Aranea manages the
    component field persistence automatically and inherently supports nested
    state.</p><p>Aranea is logically separated in the following modules: </p><p>      </p><div class="variablelist"><dl><dt><span class="term">Aranea Core</span></dt><dd>Contains the core interfaces and base implementations that define Aranea base abstractions and their contracts. Includes packages <code class="literal">org.araneaframework</code> and <code class="literal">org.araneaframework.core</code> and is packaged into <code class="literal">aranea-core.jar</code>.</dd><dt><span class="term">Aranea Framework</span></dt><dd>Framework module sits on top of the <span class="emphasis"><em>Core</em></span> module and contains the implementation of the Aranea Web Framework that does not directly depend on any container. <span class="emphasis"><em>Framework</em></span> module includes package <code class="literal">org.araneaframework.framework</code> and its subpackages and is packaged into <code class="literal">aranea-framework.jar</code>.</dd><dt><span class="term">Aranea HTTP</span></dt><dd>HTTP module extends the <span class="emphasis"><em>Framework</em></span> module with services that use a Servlet container. Servlet  module includes package <code class="literal">org.araneaframework.http</code> and its subpackages and is packaged into <code class="literal">aranea-servlet.jar</code>.</dd><dt><span class="term">Aranea Integration</span></dt><dd>Spring module integrates Aranea with the <span class="emphasis"><em>Spring</em></span> IoC container. Spring module includes package <code class="literal">org.araneaframework.integration.spring</code> and its subpackages and is packaged into <code class="literal">aranea-spring.jar</code>.</dd><dt><span class="term">Aranea UiLib</span></dt><dd>UiLib module contains reusable GUI widgets and supporting API. UiLib module includes package <code class="literal">org.araneaframework.uilib</code> and its subpackages and is packaged into <code class="literal">aranea-uilib.jar</code>.</dd><dt><span class="term">Aranea JSP</span></dt><dd>JSP module contains a custom tag library, including tags that render <span class="emphasis"><em>UiLib</em></span> widgets. JSP module includes package <code class="literal">org.araneaframework.jsp</code> and its subpackages and is packaged into <code class="literal">aranea-jsp.jar</code>.</dd><dt><span class="term">Aranea Backend</span></dt><dd>Backend module contains supporting classes that are to be used in the application service layer (e.g. backend list data provider helper classes). Backend module includes package <code class="literal">org.araneaframework.backend</code> and its subpackages and is packaged into <code class="literal">aranea-backend.jar</code>.</dd></dl></div><p>These modules depend on each other as follows:</p><div class="mediaobject"><img src="../images/dependencies.png"></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e159"></a>1.2.&nbsp;Organization</h2></div></div></div><p> The rest of this manual is organized as follows: </p><div class="variablelist"><dl><dt><span class="term">Components, Widgets and Services</span></dt><dd><p>This chapter describes the core Aranea abstractions in detail
          generally not necessary to just develop application code so it can
          be skipped during the first reading. It is quite dry on the
          examples, but its understanding is crucial to develop Aranea
          extensions. To get a quick understanding of how to program with
          widgets read <a href="#core-application-widgets" title="2.7.&nbsp;Application Widgets">Section&nbsp;2.7, &#8220;Application Widgets&#8221;</a>. </p></dd><dt><span class="term">Framework and Configuration</span></dt><dd><p>This chapter describes how to assemble and configure both
          applications and the Aranea framework itself. It also describes in
          detail main components of the Aranea framework. The most interesting
          part for a beginner would be <a href="#application-configuration" title="3.2.&nbsp;Application Configuration">Section&nbsp;3.2, &#8220;Application Configuration&#8221;</a>.</p></dd><dt><span class="term">JSP and Custom Tags</span></dt><dd>This chapter describes how to render Aranea widgets and
        services with custom JSP tag library supplied in the Aranea
        distribution.</dd><dt><span class="term">Forms and Data Binding</span></dt><dd><p>This chapter describes how Aranea manages reading data from
          request, validating and converting it to the model objects.</p></dd><dt><span class="term">Lists and Query Browsing</span></dt><dd><p>This chapter describes how to make pageable, filterable and
          orderable tables in Aranea. </p></dd><dt><span class="term">Uilib widgets</span></dt><dd><p>This chapter looks at various other Uilib widgets and explains their use.</p></dd><dt><span class="term">Third-party Integration</span></dt><dd><p>This chapter describes Aranea integration hooks for
          third-party toolkits and frameworks. At the moment it includes
          Spring.</p></dd><dt><span class="term">Javascript Libraries</span></dt><dd><p>This chapter describes the Javascript libraries that Aranea
          uses and the Javascript API that Aranea provides.</p></dd></dl></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="core"></a>Chapter&nbsp;2.&nbsp;Components, Widgets and Services</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e220"></a>2.1.&nbsp;Introduction</h2></div></div></div><p>Aranea framework and component model are very simple and implemented
    purely in Plain Old Java. There are no XML mappings, code generation or
    bytecode enhancement. The whole component model consists mainly of five
    interfaces: <code class="classname">org.araneaframework.Component</code>,
    <code class="classname">org.araneaframework.Service</code>,
    <code class="classname">org.araneaframework.Widget</code>,
    <code class="classname">org.araneaframework.Environment</code>,
    <code class="classname">org.araneaframework.Message</code> and some conventions
    regarding their usage and implementation.</p><p>This chapter describes the core Aranea abstractions in detail
    generally not necessary to just develop application code so it can be
    skipped during the first reading. It is quite dry on the examples, but its
    understanding is crucial to develop Aranea extensions. To get a quick
    understanding of how to program applications with widgets read <a href="#core-application-widgets" title="2.7.&nbsp;Application Widgets">Section&nbsp;2.7, &#8220;Application Widgets&#8221;</a>. </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e244"></a>2.2.&nbsp;Coding Conventions</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e247"></a>2.2.1.&nbsp;Checked versus Unchecked Exceptions</h3></div></div></div><p>It is our firm belief that checked exceptions are unnecessary in
      <span class="emphasis"><em>Controller</em></span> and therefore Aranea will in most cases
      allow to just declare your overriding method as <code class="literal">throws
      Exception</code>. On the other hand no framework interfaces throw
      checked exceptions so the exception-handling boilerplate can be
      delegated to a single error-handling component.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e258"></a>2.2.2.&nbsp;Public versus Framework Interfaces</h3></div></div></div><p>Since the application programmer implements the same components
      that are used for framework extension, it is important to discourage the
      access to public framework interfaces (which are necessarily visible in
      the overridden classes). Thus a simple convention is applied for core
      framework interfaces, which is best illustrated with the following
      example.</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Service <span class="syntax6">extends</span> Component, Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Interface <span class="syntax9">_getService</span>();

  <span class="syntax6">public</span> <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">action</span>(Path path, InputData input, OutputData output) <span class="syntax6">throws</span> Exception;
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>As one can see, the real interface methods are relocated to an
      inner interface named <code class="classname">Interface</code>, that can be
      accessed using a method
      <code class="classname">_get&lt;InterfaceName&gt;()</code>, which starts with an
      underscore to discourage its use. As a rule of a thumb, in Aranea the
      methods starting with an underscore should only be used, when one really
      knows what one is doing.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e273"></a>2.2.3.&nbsp;Components and Their Orthogonal Properties</h3></div></div></div><p>Aranea has three main types of components:
      <code class="classname">org.araneaframework.Component</code>,
      <code class="classname">org.araneaframework.Service</code> and
      <code class="classname">org.araneaframework.Widget</code>. These components also
      have a number of orthogonal properties (like
      <code class="classname">Viewable</code>, <code class="classname">Composite</code>),
      which are represented by interfaces that need to be implemented. Since
      some particular API methods expect a particular type of component with a
      particular property (e.g. <code class="classname">ViewableWidget</code>) one
      would either have to abandon static type safety or define a lot of
      meaningless interfaces that would clutter the Javadoc index and confuse
      the source code readers. The approach chosen in Aranea is to make such
      interfaces internal to the property, like in the following
      example.</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Viewable <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Interface <span class="syntax9">_getViewable</span>();

  <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> Object <span class="syntax9">getViewModel</span>() <span class="syntax6">throws</span> Exception;
  <span class="syntax11">}</span>

  <span class="syntax6">public</span> <span class="syntax8">interface</span> ViewableComponent <span class="syntax6">extends</span> Viewable, Component, Serializable <span class="syntax11">{}</span>
  <span class="syntax6">public</span> <span class="syntax8">interface</span> ViewableService <span class="syntax6">extends</span> ViewableComponent, Service, Serializable <span class="syntax11">{}</span>
  <span class="syntax6">public</span> <span class="syntax8">interface</span> ViewableWidget <span class="syntax6">extends</span> ViewableService, Widget, Serializable <span class="syntax11">{}</span>
<span class="syntax11">}</span>
</span></pre></pre></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="core-components-environment"></a>2.3.&nbsp;Components and Environment</h2></div></div></div><p><code class="classname">org.araneaframework.Component</code> represents the
    unit of encapsulation and reuse in Aranea. Components are used to both
    provide plug-ins and extensions to the framework and to implement the
    actual application-specific code. A component has (possibly persistent)
    state, life cycle, environment and a messaging mechanism. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Component <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Scope <span class="syntax9">getScope</span>();             <span class="syntax2">/**</span><span class="syntax2"> </span><span class="syntax5">@since</span><span class="syntax2"> 1.1 </span><span class="syntax2">*/</span>
  <span class="syntax6">public</span> Environment <span class="syntax9">getEnvironment</span>(); <span class="syntax2">/**</span><span class="syntax2"> </span><span class="syntax5">@since</span><span class="syntax2"> 1.1 </span><span class="syntax2">*/</span>
  <span class="syntax6">public</span> <span class="syntax8">boolean</span> <span class="syntax9">isAlive</span>();            <span class="syntax2">/**</span><span class="syntax2"> </span><span class="syntax5">@since</span><span class="syntax2"> 1.1 </span><span class="syntax2">*/</span>

  <span class="syntax6">public</span> Component.Interface <span class="syntax9">_getComponent</span>();

  <span class="syntax6">public</span> <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">init</span>(Environment env) <span class="syntax6">throws</span> Exception;
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">destroy</span>() <span class="syntax6">throws</span> Exception;
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">propagate</span>(Message message) <span class="syntax6">throws</span> Exception;
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">enable</span>() <span class="syntax6">throws</span> Exception;
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">disable</span>() <span class="syntax6">throws</span> Exception;
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>The component life cycle goes as follows: </p><div class="orderedlist"><ol type="1" compact><li><code class="function">init()</code>

           &#8212;notifies the component that it should initialize itself passing it the 

          <code class="classname">Environment</code>

           . A component can be initialized only once and the environment it is given stays with it until it is destroyed. 
        </li><li>
           All other calls (like 

          <code class="literal">propagate()</code>

           ) should be done when a component is alive, initialized and enabled. 
        </li><li><code class="function">disable()</code>

           &#8212;notifies the component that it will be disabled and will not receive any calls until it is enabled again. A component is enabled by default. 
        </li><li><code class="function">enable()</code>

           &#8212;notifies the component that it has been enabled again. This call may only be done after a 

          <code class="classname">disable()</code>

           call. 
        </li><li><code class="function">destroy()</code>

           &#8212;notifies the component that it has been destroyed and should release any acquired resources and such. A component can be destroyed only once and should be initialized before that. 
        </li></ol></div><p> Further in the text we will refer to an initialized and
    not destroyed component instance that has a parent as
    <span class="emphasis"><em>live</em></span> and one that has not been disabled or has been
    re-enabled as <span class="emphasis"><em>enabled</em></span>.</p><p>Aranea provides a base implementation of the
    <code class="literal">Component</code> &#8212;
    <code class="literal">org.araneaframework.core.BaseComponent</code>. This
    implementation mainly enforces contracts (including life cycle and some
    basic synchronization). A base class for application development
    <code class="literal">org.araneaframework.core.BaseApplicationComponent</code> is
    also available.</p><p>
    	<code class="literal">Component</code> methods not dealing with lifecycle or messaging are accessible 
    	without getting at <code class="literal">Component.Interface</code>. <code class="literal">Component.getScope()</code> 
    	returns scoped identifier that uniquely identifies that <code class="literal">Component</code> in component
    	hierarchy. <code class="literal">Component.getEnvironment()</code> returns information of <code class="literal">Environment</code> 
    	in which <code class="literal">Component</code> lives and <code class="literal">Component.isAlive()</code> allows
    	component to check whether it is living at all :). 
    </p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e381"></a>2.3.1.&nbsp;Composite Pattern and Paths</h3></div></div></div><p><span class="emphasis"><em>Composite</em></span> pattern refers to a design approach
      prominent (specifically) in the GUI modeling when objects implementing
      the same interface are arranged in a hierarchy by containment, where the
      nodes of the tree propagate calls in some way to the leafs of the tree.
      It is shown on <a href="#composite-pattern" title="Figure&nbsp;2.1.&nbsp;Composite design pattern">Figure&nbsp;2.1, &#8220;<span class="emphasis"><em>Composite</em></span> design pattern&#8221;</a>.</p><div class="figure"><a name="composite-pattern"></a><div class="mediaobject"><img src="../images/composite.png" alt="Composite design pattern"></div><p class="title"><b>Figure&nbsp;2.1.&nbsp;<span class="emphasis"><em>Composite</em></span> design pattern</b></p></div><p><span class="emphasis"><em>Composite</em></span> is one of the main patterns used in
      Aranea. It is mainly used to create a <span class="emphasis"><em>Hierarchical
      Controller</em></span> using <code class="literal">Component</code> containment. In
      terms of <code class="literal">Component</code> interface
      <span class="emphasis"><em>Composite</em></span> is used to propagate life cycle events
      and route messages (see <a href="#components-messaging" title="2.3.3.&nbsp;Messaging Components">Section&nbsp;2.3.3, &#8220;Messaging Components&#8221;</a>).</p><p>The flavor of the <span class="emphasis"><em>Composite</em></span> pattern as used
      in Aranea typically means that every contained component has some kind
      of an identifier or name that distinguishes it from other children of
      the same parent (note that the child is not typically aware of its
      identifier). This identifiers are used to route messages and events and
      can be combined to form a full identifier which describes a "path" from
      the root component to the child in question. This paths are represented
      by a <span class="emphasis"><em>Iterator</em></span>-like interface
      <code class="literal">org.araneaframework.Path</code>. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Path <span class="syntax6">extends</span> Cloneable, Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Object <span class="syntax9">getNext</span>();
  <span class="syntax6">public</span> Object <span class="syntax9">next</span>();
  <span class="syntax6">public</span> <span class="syntax8">boolean</span> <span class="syntax9">hasNext</span>();
<span class="syntax11">}</span>
</span></pre></pre><p>Each <code class="literal">next()</code> call will return the identifier of
      the next child in the path to the descendant in question. Default
      implementation
      (<code class="literal">org.araneaframework.core.StandardPath</code>) uses simple
      string identifiers like "a" or "b" and combines them using dots forming
      full paths like "a.b.c".</p><p>A <span class="emphasis"><em>Composite</em></span> component may want to make its
      children visible to the outside world by implementing the
      <code class="literal">org.araneaframework.Composite</code> interface:
      </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Composite <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Composite.Interface <span class="syntax9">_getComposite</span>();
  <span class="syntax6">public</span> <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> Map <span class="syntax9">getChildren</span>();
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">attach</span>(Object key, Component comp);
    <span class="syntax6">public</span> Component <span class="syntax9">detach</span>(Object key); 
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>This interface allows to both inspect and manipulate component
      children by attaching and detaching them from the parent
      component.</p><p>As most of the Aranea abstractions are built to be used with the
      <span class="emphasis"><em>Composite</em></span> concept we will illustrate it in greater
      detail when examining other abstractions and their implementation.
      Further on we will assume that any <code class="literal">Component</code> has a
      parent that contains it and every child has some kind of name in
      relation to the parent unless noted otherwise (obviously there is at
      least one <span class="emphasis"><em>Composite</em></span> that does not have a parent,
      but we don't really care about that at the moment).</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="core-environment"></a>2.3.2.&nbsp;Environment</h3></div></div></div><p><code class="literal">org.araneaframework.Environment</code> is another
      important concept that represents the way <code class="literal">Component</code>s
      interact with the framework. <code class="literal">Environment</code> interface is
      rather simple: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Environment <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Object <span class="syntax9">getEntry</span>(Object key);
  <span class="syntax6">public</span> Object <span class="syntax9">requireEntry</span>(Object key) <span class="syntax6">throws</span> NoSuchEnvironmentEntryException;
<span class="syntax11">}</span>
</span></pre></pre><p>It basically provides means of looking up entry objects by their
      key. A typical usage of the <code class="literal">Environment</code> can be
      illustrated with an example. </p><pre class="programlisting"><pre><span class="syntax0">...
MessageContext msgCtx <span class="syntax11">=</span> (MessageContext) <span class="syntax9">getEnvironment</span>().<span class="syntax9">getEntry</span>(MessageContext.<span class="syntax8">class</span>);
msgContext.<span class="syntax9">showInfoMessage</span>(<span class="syntax3">"Hello world!"</span>);
...
</span></pre></pre><p>As one can see from the example <code class="literal">Environment</code>
      will typically allow to look up implementations of the interfaces using
      their <code class="literal">Class</code> as the key (this is in fact an Aranea
      convention in using and extending the <code class="literal">Environment</code>).
      The interfaces serving as keys for <code class="literal">Environment</code>
      entries are referred to as <span class="emphasis"><em>contexts</em></span>. It is thus not
      unlike JNDI or some other directory lookups that allow to hold objects,
      however unlike them <code class="literal">Environment</code> is very specific to
      the <code class="literal">Component</code> it is given to, and can be influenced
      by its parents. In fact, all contexts available in the
      <code class="literal">Environment</code> will be provided to the
      <code class="literal">Component</code> by its parents or ancestors (in the sense
      of containment rather than inheritance). Thus, two different
      <code class="literal">Component</code>s may have completely different
      <code class="literal">Environment</code>s.</p><p>A default implementation of <code class="literal">Environment</code> is
      <code class="literal">org.araneaframework.core.StandardEnvironment</code>. It
      provides for creating an <code class="literal">Environment</code> from a
      <code class="literal">java.util.Map</code>, or extending an existing environment
      with map entries.</p><p>A component can provide an environment entry to its descendant, by
      providing it to the initializer of its direct child. For instance the
      <code class="literal">MessageContext</code> could be provided by the following
      message component:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MessageFilterService <span class="syntax6">implements</span> MessageContext, Component, Service <span class="syntax11">{</span>
  <span class="syntax6">protected</span> Service childService;
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setChildService</span>(Service childService) <span class="syntax11">{</span>
    <span class="syntax4">this</span>.childService <span class="syntax11">=</span> childService;
  <span class="syntax11">}</span>

  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">init</span>(Environment env) <span class="syntax11">{</span>
    childService.<span class="syntax9">init</span>(
      <span class="syntax6">new</span> <span class="syntax9">StandardEnvironment</span>(env, MessageContext.<span class="syntax8">class</span>, <span class="syntax4">this</span>);
  <span class="syntax11">}</span>

  <span class="syntax1">//MessageContext implementation...</span>
  <span class="syntax6">public</span> String <span class="syntax9">showInfoMessage</span>(String message) <span class="syntax11">{</span>
    <span class="syntax1">//Show message to user...</span>
  <span class="syntax11">}</span>  

  <span class="syntax1">//...</span>
<span class="syntax11">}</span>
</span></pre></pre><p>After that the <code class="literal">childService</code>, its children and
      so on will be able to use the <code class="literal">MessageContext</code> provided
      by <code class="literal">MessageFilterService</code>. Of course this can be done
      simpler as shown in examples in this chapter, but this is how most of the
      components in Aranea provide new contexts to the <code class="literal">Environment</code>.
      </p><p>Sometimes, however, one may want to make his or her component or widget
 			 independent from the specific <code class="literal">Environment</code>. This can be achieved
 			 by using <code class="literal">org.araneaframework.core.RelocatableDecorator</code>:
</p><pre class="programlisting"><pre><span class="syntax0">  Service child <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">RelocatableDecorator</span>(<span class="syntax6">new</span> <span class="syntax9">MyWidget</span>());
  <span class="syntax9">addWidget</span>(<span class="syntax3">"c"</span>, child);
</span></pre></pre><p>

			For example, this technique is used when a user clones a thread (middle mouse button
			click on a link), and it is necessary to clone the state. Then each widget is cloned,
			and a new <code class="literal">Environmnet</code> is provided to them.
 			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="components-messaging"></a>2.3.3.&nbsp;Messaging Components</h3></div></div></div><p>So far, we have looked at the component management and
      environment. However what makes the component hierarchy such a powerful
      concept is messaging. Basically, messaging allows us to send any events
      to any component in the hierarchy (including all components or a
      specific one). The messaging is incorporated using the
      <code class="literal">org.araneaframework.Message</code> interface </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Message <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">send</span>(Object id, Component component) <span class="syntax6">throws</span> Exception;
<span class="syntax11">}</span>
</span></pre></pre><p> and <code class="literal">Component.propagate(Message message)</code>
      method. The default behavior of the <code class="literal">propagate()</code>
      method should be to send the message to all component children, passing
      the <code class="literal">send()</code> method the identifier of the child and the
      child itself. It is up to the message what to do with the child further,
      but typically <code class="literal">Message</code> just calls the
      <code class="literal">propagate()</code> method of the child passing itself as the
      argument after possibly doing some custom processing (the
      <span class="emphasis"><em>double-dispatch</em></span> OO idiom).</p><p>A standard <code class="literal">Message</code> implementation that uses
      double-dispatch to visit all the components in hierarchy is
      <code class="literal">org.araneaframework.core.BroadcastMessage</code>. It usage
      can be illustrated with the following example: </p><pre class="programlisting"><pre><span class="syntax0">...
Message myEvent <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BroadcastMessage</span>() <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">execute</span>(Component component) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  <span class="syntax6">if</span> (component <span class="syntax6">instanceof</span> MyEventListener)
    ((MyEventListener) component).<span class="syntax9">onMyEvent</span>(data);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
myEvent.<span class="syntax9">send</span>(<span class="syntax4">null</span>, rootComponent);
...
</span></pre></pre><p> This code will call all the components in the hierarchy
      that subscribed to the event and pass them a certain
      <code class="literal">data</code> parameter. As one can see, when calling
      <code class="literal">Message.send()</code> we will typically pass
      <code class="literal">null</code> as the first parameter, since it is needed only
      when propagating messages further down the hierarchy. Note that messages
      can be used to gather data from the components just as well as for
      passing data to them. For example one could construct message that
      gathers all <code class="literal">FormWidget</code>s from the widget
      hierarchy:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax6">static</span> <span class="syntax8">class</span> FormWidgetFinderMessage <span class="syntax6">extends</span> BroadcastMessage <span class="syntax11">{</span>
  List formList <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">ArrayList</span>();

  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">execute</span>(Component component) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax6">if</span> (component <span class="syntax6">instanceof</span> org.araneaframework.uilib.form.FormWidget) <span class="syntax11">{</span>
      formList.<span class="syntax9">add</span>(component);
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>

  <span class="syntax6">public</span> List <span class="syntax9">getAllForms</span>() <span class="syntax11">{</span> <span class="syntax6">return</span> formList; <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>Another standard <code class="literal">Message</code> implementation is
      <code class="literal">org.araneaframework.core.RoutedMessage</code>, which allows
      us to send a message to one specific component in the hierarchy as in
      the following example: </p><pre class="programlisting"><pre><span class="syntax0">...
Message myEvent <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">RoutedMessage</span>(<span class="syntax3">"a.b.c"</span>) <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">execute</span>(Component component) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    ((MyPersonalComponent) component).<span class="syntax9">myMethod</span>(...);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
myEvent.<span class="syntax9">send</span>(<span class="syntax4">null</span>, rootComponent);
...
</span></pre></pre><p> This code will send the message to the specific component
      with path "a.b.c" and call <code class="literal">myMethod()</code> on it.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="components-persistence"></a>2.3.4.&nbsp;State and Synchronization</h3></div></div></div><p>The handling of persistent state in Aranea is very simple. There
      are no scopes and every component state is saved until it is explicitly
      removed by its parent. This does not mean that all of the components are
      bound to the session, but rather that most components will live a period
      of time appropriate for them (e.g. framework components will live as
      long as the application lives, GUI components will live until user
      leaves them, and so on). This provides for a very flexible approach to
      persistence allowing not to clutter memory with unused
      components.</p><p>The end result is that typically one needs not worry about
      persistence at all, unless one is programming some framework plug-ins.
      All class fields (except in some cases <code class="literal">transient</code>
      fields) can be assumed to persist while the host object is
      <span class="emphasis"><em>live</em></span>.</p><p>However such handling does not guarantee that the component state
      is anyhow synchronized. As a matter of fact most of the framework
      components outside the user session should be able to process concurrent
      calls and should take care of the synchronization themselves. However
      application components are typically synchronized by the framework. More
      information on the matter will follow in <a href="#core-application-widgets" title="2.7.&nbsp;Application Widgets">Section&nbsp;2.7, &#8220;Application Widgets&#8221;</a>.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="core-io-data"></a>2.4.&nbsp;InputData and OutputData</h2></div></div></div><p><code class="literal">InputData</code> is Aranea abstraction for a request,
    which hides away the Servlet API and allows us to run Aranea on different
    containers (e.g. in a portlet or behind a web service).</p><p><code class="literal">InputData</code> provides access to the data sent
    to the component. This data comes in two flavours: </p><div class="itemizedlist"><ul type="disc" compact><li><code class="literal">getScopedData(Path scope)</code>

           returns a 

          <code class="literal">java.util.Map</code>

           with the data sent specially to <code class="literal">component</code>, which unique identifier in
           the component hierarchy is <code class="literal">scope</code>. To get at this data, one can
           use construction <code class="literal">inputData.getScopedData(getScope().toPath())</code> from 
           a component. 
        </li><li><code class="literal">getGlobalData()</code>

           returns a 

          <code class="literal">java.util.Map</code>

           with the data sent to the application generally. 
        </li></ul></div><p> In case Aranea is running on top of a servlet both these
    maps will contain only <code class="literal">String</code>s. If one wants to access
    multi-valued parameters in servlet environment <code class="literal">StandardServletInputData.getParameterValues(String name)</code>
    method should be used (returns <code class="literal">String</code> array).

    In case of the usual path and scope implementation (as dot-separated strings) <span class="emphasis"><em>global data</em></span>
    will contain the submitted parameters with no dots in them and
    <span class="emphasis"><em>scoped data</em></span> will contain the parameters prefixed with
    the current component scope string.</p><p>Analogically <code class="literal">OutputData</code> is Aranea abstraction for response. <code class="literal">HttpOutputData</code> being
    the subinterface and <code class="literal">StandardServletOutputData</code> implementation for servlet environments.</p><p>As <code class="literal">InputData</code> and
    <code class="literal">OutputData</code> are typically connected, they can be
    retrieved from the other <code class="literal">*Data</code> structure using
    correspondingly <code class="literal">getOutputData()</code> and
    <code class="literal">getInputData()</code> methods.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e732"></a>2.4.1.&nbsp;Extensions</h3></div></div></div><p>Both InputData and OutputData implement a way to extend their
      functionality without wrapping or extending the objects themselves. This
      is achieved by providing the following two methods:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">void</span> <span class="syntax9">extend</span>(Class interfaceClass, Object extension)
Object <span class="syntax9">narrow</span>(Class interfaceClass);
</span></pre></pre><p>The following example should give an idea of applying these
      methods:</p><pre class="programlisting"><pre><span class="syntax0">input.<span class="syntax9">extend</span>(FileUploadExtension.<span class="syntax8">class</span>, <span class="syntax6">new</span> <span class="syntax9">FileUploadExtension</span>(input));

...

FileUploadExtension fileUploadExt <span class="syntax11">=</span> 
  (FileUploadExtension) input.<span class="syntax9">narrow</span>(FileUploadExtension.<span class="syntax8">class</span>);
<span class="syntax6">if</span> (fileUploadExt.<span class="syntax9">uploadSucceeded</span>()) <span class="syntax11">{</span>
  <span class="syntax1">//...</span>
<span class="syntax11">}</span>
</span></pre></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Both <code class="literal">HttpServletRequest</code> and
        <code class="literal">HttpServletResponse</code> are available as
        <code class="literal">InputData</code> and <code class="literal">OutputData</code>
        extensions respectively.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e760"></a>2.4.2.&nbsp;HttpInputData and HttpOutputData</h3></div></div></div><p>Although all of the core Aranea abstractions are independent of
      the Servlet API and web in general, we also provide a way to manipulate
      low-level HTTP constructs. To that goal we provide two interfaces,
      <code class="literal">HttpInputData</code> and <code class="literal">HttpOutputData</code>,
      which extend respectively <code class="literal">InputData</code> and
      <code class="literal">OutputData</code>.</p><p>Let's examine the <code class="literal">HttpInputData</code>. First of all
      it provides methods that are similar to the ones found in the
      <code class="literal">HttpServletRequest</code>:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">Iterator getParameterNames()</code></td><td>Returns an iterator over names of the parameters
                submitted with the current request.</td></tr><tr><td><code class="literal">String[] getParameterValues(String
                name)</code></td><td>Returns the array of values of the particular parameter
                submitted with the current request.</td></tr><tr><td><code class="literal">String
                getCharacterEncoding()</code></td><td>Returns the character encoding that is used to decode
                the request parameters.</td></tr><tr><td><code class="literal">setCharacterEncoding(String
                encoding)</code></td><td>Sets the character encoding that is used to decode the
                request parameters. Note that this must be called before any
                parameters are read according to the Servlet
                specification.</td></tr><tr><td><code class="literal">String getContentType()</code></td><td>Returns the MIME content type of the request body or
                <code class="literal">null</code> if the body is lacking.</td></tr><tr><td><code class="literal">Locale getLocale()</code></td><td>Returns the preferred Locale that the client will
                accept content in, based on the Accept-Language header. If the
                client request doesn't provide an Accept-Language header, this
                method returns the default locale for the server.</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Unlike <code class="literal">InputData</code> methods the parameters are
        presented as is and include both global and scoped parameters (the
        scoped ones are prefixed by the full name of the enclosing
        widget).</p></div><p>However next methods are a bit different from the
      <code class="literal">HttpServletRequest</code> alternatives:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">String getRequestURL()</code></td><td>Returns the target URL of the current request.</td></tr><tr><td><code class="literal">String getContainerURL()</code></td><td>Returns an URL pointing to the Aranea container (in
                most cases the dispatcher servlet).</td></tr><tr><td><code class="literal">String getContextURL()</code></td><td>Returns an URL pointing to the Aranea container context
                (in most cases the web application root).</td></tr><tr><td><code class="literal">String getPath()</code></td><td>Returns the path on the server starting from the
                dispatcher servlet that has been submitted as the part of the
                request target URL.</td></tr><tr><td><code class="literal">pushPathPrefix(String
                pathPrefix)</code></td><td>Consumes the path prefix allowing children to be mapped
                to a relative path.</td></tr><tr><td><code class="literal">popPathPrefix()</code></td><td>Restores the previously consumed path prefix.</td></tr></tbody></table></div><p>The interesting part here are the methods that deal with the path.
      The problem is that unlike most common cases Aranea components form a
      hierarchy. Therefore if a parent is mapped to path prefix "myPath/*" and
      its child is mapped to a path prefix "myChildPath/*" if the path
      handling were absolute the child would never get the mapped calls. This
      is due to the child being really mapped to the path
      "myPath/myChildPath". Therefore the parent must consume the prefix
      "myPath/" using method <code class="literal">pushPathPrefix()</code> and then the
      child will be correctly matched to the relative path
      "myChildPath".</p><p><code class="literal">HttpOutputData</code> contains methods that are
      comparable to the ones found in
      <code class="literal">HttpServletResponse</code>:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">String encodeURL(String url)</code></td><td>Encodes the URL to include some additional information
                (e.g. HTTP session identifier). Note that Aranea may include
                some information not present in the servlet spec.</td></tr><tr><td><code class="literal">sendRedirect(String
                location)</code></td><td>Sends an HTTP redirect to a specified location
                URL.</td></tr><tr><td><code class="literal">OutputStream
                getOutputStream()</code></td><td>Returns an <code class="literal">OutputStream</code> that can be
                used to write to response. Note that unlike the Servlet
                specification, Aranea permits to use stream and writer
                interchangeably.</td></tr><tr><td><code class="literal">PrintWriter getWriter()</code></td><td>Returns a <code class="literal">PrintWriter</code> that can be
                used to write to response. Note that unlike the Servlet
                specification, Aranea permits to use stream and writer
                interchangeably.</td></tr><tr><td><code class="literal">setContentType(String type)</code></td><td>Sets the MIME content type of the output. May include
                the charset, e.g. "text/html; charset=UTF-8".</td></tr><tr><td><code class="literal">Locale getLocale()</code></td><td>Returns the locale associated with the
                response.</td></tr><tr><td><code class="literal">String
                getCharacterEncoding()</code></td><td>Returns the character encoding used to write out the
                response.</td></tr><tr><td><code class="literal">void setCharacterEncoding(String
                encoding)</code></td><td>Sets the character encoding used to write out the
                response.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="core-services"></a>2.5.&nbsp;Services</h2></div></div></div><p><code class="literal">org.araneaframework.Service</code> is a basic
    abstraction over an event-driven <span class="emphasis"><em>Controller</em></span> pattern
    that inherits life cycle, environment and messaging from the
    <code class="literal">Component</code>. The difference from the
    <code class="literal">Component</code> is as follows: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Service <span class="syntax6">extends</span> Component, Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Interface <span class="syntax9">_getService</span>();

  <span class="syntax6">public</span> <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">action</span>(Path path, InputData input, OutputData output) <span class="syntax6">throws</span> Exception;
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>The method <code class="literal">action()</code> is similar to the
    <code class="literal">service()</code> method in the Servlet API,
    <code class="literal">InputData</code> being an abstraction over a request and
    <code class="literal">OutputData</code> being an abstraction over a response (see
    <a href="#core-io-data" title="2.4.&nbsp;InputData and OutputData">Section&nbsp;2.4, &#8220;InputData and OutputData&#8221;</a>). Thus a service will both process the
    request parameters and render itself during this method call. However
    unlike servlets services can be <span class="emphasis"><em>Composite</em></span> and may be
    defined both statically (on application startup) or dynamically
    (adding/removing new services on the fly).</p><p>Services are the basic working horses of the Aranea framework. They
    can generally be both synchronized and unsynchronized depending on the
    context. Services may also have persistent state and their lifetime is
    explicitly managed by their parent (see <a href="#components-persistence" title="2.3.4.&nbsp;State and Synchronization">Section&nbsp;2.3.4, &#8220;State and Synchronization&#8221;</a>). The service life cycle is very
    simple&#8212;as long as the service is live and enabled it can receive
    <code class="literal">action()</code> calls, possibly several at a time.</p><p>Aranea provides a base implementation of the
    <code class="literal">Service</code> &#8212;
    <code class="literal">org.araneaframework.core.BaseService</code> and a base class
    for application development
    <code class="literal">org.araneaframework.core.BaseApplicationService</code>.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1028"></a>2.5.1.&nbsp;Filter Services</h3></div></div></div><p>One of the most common ways to use the services is to create a
      filter service, that wraps a child service and provides some additional
      functionality and/or environment entries. To that purpose Aranea
      provides a filter base class &#8212;
      <code class="literal">org.araneaframework.framework.core.BaseFilterService</code>.
      This class implements all of the Service methods, by default just
      delegating them to the corresponding child methods. A common thing to do
      is override the <code class="literal">action()</code> method to add functionality
      and <code class="literal">getChildEnvironment()</code> to add environment entries,
      as shown in the following example:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> StandardSynchronizingFilterService 
  <span class="syntax6">extends</span> BaseFilterService <span class="syntax11">{</span>
  
  <span class="syntax6">protected</span> Environment <span class="syntax9">getChildEnvironment</span>() <span class="syntax11">{</span>
    <span class="syntax6">return</span> <span class="syntax6">new</span> <span class="syntax9">StandardEnvironment</span>(
        <span class="syntax9">getEnvironment</span>(), 
        SynchronizingContext.<span class="syntax8">class</span>, 
        <span class="syntax6">new</span> <span class="syntax9">SynchronizingContext</span>() <span class="syntax11">{}</span>);
  <span class="syntax11">}</span>
  
  <span class="syntax6">protected</span> <span class="syntax6">synchronized</span> <span class="syntax8">void</span> <span class="syntax9">action</span>(
      Path path, 
      InputData input, 
      OutputData output) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax4">super</span>.<span class="syntax9">action</span>(path, input, output);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>More information on services and other components that make up the
      framework can be found in <a href="#framework" title="Chapter&nbsp;3.&nbsp;Framework and Configuration">Chapter&nbsp;3, <i>Framework and Configuration</i></a>.</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="core-widgets"></a>2.6.&nbsp;Widgets</h2></div></div></div><p><span class="emphasis"><em>Widget</em></span> is the main abstraction used to program
    applications in Aranea. Widget is specifically any class extending the
    <code class="literal">org.araneaframework.Widget</code> interface and adhering to a
    number of conventions. More generally, widgets are components that
    function both as controllers and GUI elements, and that have the following
    properties: </p><div class="variablelist"><dl><dt><span class="term">Synchronized</span></dt><dd>
             The widget is <span class="emphasis"><em>almost</em></span> always accessed by a single thread, therefore there is rarely 
             any need to think about synchronization. Usually one can assume that there is only one user 
             using the widget at any time and program to service this user without any concern for concurrency.
             There is only one exception to this: one of the default <code class="literal">Widget</code> implementations
             is <code class="literal">BaseApplicationWidget</code> which allows registration of action listeners (see 
             <a href="#actionlisteners" title="2.7.3.&nbsp;Action Listeners">Section&nbsp;2.7.3, &#8220;Action Listeners&#8221;</a>) which can be invoked asynchronously when so desired.
          </dd><dt><span class="term">Stateful</span></dt><dd>
             When programming widgets there is no need to concern oneself with juggling the 

            <code class="literal">HttpSession</code>

             attributes or similar low-level mechanics. Widget state (meaning the class fields) is guaranteed to be preserved as long as the widget is alive. One can just use these fields to save the necessary data without any external state management, thus adhering to the rules of object-oriented encapsulation. 
          </dd></dl></div><p>The latter two properties make widgets ideal for
    programming custom application components.</p><p>Widgets extend services with a request-response cycle:
    </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Widget <span class="syntax6">extends</span> Service, Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Interface <span class="syntax9">_getWidget</span>();
  
  <span class="syntax6">public</span> <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">update</span>(InputData data) <span class="syntax6">throws</span> Exception;
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">event</span>(Path path, InputData input) <span class="syntax6">throws</span> Exception;
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">render</span>(OutputData output) <span class="syntax6">throws</span> Exception;
  <span class="syntax11">}</span> 
<span class="syntax11">}</span>
</span></pre></pre><p>Although widgets extend services, a widget will function during one
    request either as a widget or as a service&#8212;that is if a widget receives an
    <code class="literal">action()</code> call then no other request-response cycle calls can
    occur.</p><p>The widget request-response cycle proceeds as follows: </p><div class="orderedlist"><ol type="1" compact><li><code class="literal">update()</code>

           &#8212;this method is called for all the widgets in the hierarchy. It allows widgets to read the data from request and possibly store some conversation state or at least temporary information to render the next view. 
        </li><li><code class="literal">event()</code>

           &#8212;this method is called on only one widget in the hierarchy. It allows to send events from the user to widgets. The 

          <code class="literal">path</code>

           is used to route the event to the correct widget and is empty when the event is delivered to its endpoint. This method is optional in the widget request-response cycle. 
        </li><li><code class="literal">render()</code>

           &#8212;the way this method is called depends on how widgets are rendered (see 

          <a href="#components-render" title="2.6.1.&nbsp;ViewModel and Rendering">Section&nbsp;2.6.1, &#8220;ViewModel and Rendering&#8221;</a>

           ). It may be called more than once (or not at all) during one request-response cycle. Typically it is called
           once for each widget that has a rendering template defined.
        </li></ol></div><p>Aranea provides a base implementation of the
    <code class="literal">Widget</code>&#8212;<code class="literal">org.araneaframework.core.BaseWidget</code>
    and a base class for application development
    <code class="literal">org.araneaframework.core.BaseApplicationWidget</code>. More on
    the last one can be found in <a href="#core-application-widgets" title="2.7.&nbsp;Application Widgets">Section&nbsp;2.7, &#8220;Application Widgets&#8221;</a>.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="components-render"></a>2.6.1.&nbsp;ViewModel and Rendering</h3></div></div></div><p>The default model of both widget and service rendering is that
      they render themselves. However, in most cases the widget might want to
      delegate the rendering to some templating language. In some other cases
      the widget might be rendered externally, without calling
      <code class="literal">render()</code> at all. Further on, we will describe these
      three cases in detail. </p><div class="variablelist"><dl><dt><span class="term">Self-rendering</span></dt><dd>
               In the most basic situation the widget will just use 

              <code class="literal">OutputData</code>

               for rendering by casting it into e.g. 

              <code class="literal">HttpOutputData</code>

               . In such a case the widget will just write out markup and return from the 

              <code class="literal">render()</code>

               method optionally rendering children as well. The data for rendering will be drawn from the widget fields, children and
               widget <code class="literal">Environment</code>.
			</dd><dt><span class="term">Using templates for rendering</span></dt><dd>
               The most common case in application widgets is to delegate rendering to a templating language. A widget may basically choose to render itself in arbitrary templating language as Aranea does not impose any restrictions. In fact, one widget may be rendered with one templating language, while another one with a completely different language. The template can gain access to the widget using the knowledge of the widget's full name (which is gathered in the 

              <code class="literal">OutputData</code>

               scope). It is then possible to acquire the widget View Model, which is a read-only representation of the widget state. For that the widget should implement 

              <code class="literal">org.araneaframework.Viewable</code>

               : 

              <pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Viewable <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> Interface <span class="syntax9">_getViewable</span>();

  <span class="syntax8">interface</span> Interface <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
    <span class="syntax6">public</span> Object <span class="syntax9">getViewModel</span>() <span class="syntax6">throws</span> Exception;
  <span class="syntax11">}</span>  
<span class="syntax11">}</span>
</span></pre></pre>

               View model is put together by the widget being rendered and should contain all the data necessary to render the widget. 
            </dd><dt><span class="term">External rendering</span></dt><dd><p>Finally, a widget <code class="literal">render()</code> method may
              not be called altogether and a <code class="literal">Viewable</code>
              widget may be rendered externally using the available View
              Model. This is the case with some reusable widgets which are
              rendered using e.g. JSP tags.</p></dd></dl></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="core-application-widgets"></a>2.7.&nbsp;Application Widgets</h2></div></div></div><p>This section explains how to program applications using widgets as
    the main abstraction.</p><p>A typical application widget class will extend
    <code class="literal">org.araneaframework.uilib.core.BaseUIWidget</code>. This
    widget represents the usual custom application component that is rendered
    using Aranea custom JSP tags. <code class="literal">BaseUIWidget</code> inherits
    most of its functionality from
    <code class="literal">org.araneaframework.core.BaseApplicationWidget</code> the
    difference between the two being only that <code class="literal">BaseUIWidget</code>
    assumes to be connected with a JSP page (or another templating
    toolkit).</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1198"></a>2.7.1.&nbsp;Children Management</h3></div></div></div><p><code class="literal">BaseApplicationWidget</code> provides a number of
      methods for managing child widgets:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax6">abstract</span> <span class="syntax8">class</span> BaseApplicationWidget ... <span class="syntax11">{</span>
  ...
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">addWidget</span>(Object key, Widget child);
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">removeWidget</span>(Object key);
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">enableWidget</span>(Object key);
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">disableWidget</span>(Object key);
  ...
<span class="syntax11">}</span>
</span></pre></pre><p>As one can see, every added child has an identifier which should
      be unique among its siblings. This identifier is used when rendering and
      sending events to the widget in question, to identify it among its
      peers. Together with widget's parents identifiers this forms a unique identifier (<span class="emphasis"><em>scope</em></span>)
      of widget in the component hierarchy.</p><p>Typically, children are added when created:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">addWidget</span>(<span class="syntax3">"myChildWidget"</span>, <span class="syntax6">new</span> <span class="syntax9">MyChildWidget</span>(<span class="syntax3">"String parameter"</span>, <span class="syntax12">1</span>));
</span></pre></pre><p>An added child will be initialized, will receive updates and
      events and may be rendered. A widget can be active only if added to a
      parent. It will live as long as the parent, unless the parent explicitly
      removes it:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">removeWidget</span>(<span class="syntax3">"myChildWidget"</span>);
</span></pre></pre><p>Removing a child widget will destroy it and one should also
      dispose of any references that may be pointing to it, to allow the child
      to be garbage collected.</p><p>A usual idiom is to save a reference to the newly created and
      added child using a parent widget field:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MyWidget <span class="syntax6">extends</span> BaseUIWidget <span class="syntax11">{</span>
  <span class="syntax6">private</span> MyChildWidget myChildWidget;
  
  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax11">{</span>
    myChildWidget <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">MyWidget</span>(<span class="syntax3">"String parameter"</span>, <span class="syntax12">1</span>);
    <span class="syntax9">addWidget</span>(<span class="syntax3">"myChildWidget"</span>, myChildWidget);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>This allows to call directly child widget methods and does not
      anyhow significantly increase memory usage, so this technique may be
      used everywhere when needed.</p><p>Disabling a child
      (<code class="literal">disableWidget("myChildWidget")</code>) will stop it from
      receiving any events or rendering, but will not destroy it. It can later
      be reenabled by calling
      <code class="literal">enableWidget("myChildWidget")</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="EventListeners"></a>2.7.2.&nbsp;Event Listeners</h3></div></div></div><p>Registering event listeners allows widgets to subscribe to some
      specific user events (widget will receive only events specially sent to
      it). The distinction comes by the "event identifier" that is assigned to
      an event when sending it. The events are handled by the classes
      extending
      <code class="literal">org.araneaframework.core.EventListener</code>:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> EventListener <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">processEvent</span>(String eventId, InputData input) <span class="syntax6">throws</span> Exception;
<span class="syntax11">}</span>
</span></pre></pre><p>The event listeners are registered as following:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">addEventListener</span>(<span class="syntax3">"myEvent"</span>, <span class="syntax6">new</span> <span class="syntax9">EventListener</span>() <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">processEvent</span>(String eventId, InputData input) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    log.<span class="syntax9">debug</span>(<span class="syntax3">"Received event: "</span> <span class="syntax11">+</span> eventId);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>Of course, the event listener does not have to be an anonymous
      class and can just as well be an inner or even a usual public class. A
      standard base implementation
      <code class="literal">org.araneaframework.core.StandardEventListener</code> is
      provided that receives an optional <code class="literal">String</code> event
      parameter:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">addEventListener</span>(<span class="syntax3">"myEvent"</span>, <span class="syntax6">new</span> <span class="syntax9">StandardEventListener</span>() <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">processEvent</span>(String eventId, String eventParam, InputData input) <span class="syntax6">throws</span> Exception;
    log.<span class="syntax9">debug</span>(<span class="syntax3">"Received event "</span> <span class="syntax11">+</span> eventId <span class="syntax11">+</span> <span class="syntax3">" with parameter "</span> <span class="syntax11">+</span> parameter);
  <span class="syntax11">}}</span>
</span></pre></pre><p>In case you want to receive multiple event parameters, you may choose to implement
      <code class="literal">MultiParamEventListener</code>. The default separator used to split up the values
      is a semi-comma. Here's an example:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">addEventListener</span>(<span class="syntax3">"myEvent"</span>, <span class="syntax6">new</span> <span class="syntax9">MultiParamEventListener</span>() <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">processEvent</span>(String eventId, String[] eventParams, InputData input) <span class="syntax6">throws</span> Exception;
    log.<span class="syntax9">debug</span>(<span class="syntax3">"Received event "</span> <span class="syntax11">+</span> eventId <span class="syntax11">+</span> <span class="syntax3">" with "</span> <span class="syntax11">+</span> eventParams.length <span class="syntax11">+</span> <span class="syntax3">" parameter(s)."</span>);
  <span class="syntax11">}}</span>
</span></pre></pre><p>Another useful way to process events is to register a proxy event
      listener
      (<code class="literal">org.araneaframework.core.ProxyEventListener</code>) that
      will proxy the event to a method call, e.g.:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax11">{</span>
  <span class="syntax9">addEventListener</span>(<span class="syntax3">"myEvent"</span>, <span class="syntax6">new</span> <span class="syntax9">ProxyEventListener</span>(<span class="syntax4">this</span>));
<span class="syntax11">}</span>

<span class="syntax1">// This method handles the event that was registered in init().</span>
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">handleEventMyEvent</span>(String parameter) <span class="syntax11">{</span>
    log.<span class="syntax9">debug</span>(<span class="syntax3">"Received event myEvent with parameter "</span> <span class="syntax11">+</span> parameter);
<span class="syntax11">}</span>

<span class="syntax1">// In case of receiving multiple parameters, you might prefer this:</span>
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">handleEventMyEvent</span>(String[] parameters) <span class="syntax11">{</span>
    log.<span class="syntax9">debug</span>(<span class="syntax3">"Received event myEvent with "</span> <span class="syntax11">+</span> parameters.length <span class="syntax11">+</span> <span class="syntax3">" parameter(s)."</span>);
<span class="syntax11">}</span>
</span></pre></pre><p>The convention is that the proxy event listener translates an
      event "&lt;event&gt;" into a method call
      <code class="literal">handleEvent&lt;Event&gt;</code> making the first letter of
      &lt;event&gt; uppercase. The <code class="literal">"String parameter</code>" is
      optional and can be omitted. First, the proxy event listener tries to call
      <code class="literal">handleEvent&lt;Event&gt;()</code>,
      then <code class="literal">handleEvent&lt;Event&gt;(String param)</code>, and finally
      <code class="literal">handleEvent&lt;Event&gt;(String[] params)</code>, whichever succeeds first
      (after the first event handler is found and finishes its work successfully, then the latter
      ones are not called).</p><p>In the case of <code class="literal">String[]</code> parameters, the array contains the parameter
      value split up into array. The default value separator is a semi-comma, but you can override
      it by adding a custom method <code class="literal">getParameterSeparator(String value)</code> (also
      supported by <code class="literal">MultiParamEventListener</code>), which
      should return a separator of the value. For, example you can provide the event param as
      <code class="literal">"123;456;789;"</code>, and with the array parameter type they would be provided as
      <code class="literal">new String[] { "123", "456", "789" }</code>.</p><p>A useful feature is the method
      <code class="literal">setGlobalEventListener(EventListener listener)</code> that
      allows to register a listener that will receive all events sent to the
      widget. In fact <code class="literal">BaseUIWidget</code> does that by default,
      and typically you will use the individual event listeners only when you
      want to override this default behaviour. This allows to just define
      correct method names (<code class="literal">handleEvent&lt;event&gt;</code>) and
      all events will be translated to the calls to these methods. Certainly
      this can also be cancelled by calling
      <code class="literal">clearGlobalEventListener()</code>, or overridden by adding
      your own global event listener.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="actionlisteners"></a>2.7.3.&nbsp;Action Listeners</h3></div></div></div><p>Registering action listeners allows widgets to subscribe to some
      specific user generated actions. Actions differ from events in that
      widget lifecycle execution for whole component tree is not triggered
      upon request&#8212;actions are just sent to the receiving widget's <span class="emphasis"><em>ActionListener</em></span>, 
      which is SOLELY responsible for generating the whole response. For rich UI components this allows a quick
      conversations with server, without requiring full form submits and generating whole view.
      </p><p>Actions are handled by the classes extending <code class="literal">org.araneaframework.core.ActionListener</code>
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> ActionListener <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">processAction</span>(String actionId, InputData input, OutputData output) <span class="syntax6">throws</span> Exception;
<span class="syntax11">}</span>
</span></pre></pre><p> and their registration is analogous to event listeners:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">addActionListener</span>(<span class="syntax3">"actionId"</span>, <span class="syntax6">new</span> <span class="syntax9">SomeActionListener</span>());
</span></pre></pre><p>
      </p><p>Similarily to event listeners, there are also two default implementations of
      <code class="literal">ActionListener</code>: <code class="literal">StandardActionListener</code> and
      <code class="literal">MultiParamActionListener</code>. They are used like corresponding event listeners
      except that ActionListeners are also provided with <code class="literal">OutputData</code> to handle
      response.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="widgets-environment"></a>2.7.4.&nbsp;Environment</h3></div></div></div><p>Every initialized widget has a reference to
      <code class="literal">org.araneaframework.Environment</code> available through the
      <code class="literal">getEnvironment()</code> method. Environment allows to look
      up framework services (called <span class="emphasis"><em>contexts</em></span>):</p><pre class="programlisting"><pre><span class="syntax0">MessageContext msgCtx <span class="syntax11">=</span> (MessageContext) <span class="syntax9">getEnvironment</span>().<span class="syntax9">getEntry</span>(MessageContext.<span class="syntax8">class</span>);
msgCtx.<span class="syntax9">showInfoMessage</span>(<span class="syntax3">"Hello world!"</span>);
</span></pre></pre><p>As one can see from the examples, contexts are looked up using
      their interface <code class="literal">Class</code> object as key. All framework
      services in Aranea are accessible only using the environment.</p><p>To find out more about <code class="literal">Environment</code> see <a href="#core-environment" title="2.3.2.&nbsp;Environment">Section&nbsp;2.3.2, &#8220;Environment&#8221;</a></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1392"></a>2.7.5.&nbsp;Overridable Methods</h3></div></div></div><p>The main method that is typically overridden in a widget is
      <code class="literal">init()</code>. As widget does not get an environment before
      it is added and initialized it is impossible to access framework
      services in the constructor, therefore most of the initialization logic
      moves to the custom <code class="literal">init()</code> method. A dual overridable
      method is <code class="literal">destroy()</code>, though it is used much
      less.</p><p>In addition to event processing it is sometimes useful to do some
      kind of preprocessing. The <code class="literal">BaseApplicationWidget</code> has the following method that
      may be overridden to allow this processing:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">handleUpdate</span>(InputData input) <span class="syntax6">throws</span> Exception <span class="syntax11">{}</span>
</span></pre></pre><p><code class="literal">handleUpdate()</code> is called before event listeners
      are notified and allows to read and save request data preparing it for
      the event. More importantly, this method is called even when no event is
      sent to the current widget allowing one to submit some data to any
      widget.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e1418"></a>2.7.6.&nbsp;InputData and OuputData</h3></div></div></div><p>In Aranea one usually does not need to handle request manually in
      custom application widgets. Even more, the request is not accessible by
      default. The usual way to submit custom data to a widget and read it is
      using Aranea Forms (see <a href="#forms" title="Chapter&nbsp;5.&nbsp;Forms and Data Binding">Chapter&nbsp;5, <i>Forms and Data Binding</i></a>). However, when one
      needs to access the submitted data, one can do that using the
      <code class="literal">org.araneaframework.InputData</code>. This class can be used
      as follows: </p><pre class="programlisting"><pre><span class="syntax0">...
String myData1 <span class="syntax11">=</span> 
  (String) <span class="syntax9">getInputData</span>().<span class="syntax9">getScopedData</span>().<span class="syntax9">get</span>(<span class="syntax3">"myData1"</span>);
String globalSubmittedParameter <span class="syntax11">=</span> 
  (String) <span class="syntax9">getInputData</span>().<span class="syntax9">getGlobalData</span>().<span class="syntax9">get</span>(<span class="syntax3">"globalSubmittedParameter"</span>);
...
</span></pre></pre><p> <code class="literal">getInputData()</code> is a
      <code class="literal">BaseApplicationWidget</code> method that returns the input
      data for the current request (one can also use the
      <code class="literal">input</code> parameter given to event listener
      directly).</p><p><code class="literal">org.araneaframework.OutputData</code> is accessible
      through the <code class="literal">getOutputData()</code> method of
      <code class="literal">BaseWidget</code> or directly as the
      <code class="literal">output</code> parameter passed to
      <code class="literal">render()</code> method.</p><p>To find out more about <code class="literal">InputData</code> and
      <code class="literal">OutputData</code> see <a href="#core-io-data" title="2.4.&nbsp;InputData and OutputData">Section&nbsp;2.4, &#8220;InputData and OutputData&#8221;</a></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="widget-view-selector"></a>2.7.7.&nbsp;View Model and Rendering</h3></div></div></div><p><code class="literal">BaseApplicationWidget</code> also contains methods
      that facilitate transferring data to the presentation layer. This is
      achieved using a <span class="emphasis"><em>View model</em></span>&#8212;an object containing a
      snapshot of the widget current state. The most typical way to use the
      view model it to add data to it:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">putViewData</span>(<span class="syntax3">"today"</span>, <span class="syntax6">new</span> <span class="syntax9">Date</span>());
<span class="syntax9">putViewData</span>(<span class="syntax3">"currentUser"</span>, userBean);
...
</span></pre></pre><p>View data is typically accessible in the presentation layer as
      some kind of a variable (e.g. a JSP EL variable) for the current widget.
      If the data becomes outdated one can override it using
      <code class="literal">putViewData()</code> call or remove it using the
      <code class="literal">removeViewData()</code> call. In case one needs to put view
      data that would last one request only there is an alternative
      method:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">putViewDataOnce</span>(<span class="syntax3">"now"</span>, <span class="syntax6">new</span> <span class="syntax9">Date</span>());
...
</span></pre></pre><p>Finally widget instance is also visible to the view, so one of the
      ways to make some data accessible is just to define a JavaBean style
      getter:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> Date <span class="syntax9">getNow</span>() <span class="syntax11">{</span>
  <span class="syntax6">return</span> <span class="syntax6">new</span> <span class="syntax9">Date</span>();
<span class="syntax11">}</span>
...
</span></pre></pre><p><code class="literal">BaseUIWidget</code> allows to render the
      current widget using a JSP page. To do that one needs to select a view
      as follows:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">setViewSelector</span>(<span class="syntax3">"myWidget/form"</span>);
...
</span></pre></pre><p>This code makes the widget render itself using the JSP situated in
      <code class="literal">WEB-INF/jsp/myWidget/form.jsp</code> (of course the exact
      place is configurable). It is also possible to render the widget using
      other template technologies with the same view selector by overriding
      the <code class="literal">render()</code> method in the base project
      widget.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="widgets-example-widget"></a>2.7.8.&nbsp;Putting It All Together</h3></div></div></div><p>A typical application custom widget will look like that:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> TestWidget <span class="syntax6">extends</span> BaseUIWidget <span class="syntax11">{</span>

  <span class="syntax6">private</span> <span class="syntax6">static</span> <span class="syntax6">final</span> Logger log <span class="syntax11">=</span> Logger.<span class="syntax9">getLogger</span>(TestWidget.<span class="syntax8">class</span>);
  
  <span class="syntax6">private</span> Data data;
  
  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax1">//Sets the JSP for this widget to "/WEB-INF/jsp/home.jsp"</span>
    <span class="syntax9">setViewSelector</span>(<span class="syntax3">"home"</span>);
    
    <span class="syntax1">//Get data from the business layer</span>
    data <span class="syntax11">=</span> ((TestService) <span class="syntax9">lookupService</span>(<span class="syntax3">"testService"</span>)).<span class="syntax9">getData</span>(<span class="syntax3">"test parameter"</span>);
    
    <span class="syntax1">//Make the data accessible to the JSP for rendering</span>
    <span class="syntax9">putViewData</span>(<span class="syntax3">"myData"</span>, data);    
  <span class="syntax11">}</span>
  
  <span class="syntax1">/*</span>
<span class="syntax1">   * Event listener method that will process "test" event.</span>
<span class="syntax1">   */</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">handleEventTest</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax9">getMessageCtx</span>().<span class="syntax9">showInfoMessage</span>(<span class="syntax3">"Test event received successfully"</span>);       
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e1516"></a>2.8.&nbsp;Standard Contexts</h2></div></div></div><p>Contexts are the Aranea way to access framework services. They can
    be looked up from the environment as shown in <a href="#widgets-environment" title="2.7.4.&nbsp;Environment">Section&nbsp;2.7.4, &#8220;Environment&#8221;</a>. This section describes the most common
    Aranea contexts that should be available in any typical configuration. All
    these contexts are also available directly through
    <code class="literal">BaseUIWidget</code> methods as shown further on.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="MessageContext"></a>2.8.1.&nbsp;MessageContext</h3></div></div></div><p><code class="literal">org.araneaframework.framework.MessageContext</code>
      allows to show messages to the user. The messages can be of several
      types, including predefined error and informative types. Typically
      messages will be shown somewhere in the application (exact way is
      application-specific). <code class="literal">MessageContext</code> is available
      through a <code class="literal">BaseUIWidget</code> method
      <code class="literal">getMessageCtx()</code> and is typically used as
      follows:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">getMessageCtx</span>().<span class="syntax9">showInfoMessage</span>(<span class="syntax3">"Hello world!"</span>);
</span></pre></pre><p><code class="literal">MessageContext</code> divides messages by type (with
      predefined "info", "warning" and "error" types available) and life span
      (usual or permanent). Usual messages are shown to user once and then
      cleared, while permanent messages will be shown to user until explicitly
      cleared by the programmer:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">showMessage(String type, String
                message)</code></td><td>Shows a message <code class="literal">message</code> of type
                <code class="literal">type</code> to the user.</td></tr><tr><td><code class="literal">showMessages(String type, Set&lt;String&gt; messages)</code></td><td>Shows messages of type <code class="literal">type</code> to the user.</td></tr><tr><td><code class="literal">showInfoMessage(String
                message)</code></td><td>Shows an error message to the user.</td></tr><tr><td><code class="literal">hideInfoMessage(String
                message)</code></td><td>Hides an info message from user.</td></tr><tr><td><code class="literal">showWarningMessage(String
                message)</code></td><td>Shows a warning message to the user.</td></tr><tr><td><code class="literal">hideWarningMessage(String message)</code></td><td>Hides a warning message from user.</td></tr><tr><td><code class="literal">showErrorMessage(String
                message)</code></td><td>Shows an informative message to the user.</td></tr><tr><td><code class="literal">hideErrorMessage(String message)</code></td><td>Hides an error message from user.</td></tr><tr><td><code class="literal">clearMessages()</code></td><td>Clears all non-permanent messages.</td></tr><tr><td><code class="literal">showPermanentMessage(String type, String
                message)</code></td><td>Shows a permanent message <code class="literal">message</code> of
                type <code class="literal">type</code> to the user. The message will be
                shown until hidden explicitly.</td></tr><tr><td><code class="literal">hideMessage(String type, String message);</code></td><td>Removes a message <code class="literal">message</code> of type <code class="literal">type</code>.</td></tr><tr><td><code class="literal">hideMessages(String type, Set&lt;String&gt; messages);</code></td><td>Removes messages of type <code class="literal">type</code>.</td></tr><tr><td><code class="literal">hidePermanentMessage(String
                message)</code></td><td>Clears the specific permanent message, under all
                message types where it might be present.</td></tr><tr><td><code class="literal">clearPermanentMessages()</code></td><td>Clears all of the permanent messages.</td></tr><tr><td><code class="literal">clearAllMessages()</code></td><td>Clears all messages (both permanent and usual).</td></tr><tr><td><code class="literal">Map&lt;String, Collection&gt; getMessages()</code></td><td>Returns all present messages as a Map. Keys of the Map are the different message types encountered so far and under the keys 
                are the messages in a Collection.</td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Messages should already be localized when passed to the
        <code class="literal">MessageContext</code>, it does not do any further
        processing. Use <code class="literal">LocalizationContext</code> described in
        <a href="#LocalizationContext" title="2.8.2.&nbsp;LocalizationContext">Section&nbsp;2.8.2, &#8220;LocalizationContext&#8221;</a> to do the actual localization
        of the added message.</p></div><p>For information on implementation of the
      <code class="literal">MessageContext</code> see <a href="#araneaMessagingFilter" title="3.5.8.&nbsp;User Messages Filter">Section&nbsp;3.5.8, &#8220;User Messages Filter&#8221;</a>. For standard JSP tag which renders <code class="literal">MessageContext</code>
      messages to response, see <a href="#uimessagesjsp">&lt;ui:messages&gt;</a>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="LocalizationContext"></a>2.8.2.&nbsp;LocalizationContext</h3></div></div></div><p><code class="literal">org.araneaframework.framework.LocalizationContext</code>
      allows to get and set current session locale, localize strings and
      messages, and lookup resource bundles. The context is available through
      the <code class="literal">BaseUIWidget</code> method
      <code class="literal">getL10nCtx()</code>. Typically it is used as follows:</p><pre class="programlisting"><pre><span class="syntax0">
...
String message <span class="syntax11">=</span> <span class="syntax9">getL10nCtx</span>().<span class="syntax9">localize</span>(<span class="syntax3">"my.message.key"</span>);
<span class="syntax9">getMessageCtx</span>().<span class="syntax9">showInfoMessage</span>(message);
...
</span></pre></pre><p><code class="literal">LocalizationContext</code> provides the following
      methods:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">Locale getLocale()</code></td><td>Returns the current session locale.</td></tr><tr><td><code class="literal">setLocale(Locale locale)</code></td><td>Sets the current session locale.</td></tr><tr><td><code class="literal">String localize(String key)</code></td><td>Localizes a string returning one that corresponds to
                the current locale.</td></tr><tr><td><code class="literal">ResourceBundle
                getResourceBundle()</code></td><td>Returns a resource bundle corresponding to the current
                locale.</td></tr><tr><td><code class="literal">ResourceBundle getResourceBundle(Locale
                locale)</code></td><td>Returns a resource bundle corresponding to arbitrary
                locale.</td></tr><tr><td><code class="literal">String getMessage(String code, Object[]
                args)</code></td><td>Localizes the code and uses it to format the message
                with the passed arguments. The format of the localized message
                should be acceptable by
                <code class="literal">java.text.MessageFormat</code>.</td></tr><tr><td><code class="literal">String getMessage(String code, Object[] args,
                String defaultMessage)</code></td><td>Localizes the code and uses it to format the message
                with the passed arguments. The format of the localized message
                should be acceptable by
                <code class="literal">java.text.MessageFormat</code>. If the localized
                message cannot be resolved uses
                <code class="literal">defaultMessage</code> instead.</td></tr><tr><td><code class="literal">void addLocaleChangeListener(LocaleChangeListener listener);</code></td><td>Registers a listener (<code class="literal">Component</code>) that will be notified when locale is changed.</td></tr><tr><td><code class="literal">boolean removeLocaleChangeListener(LocaleChangeListener listener)</code></td><td>Unregisters listener (<code class="literal">Component</code>) so that it will not be notified of locale changes anymore. Returns
                whether the listener was found to be present and actually removed.</td></tr></tbody></table></div><p>For information on implementation of the
      <code class="literal">LocalizationContext</code> see <a href="#araneaLocalizationFilter" title="8.1.2.&nbsp;Spring Localization Filter">Section&nbsp;8.1.2, &#8220;Spring Localization Filter&#8221;</a>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="FlowContext"></a>2.8.3.&nbsp;FlowContext</h3></div></div></div><p>A common need in a web programming is to support navigation style
      known as <span class="emphasis"><em>flows</em></span>&#8212;interactive stateful processes that
      can navigate to each other passing arguments when needed. A more complex
      case is when we also have flow nesting&#8212;a flow can call a subflow, and
      wait for it to finish, then reactivate again. In this case we can have
      at any given moment a stack of flows, where the top one is active, and
      the next one will reactivate when the top one finishes. It is also
      useful if nested flows can return resulting values when they
      finish.</p><div class="figure"><a name="d0e1822"></a><div class="mediaobject"><img src="../images/flows.png" alt="Flow diagram"></div><p class="title"><b>Figure&nbsp;2.2.&nbsp;Flow diagram</b></p></div><p><code class="literal">org.araneaframework.framework.FlowContext</code> is
      the Aranea context that provides support for nested flow navigation.
      Aranea flow is a widget that is running in the flow container (using the
      <code class="literal">FlowContext.start()</code> method. Aranea abstraction for
      the nested state is that of a function&#8212;the nested
      <span class="emphasis"><em>flow</em></span> takes in some parameters and when finished may
      return some value or signal that no value can be returned. The context
      is available as <code class="literal">getFlowCtx()</code> method of
      <code class="literal">BaseUIWidget</code> and allows to start flows, finish flows
      and return the resulting value.</p><p>To start a new flow one needs to create a widget as usual. The
      widget may take some parameters in the constructor&#8212;they are considered
      to be the incoming parameters of the flow:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">getFlowCtx</span>().<span class="syntax9">start</span>(<span class="syntax6">new</span> <span class="syntax9">TestFlow</span>(<span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">5</span>)));
...
</span></pre></pre><p>This call will start a new nested flow for the widget
      <code class="literal">TestFlow</code> making the current flow inactive.
      <code class="literal">TestFlow</code> will render and receive event until it
      explicitly returns control to the starting flow. Note that this code
      will start the flow and then return the control, so it is important not
      to do anything in the same method after starting a new flow.</p><p>To end the flow successfully one needs to do as follows:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">getFlowCtx</span>().<span class="syntax9">finish</span>(<span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">8</span>));
...
</span></pre></pre><p>This call will finish the current flow (in our case
      <code class="literal">TestFlow</code>) and return the control to the starting flow
      and its widget.</p><p>Often one needs to handle the return from the flow, processing the
      returned result. This corresponds to our abstraction of a method,
      however since Java does not support continuations we chose to allow the
      caller to register a handler when starting the flow by passing a
      <code class="literal">FlowContext.Handler</code>:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">getFlowCtx</span>().<span class="syntax9">start</span>(<span class="syntax6">new</span> <span class="syntax9">TestFlow</span>(<span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">5</span>)),
  <span class="syntax6">new</span> FlowContext.<span class="syntax9">Handler</span>() <span class="syntax11">{</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">onFinish</span>(Object result) <span class="syntax11">{</span>
      <span class="syntax9">getMessageCtx</span>().<span class="syntax9">showInfoMessage</span>(<span class="syntax3">"TestFlow returned value "</span> <span class="syntax11">+</span> result);
    <span class="syntax11">}</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">onCancel</span>() <span class="syntax11">{</span>
      <span class="syntax1">//Ignore cancelled flow</span>
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>);
...
</span></pre></pre><p></p><p>A less common but nevertheless useful feature is to configure the
      starting flow after it has been initialized. For that the caller needs
      to pass a <code class="literal">FlowContext.Configurator</code>:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">getFlowCtx</span>().<span class="syntax9">start</span>(<span class="syntax6">new</span> <span class="syntax9">TestFlow</span>(<span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">5</span>)), 
  <span class="syntax6">new</span> FlowContext.<span class="syntax9">Configurator</span>() <span class="syntax11">{</span>
     <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">configure</span>(Component comp) <span class="syntax11">{</span>
      ((TestFlow) comp).<span class="syntax9">setStrategy</span>(TestFlow.ATTACK);
     <span class="syntax11">}</span>
  <span class="syntax11">}</span>, <span class="syntax4">null</span>);
...
</span></pre></pre><p></p><p><code class="literal">FlowContext</code> also allows to replace the
      current flow instead of deactivating it by using the
      <code class="literal">replace()</code> method and to cancel the current flow by
      using the <code class="literal">cancel()</code> method.</p><p>
      	Transitions between the flows are performed by <code class="literal">FlowContext.TransitionHandler</code>s.
      	
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">interface</span> TransitionHandler <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
   <span class="syntax2">/**</span>
<span class="syntax2">    * </span><span class="syntax5">@param</span><span class="syntax2"> eventType FlowContext.START .. FlowContext.RESET</span>
<span class="syntax2">    * </span><span class="syntax5">@param</span><span class="syntax2"> activeFlow active flow at the moment of transition request</span>
<span class="syntax2">    * </span><span class="syntax5">@param</span><span class="syntax2"> transition Serializable closure that needs to be executed for transition to happen</span>
<span class="syntax2">    </span><span class="syntax2">*/</span>
   <span class="syntax8">void</span> <span class="syntax9">doTransition</span>(<span class="syntax8">int</span> eventType, Widget activeFlow, Closure transition);
<span class="syntax11">}</span>
</span></pre></pre><p>
      </p><p>
        After initialization, each flow may set the <code class="literal">TransitionHandler</code> which will
        handle navigation events performed while flow which set the <code class="literal">TransitionHandler</code> 
        is active. This can be used to customize navigation logic&#8212;i.e. ask for confirmations 
        when navigating away from flow containing unsaved data, restore window scroll position when
        returning to caller flow or checking for privileges before starting the next flow.
      </p><p>For standard implementation, please see <a href="#araneaRootFlowContainer" title="3.5.18.&nbsp;Root Flow Container">Section&nbsp;3.5.18, &#8220;Root Flow Container&#8221;</a></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="PopupWindowContext"></a>2.8.4.&nbsp;PopupWindowContext</h3></div></div></div><p>
			Popup windows in Aranea are separate threads that are started using
			<code class="literal">org.araneaframework.http.PopupWindowContext</code>. Popups can
			be used, for example, to open new widgets or to upload files (using
			<code class="literal">org.araneaframework.http.service.FileDownloaderService</code>).
			To open a new widget in a popup, the widget must handle the entire page,
			and its subwidgets may handle certain specific parts of a page. This is
			similar to how a root widget handles the components in the main thread.
			</p><p>
			One can access the <code class="literal">PopupWindowContext</code> by getting it from
			the <code class="literal">Environment</code>. If it is accessed from a widget that extends
			<code class="literal">BaseUIWidget</code>, the <code class="literal">getPopupCtx()</code> method can
			be used. (Since <code class="literal">PopupWindowContext</code> is mainly used inside
			<code class="literal">BaseUIWidget</code> then the examples below will use the
			<code class="literal">getPopupCtx()</code> approach.)
			</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">String open(Message startMessage, PopupWindowProperties properties, Widget opener)</code></td><td>Uses a message that opens a widget inside a new popup.</td></tr><tr><td><code class="literal">String open(Service service, PopupWindowProperties properties, Widget opener)</code></td><td>Uses a service that serves the data for a new popup.</td></tr><tr><td><code class="literal">String openMounted(String url, PopupWindowProperties properties)</code></td><td>Opens the mount URL in a popup.</td></tr><tr><td><code class="literal">open(String url, PopupWindowProperties properties)</code></td><td>Opens the given URL in a popup.</td></tr><tr><td><code class="literal">boolean close(String id) throws Exception</code></td><td>Closes the popup with given ID (the ID is returend when the popup is created).</td></tr><tr><td><code class="literal">Widget getOpener()</code></td><td>Provides the popup opener.</td></tr><tr><td><code class="literal">Map getPopups()</code></td><td>Returns a map with popups (the key is the ID of the popup, and
							the value is an instance of <code class="literal">PopupServiceInfo</code>.</td></tr></tbody></table></div><p>
			To enable popups at JSP layer, one must also register it inside the system form like
			the following code example does:

</p><pre class="programlisting"><pre><span class="syntax0">...
  <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">body</span><span class="syntax10">&gt;</span>
    ...
      <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">systemForm</span><span class="syntax10"> method</span>=<span class="syntax3">"</span><span class="syntax3">post</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
        ...
          <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">registerPopups</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        ...
      <span class="syntax10">&lt;</span><span class="syntax10">/ui:</span><span class="syntax9">systemForm</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/ui:</span><span class="syntax9">body</span><span class="syntax10">&gt;</span>
...
</span></pre></pre><p>
			</p><p>
			Standard implementation of <code class="literal">PopupWindowContext</code> is described in
			<a href="#araneaPopupFilter" title="3.5.9.&nbsp;Popup Windows Filter">Section&nbsp;3.5.9, &#8220;Popup Windows Filter&#8221;</a>.
			</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="SimpleFileDownloading"></a>Simple File Downloading with Popups</h4></div></div></div><p>
				Here is an example on how the server component can provide file downloading operation:

</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">getPopupCtx</span>().<span class="syntax9">open</span>(
    <span class="syntax6">new</span> <span class="syntax9">FileDownloaderService</span>(selectedFile),
    <span class="syntax6">new</span> <span class="syntax9">PopupWindowProperties</span>(), <span class="syntax4">null</span>);
</span></pre></pre><p>

				In the example above, the first parameter is the service that downloads the file
				to the user's computer, and the second one is the popup window properties. Sometimes 
				one may want to also specify the widget that caused the popup to open.
				Therefore, the last parameter in the example is the opener, which usually is
				<code class="literal">null</code>, but may be provided as <code class="literal">this</code> (the caller widget).
				(The popup widget can access the opener by <code class="literal">PopupWindowContext.getOpener()</code>.)
				</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="AjaxFileDownloading"></a>AJAX File Downloading with Popups</h4></div></div></div><p>
				Another way to provide the file downloading option is without a page load: the AJAX
				solution. To make it work, one would have to register a
				<code class="literal">org.araneaframework.http.core.FileDownloadActionListener</code> as an
				action listener in widget. The latter expects the popup window context and the file
				to download or a callback to provide the file info. Since mostly one needs to
				provide the file once it is requested, the following example demonstrates the
				callback solution on the server side in a widget:

</p><pre class="programlisting"><pre><span class="syntax0">  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax1">// ... other init() code here ...</span>
    <span class="syntax9">addActionListener</span>(<span class="syntax3">"download"</span>, <span class="syntax6">new</span> <span class="syntax9">FileDownloadActionListener</span>(
        <span class="syntax9">getPopupCtx</span>(), <span class="syntax6">new</span> <span class="syntax9">DemoFileHandler</span>()));
  <span class="syntax11">}</span>

  <span class="syntax1">// Our custom implementation handler to provide file data to FileDownloadActionListener:</span>
  <span class="syntax6">private</span> <span class="syntax8">class</span> DemoFileHandler <span class="syntax6">extends</span> FileDownloadActionListener.FileDownloadHandler <span class="syntax11">{</span>

    <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">prepareServiceData</span>(String actionId, String actionParam, InputData input,
        OutputData output) <span class="syntax11">{</span>
      <span class="syntax1">// The action parameter, in this case, is a list row ID.</span>
      <span class="syntax6">if</span> (actionParam <span class="syntax11">!=</span> <span class="syntax4">null</span>) <span class="syntax11">{</span>
        FileInfo file <span class="syntax11">=</span> (FileInfo) list.<span class="syntax9">getRowFromRequestId</span>(actionParam);
        <span class="syntax4">this</span>.<span class="syntax9">readData</span>(file);
      <span class="syntax11">}</span>
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>
</span></pre></pre><p>
				As you may notice, the listener is registered with the ID "<code class="literal">download</code>"
				(which is later used to invoke the listener), and the listener uses action parameter to
				return the correct file from a <code class="literal">ListWidget</code>. Here the file info is
				stored as a <code class="literal">FileInfo</code> object, but usually one has just bytes and the
				file name. In the latter case, a simple solution is just to set the file data as
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">prepareServiceData</span>(String actionId, String actionParam,
    InputData input, OutputData output) <span class="syntax11">{</span>

  <span class="syntax8">byte</span>[] fileBytes <span class="syntax11">=</span> <span class="syntax4">null</span>;

  <span class="syntax1">// ... Retrieve the data ...</span>

  <span class="syntax1">// Store the data in variables (you don't have to define the class variables):</span>
  <span class="syntax4">this</span>.file <span class="syntax11">=</span> fileBytes;
  <span class="syntax4">this</span>.fileName <span class="syntax11">=</span> <span class="syntax3">"demo.pdf"</span>;
  <span class="syntax4">this</span>.contentType <span class="syntax11">=</span> <span class="syntax3">"application/pdf"</span>;
<span class="syntax11">}</span>
</span></pre></pre><p>

				The <code class="literal">FileDownloadActionListener</code> contains also some other methods for
				some specific purposes. Check the JavaDoc for that, if you want to customize the default
				logic of that class.
				</p><p>The second part of AJAX file downloading is the client part invoking that file
				downloading action listener, which is quite easy:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">a href</span>=<span class="syntax3">"javascript:false"</span>
<span class="syntax10">  onclick</span>=<span class="syntax3">"return AraneaPage.downloadFile('download','${widgetId}','${rowRequestId}');"</span><span class="syntax10">&gt;</span>
    Click me to download the PDF!
<span class="syntax10">&lt;</span><span class="syntax10">/a</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
				So the main work is handled by <code class="literal">AraneaPage.downloadFile</code>, which takes
				the action listener ID, the widget path of the containing action listener, and an
				optional parameter for the action listener as parameters. If the file downloading does
				not work then always check first the <code class="literal">onclick</code> value to make sure that
				it really has correct request values!
				</p><p>However, the code above is not all that you need to know. The remaining part is
				what happens when the request is done? The request callback that is used, is named
				<code class="literal">AraneaPage.fileDownloadActionCallback(transport)</code>. The default
				implementation checks that result is not equal to "<code class="literal">error</code>". If so then
				it creates an invisible <code class="literal">a</code> element, which points to the URL returned by
				the file downloading action listener, and which is clicked . The value "<code class="literal">error</code>"
				is returned in case <span class="emphasis"><em>something goes wrong</em></span>. To create a custom solution (for
				response handling) replacing the default one, just override that method.
				</p><p>
				Another aspect that should be acknowledged is the file downloading action listener part,
				especially how the URL is generated and returned. As it is shown above, the
				<code class="literal">FileDownloadActionListener</code> requires a <code class="literal">PopupWindowContext</code>
				that is used to open a popup window to download the specified file in a separate thread.
				The threads are closed when the next request is sent to the server. Therefore, the URL
				returned by the action listener is actually the URL of the popup (that is different
				with each request because with every request a new popup is opened).
				</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="OpeningCustomWidgetInPopoup"></a>Opening a Custom Widget In a Popoup</h4></div></div></div><p>
				The following is an example from Aranea sample application (<code class="literal">SamplePopupWidget</code>)
				on how to open a popup widget (from a widget that extends <code class="literal">BaseUIWidget</code>):

</p><pre class="programlisting"><pre><span class="syntax0">  <span class="syntax9">getPopupCtx</span>().<span class="syntax9">open</span>(
    <span class="syntax6">new</span> <span class="syntax9">LoginAndMenuSelectMessage</span>(<span class="syntax3">"Demos.Simple.Simple_Form"</span>), 
    <span class="syntax6">new</span> <span class="syntax9">PopupWindowProperties</span>(), <span class="syntax4">this</span>);
</span></pre></pre><p>

				Here it must send a <code class="literal">Message</code> to the components that starts
				new widgets to produce the desired effect. The <code class="literal">LoginAndMenuSelectMessage</code>
				is a <code class="literal">SeriesMessage</code> that first uses the flow context from the
				child environment of the login widget to start a new root context. Then the menu select
				widget searches the menu widget to select the given menu item. Below  are the codes
				for messages.
				</p><p>
				The code for the <code class="literal">LoginAndMenuSelectMessage</code>:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> LoginAndMenuSelectMessage <span class="syntax6">extends</span> SeriesMessage <span class="syntax11">{</span>

  <span class="syntax6">public</span> <span class="syntax9">LoginAndMenuSelectMessage</span>(String menuPath) <span class="syntax11">{</span>
    <span class="syntax4">super</span>(<span class="syntax6">new</span> Message[] <span class="syntax11">{</span>
        <span class="syntax6">new</span> <span class="syntax9">LoginMessage</span>(), 
        <span class="syntax6">new</span> <span class="syntax9">MenuSelectMessage</span>(menuPath)<span class="syntax11">}</span>);
  <span class="syntax11">}</span>

<span class="syntax11">}</span>
</span></pre></pre><p>
				</p><p>
				The code for the <code class="literal">LoginMessage</code>:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> LoginMessage <span class="syntax6">extends</span> BroadcastMessage <span class="syntax11">{</span>

  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">execute</span>(Component component) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax6">if</span> (component <span class="syntax6">instanceof</span> LoginWidget) <span class="syntax11">{</span>
      LoginWidget loginWidget <span class="syntax11">=</span> (LoginWidget) component;

      Environment childEnv <span class="syntax11">=</span> loginWidget.<span class="syntax9">getChildEnvironment</span>();

      FlowContext flow <span class="syntax11">=</span> (FlowContext) childEnv.<span class="syntax9">getEntry</span>(FlowContext.<span class="syntax8">class</span>);
      flow.<span class="syntax9">replace</span>(<span class="syntax6">new</span> <span class="syntax9">RootWidget</span>(), <span class="syntax4">null</span>);
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>

<span class="syntax11">}</span>
</span></pre></pre><p>
				</p><p>
				The code for the <code class="literal">MenuSelectMessage</code>:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MenuSelectMessage <span class="syntax6">extends</span> BroadcastMessage <span class="syntax11">{</span>

  <span class="syntax6">private</span> String menuPath;

  <span class="syntax6">public</span> <span class="syntax9">MenuSelectMessage</span>(String menuPath) <span class="syntax11">{</span>
    <span class="syntax4">this</span>.menuPath <span class="syntax11">=</span> menuPath;
  <span class="syntax11">}</span>

  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">execute</span>(Component component) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax6">if</span> (component <span class="syntax6">instanceof</span> MenuWidget) <span class="syntax11">{</span>
      MenuWidget w <span class="syntax11">=</span> (MenuWidget) component;
      w.<span class="syntax9">selectMenuItem</span>(menuPath);
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>

<span class="syntax11">}</span>
</span></pre></pre><p>
				</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="OverlayContext"></a>2.8.5.&nbsp;OverlayContext</h3></div></div></div><p>
			Supports running processes in "overlay" (in parallel <code class="literal">FlowContext</code>
			of the same session thread). It is used to allow construction of modal dialogs and modal processes.
			To start a process inside overlay, a widget calls one of the
			<code class="literal">getOverlayCtx().start(...)</code> methods.
			</p><p>
			The <code class="literal">getOverlayCtx()</code> method is defined in
			<code class="literal">BaseUIWidget</code> so all sub-classes should be able to access it.
			Others can retrieve it from the <code class="literal">Environment</code> like following:
			<code class="literal">(OverlayContext) getEnvironment().getEntry(OverlayContext.class)</code>.
			</p><p>
			The first time the overlay mode is started, the <code class="literal">start(...)</code> must take
			a container (root) widget as its argument because everything that happens in overlay mode,
			is happening like in a separate window. For example, the code in Aranea Demo Application
			creates the overlay root widget and its content(s) like this:

			</p><pre class="programlisting"><pre><span class="syntax0">  <span class="syntax9">getOverlayCtx</span>().<span class="syntax9">start</span>(
      <span class="syntax6">new</span> <span class="syntax9">OverlayRootWidget</span>(<span class="syntax6">new</span> <span class="syntax9">ModalDialogDemoWidget</span>(<span class="syntax4">true</span>)));
</span></pre></pre><p>

			Notice that the <code class="literal">start(...)</code> method is used to start two widgets.
			The custom-made <code class="literal">OverlayRootWidget</code> acts like a root widget, which
			behind the scenes also specifies a flow container for the child widget
			(i.e. ModalDialogDemoWidget). Here is the sample code for the OverlayRootWidget: 

</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> OverlayRootWidget <span class="syntax6">extends</span> BaseUIWidget <span class="syntax11">{</span>

  <span class="syntax6">private</span> Widget child;

  <span class="syntax6">public</span> <span class="syntax9">OverlayRootWidget</span>(Widget child) <span class="syntax11">{</span>
    <span class="syntax4">this</span>.child <span class="syntax11">=</span> child;
  <span class="syntax11">}</span>

  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    Assert.<span class="syntax9">notNull</span>(child);
    <span class="syntax9">addWidget</span>(<span class="syntax3">"c"</span>, <span class="syntax6">new</span> <span class="syntax9">OverlayFlowContainer</span>(child));
    <span class="syntax9">setViewSelector</span>(<span class="syntax3">"overlayRoot"</span>);
  <span class="syntax11">}</span>

  <span class="syntax6">private</span> <span class="syntax8">class</span> OverlayFlowContainer <span class="syntax6">extends</span> ExceptionHandlingFlowContainerWidget <span class="syntax11">{</span>

    <span class="syntax6">public</span> <span class="syntax9">OverlayFlowContainer</span>(Widget topWidget) <span class="syntax11">{</span>
        <span class="syntax4">super</span>(topWidget);
    <span class="syntax11">}</span>

    <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">renderExceptionHandler</span>(OutputData output, Exception e) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
      <span class="syntax6">if</span> (ExceptionUtils.<span class="syntax9">getRootCause</span>(e) <span class="syntax11">!=</span> <span class="syntax4">null</span>) <span class="syntax11">{</span>
        <span class="syntax9">putViewDataOnce</span>(<span class="syntax3">"rootStackTrace"</span>, ExceptionUtils.<span class="syntax9">getFullStackTrace</span>(
            ExceptionUtils.<span class="syntax9">getRootCause</span>(e)));
      <span class="syntax11">}</span>        
      <span class="syntax9">putViewDataOnce</span>(<span class="syntax3">"fullStackTrace"</span>, ExceptionUtils.<span class="syntax9">getFullStackTrace</span>(e)); 
      ServletUtil.<span class="syntax9">include</span>(<span class="syntax3">"/WEB-INF/jsp/menuError.jsp"</span>, <span class="syntax4">this</span>, output);
    <span class="syntax11">}</span>

  <span class="syntax11">}</span>

<span class="syntax11">}</span>
</span></pre></pre><p>

			</p><p>
			<code class="literal">OverlayContext</code> provides the <code class="literal">replace*</code>, <code class="literal">start*</code> and <code class="literal">reset*</code>
      methods that act analogously to <code class="literal">FlowContext</code> corresponding methods, but affect only overlayed 
      process. Additionally, following methods are available:
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">boolean isOverlayActive()</code></td><td>Returns whether some overlayed process is active.</td></tr><tr><td><code class="literal">setOverlayOptions(Map options)</code></td><td>Sets the presentation options for overlayed processes.</td></tr><tr><td><code class="literal">Map getOverlayOptions()</code></td><td>Returns the map with current presentation options for overlayed processes.</td></tr><tr><td><code class="literal">finish(Object result)</code></td><td>Similar to <code class="literal">FlowContext.finish(Object obj)</code> but closes the entire
                <code class="literal">OverlayContext</code> not just the last flow widget.</td></tr><tr><td><code class="literal">cancel()</code></td><td>Similar to <code class="literal">FlowContext.cancel()</code> but closes the entire
                <code class="literal">OverlayContext</code> not just the last flow widget.</td></tr></tbody></table></div><p>
      </p><p>
			To make overlay possible on the client-side, one must register it inside the system
			form as the following code snippet does from <code class="literal">root.jsp</code> of the
			Aranea Demo Application. In addition, the modalbox.css file must also be incorporated
			to enable the visual part of the overlay mode. In the example below, the file is
			explicitly defined (it refers to the modalbox.css provided by Aranea), although the
			necessary styles are also included if there are no attributes specified on the tag.
			

			</p><pre class="programlisting"><pre><span class="syntax0">  ...
  <span class="syntax10">&lt;</span><span class="syntax10">head</span><span class="syntax10">&gt;</span>
        ...
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">importStyles</span><span class="syntax10"> file</span>=<span class="syntax3">"</span><span class="syntax3">css/modalbox/modalbox.css</span><span class="syntax3">"</span><span class="syntax10"> media</span>=<span class="syntax3">"</span><span class="syntax3">screen</span><span class="syntax3">"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        ...
  <span class="syntax10">&lt;</span><span class="syntax10">/head</span><span class="syntax10">&gt;</span>

  <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">body</span><span class="syntax10">&gt;</span>

    <span class="syntax10">&lt;</span><span class="syntax10">div id</span>=<span class="syntax3">"</span><span class="syntax3">cont1</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">systemForm</span><span class="syntax10"> method</span>=<span class="syntax3">"</span><span class="syntax3">POST</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">register...</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">registerOverlay</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
...
</span></pre></pre><p>

			Notice the <code class="literal">&lt;ui:registerOverlay/&gt;</code> tag!
			</p><p>
        Standard implementation of <code class="literal">OverlayContext</code> is described in
        <a href="#StandardOverlayContainerWidget" title="3.5.19.&nbsp;Overlay Container">Section&nbsp;3.5.19, &#8220;Overlay Container&#8221;</a>.
      </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="MenuContext"></a>2.8.6.&nbsp;MenuContext</h3></div></div></div><p>
			Defines the standard methods for menu handlers (contexts). Most custom implementations
			can extend the <code class="literal">org.araneaframework.uilib.core.BaseMenuWidget</code> and
			its <code class="literal">buildMenu()</code> method.
			</p><p>
      	</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Method</th><th align="left">Description</th></tr></thead><tbody><tr><td><code class="literal">void selectMenuItem(String menuItemPath)</code></td><td>Marks the menu item (identified by given path) as active.</td></tr><tr><td><code class="literal">MenuItem getMenu()</code></td><td>Provides access to the entire menu.</td></tr><tr><td><code class="literal">void setMenu(MenuItem menu)</code></td><td>Specifies the menu to use.</td></tr></tbody></table></div><p>
      </p><p>
			All menu items are represented as a tree of
			<code class="literal">org.araneaframework.uilib.core.MenuItem</code> objects that
			have its own label and a flow (a widget or a flow creator). An entire menu is also
			a <code class="literal">MenuItem</code> and its menus are declared with
			<code class="literal">addSubMenuItem(MenuItem item)</code>. A <code class="literal">MenuItem</code>
			may not have a flow, if it represents a sub menu. An example menu might look like this:

</p><pre class="programlisting"><pre><span class="syntax0">  MenuItem menu <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">MenuItem</span>();
  demoMenu <span class="syntax11">=</span> menu.<span class="syntax9">addMenuItem</span>(<span class="syntax4">null</span>, <span class="syntax6">new</span> <span class="syntax9">MenuItem</span>(<span class="syntax3">"Demo_Menu"</span>, DemoWidget.<span class="syntax8">class</span>));
  demoMenu.<span class="syntax9">addMenuItem</span>(<span class="syntax6">new</span> <span class="syntax9">MenuItem</span>(<span class="syntax3">"Context_Menus"</span>, DemoContextMenuWidget.<span class="syntax8">class</span>));
  demoMenu.<span class="syntax9">addMenuItem</span>(<span class="syntax6">new</span> <span class="syntax9">MenuItem</span>(<span class="syntax3">"Easy_AJAX_Update_Regions"</span>, EasyAJAXUpdateRegionsWidget.<span class="syntax8">class</span>));
  demoMenu.<span class="syntax9">addMenuItem</span>(<span class="syntax6">new</span> <span class="syntax9">MenuItem</span>(<span class="syntax3">"Cooperative_Form"</span>, FriendlyUpdateDemoWidget.<span class="syntax8">class</span>));
  ...
</span></pre></pre><p>
			</p><p>
			To enable the menu widget, the root widget may initialize it. Then the
			menu can be accessed by view data. A simplified example for JSP (without
			style information) is below:

</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">widgetContext</span><span class="syntax10"> id</span>=<span class="syntax3">"</span><span class="syntax3">menu</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">c:</span><span class="syntax9">forEach</span><span class="syntax10"> items</span>=<span class="syntax3">"</span><span class="syntax3">${viewData.menu.subMenu}</span><span class="syntax3">"</span><span class="syntax10"> var</span>=<span class="syntax3">"</span><span class="syntax3">item</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">c:</span><span class="syntax9">if</span><span class="syntax10"> test</span>=<span class="syntax3">"</span><span class="syntax3">${item.value.selected}</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">eventLinkButton</span><span class="syntax10"> eventId</span>=<span class="syntax3">"</span><span class="syntax3">menuSelect</span><span class="syntax3">"</span><span class="syntax10"> eventParam</span>=<span class="syntax3">"</span><span class="syntax3">${item.value.label}</span><span class="syntax3">"</span><span class="syntax10"> labelId</span>=<span class="syntax3">"</span><span class="syntax3">${item.value.label}</span><span class="syntax3">"</span><span class="syntax10"> styleClass</span>=<span class="syntax3">"</span><span class="syntax3">active</span><span class="syntax3">"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/c:</span><span class="syntax9">if</span><span class="syntax10">&gt;</span>

    <span class="syntax10">&lt;</span><span class="syntax10">c:</span><span class="syntax9">if</span><span class="syntax10"> test</span>=<span class="syntax3">"</span><span class="syntax3">${not item.value.selected}</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">eventLinkButton</span><span class="syntax10"> eventId</span>=<span class="syntax3">"</span><span class="syntax3">menuSelect</span><span class="syntax3">"</span><span class="syntax10"> eventParam</span>=<span class="syntax3">"</span><span class="syntax3">${item.value.label}</span><span class="syntax3">"</span><span class="syntax10"> labelId</span>=<span class="syntax3">"</span><span class="syntax3">${item.value.label}</span><span class="syntax3">"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/c:</span><span class="syntax9">if</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/c:</span><span class="syntax9">forEach</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/ui:</span><span class="syntax9">widgetContext</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ConfirmationContext"></a>2.8.7.&nbsp;ConfirmationContext</h3></div></div></div><p>
      Aranea standard component chain enriches <code class="literal">Environment</code>
      with a context called <code class="literal">ConfirmationContext</code>. This can be
      used for executing some code conditionally, depending on user actions.
      Context interface is simple and consists of following methods:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> ConfirmationContext <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>

  <span class="syntax8">void</span> <span class="syntax9">confirm</span>(Closure onConfirmClosure, String message);

  String <span class="syntax9">getConfirmationMessage</span>();

<span class="syntax11">}</span>
</span></pre></pre><p>

			There the <code class="literal">org.apache.commons.collections.Closure</code> is a
			simple interface to encapsulate business logic:
			
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Closure <span class="syntax11">{</span>

  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">execute</span>(java.lang.Object input);

<span class="syntax11">}</span>
</span></pre></pre><p>
			The <code class="literal">input</code> param is <code class="literal">null</code> for transitions
			handlers.
      </p><p>
			When confirmation is registered (with the <code class="literal">confirm(...)</code>
			method), rendering mechanism will present end-user with the browser
			standard message box (on page load) and ask for confirmation of requested action.
			Depending on users choice, action encapsulated in the
			<code class="literal">onConfirmClosure</code> param either will get executed or not.
			</p><p>
			Combined with <code class="literal">FlowContext.TransitionHandler</code>, confirmation
			could be asked whenever the user performs navigation that would make active
			flow unreachable and flow contains data that has not yet been saved.

</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax9">getFlowCtx</span>().<span class="syntax9">setTransitionHandler</span>(
  <span class="syntax6">new</span> <span class="syntax9">CancelConfirmingTransitionHandler</span>(
      <span class="syntax6">new</span> <span class="syntax9">ShouldConfirmOnUnsavedData</span>(),
      <span class="syntax3">"Some data not saved yet. Continue anyway?"</span>));

</span></pre></pre><p>

			Here <code class="literal">CancelConfirmingTransitionHandler</code> (provided by Aranea)
			registers the confirmation whenever <code class="literal">FlowContext.cancel()</code> is
			called from active flow and <code class="literal">org.apache.commons.collections.Predicate</code>
			(that is used to check the custom condition before executing the event) 
			<code class="literal">ShouldConfirmOnUnsavedData</code> (not provided by Aranea) evaluates
			to <code class="literal">true</code>. Only after the user confirms the navigation, the event
			will allow flow transition to be actually be performed.
			</p><p>
			<code class="literal">ConfirmationContext</code> and <code class="literal">TransitionHandlers</code>
			together are a reliable and convenient way of preventing end-users shooting
			themselves in the foot.
			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ManagedServiceContext"></a>2.8.8.&nbsp;ManagedServiceContext, ThreadContext, and TopServiceContext</h3></div></div></div><p>
      This section describes the contexts that are at the core of request handling.
      </p><p>
      <code class="literal">org.araneaframework.framework.ManagedServiceContext</code> represents
      a context that handles the requests of different threads (windows) in one session.
      The basic idea is that it routes requests to the right services. Here's an overview
      of the interface:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax7">package</span> org.araneaframework.framework;

<span class="syntax6">public</span> <span class="syntax8">interface</span> ManagedServiceContext <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>

  <span class="syntax6">public</span> Object <span class="syntax9">getCurrentId</span>();

  <span class="syntax6">public</span> Service <span class="syntax9">addService</span>(Object id, Service service);

  <span class="syntax6">public</span> Service <span class="syntax9">addService</span>(Object id, Service service, Long timeToLive);

  <span class="syntax6">public</span> Service <span class="syntax9">getService</span>(Object id);

  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">close</span>(Object id);

<span class="syntax11">}</span>
</span></pre></pre><p>
			</p><p>
			<code class="literal">org.araneaframework.framework.ThreadContext</code> represents
			a context that makes popups possible. Without it the user would have the
			same session in both windows, because Aranea application has a state.
			<code class="literal">ThreadContext</code>, however, provides means to create a
			new (distinct) thread in the session. A proof that a
			<code class="literal">ThreadContext</code> is running in a web application is
			the fact that you can find something like this in the source code of a page:
			</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">input name</span><span class="syntax11">=</span><span class="syntax3">"araThreadServiceId"</span><span class="syntax10"> type</span><span class="syntax11">=</span><span class="syntax3">"hidden"</span><span class="syntax10"> value</span><span class="syntax11">=</span><span class="syntax3">"mainThread"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
			It means that the next request (submit) made will be bound to the <code class="literal">mainThread</code>.
			</p><p>
			<code class="literal">org.araneaframework.framework.TopServiceContext</code> further
			specifies the <code class="literal">ManagedServiceContext</code> by being the top-most
			(and thus accessible by all users), though it works like <code class="literal">ThreadContext</code>.
			The difference, however, lies in the fact that <code class="literal">TopServiceContext</code>
			is not session based. Therefore, it would handle threads when, for example, the user
			has not logged in. And one may see it in their Aranea application page as following:
			</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">input name</span><span class="syntax11">=</span><span class="syntax3">"araTopServiceId"</span><span class="syntax10"> type</span><span class="syntax11">=</span><span class="syntax3">"hidden"</span><span class="syntax10"> value</span><span class="syntax11">=</span><span class="syntax3">"application"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
			</p><p>
			<code class="literal">ThreadContext</code> and <code class="literal">TopServiceContext</code> do not
			introduce new methods compared to <code class="literal">ManagedServiceContext</code>.
			</p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="framework"></a>Chapter&nbsp;3.&nbsp;Framework and Configuration</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2467"></a>3.1.&nbsp;Overview</h2></div></div></div><p>Aranea framework consists of a number of independent components each
    performing a single well-defined function. Aranea uses Spring to wire
    these components into a working framework. Though other IoC containers and
    configuration frameworks would also work we support Spring by default
    since it provides a very comfortable and versatile syntax for configuring
    beans. The dispatcher servlet that uses Spring is called
    <code class="literal">org.araneaframework.integration.spring.AraneaSpringDispatcherServlet</code>.
    Note that Aranea itself does not depend on Spring except the classes in
    the <code class="literal">org.araneaframework.integration.spring</code>
    package.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="application-configuration"></a>3.2.&nbsp;Application Configuration</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="web.xml"></a>3.2.1.&nbsp;web.xml</h3></div></div></div><p>The simplest way to configure Aranea for a web application is to
      set the <code class="literal">araneaApplicationStart</code> init parameter of the
      dispatcher servlet to the starting widget or flow of the application:
      </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax7">&lt;!</span><span class="syntax7">DOCTYPE web-app PUBLIC </span>
<span class="syntax7">  </span><span class="syntax3">"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"</span><span class="syntax7"> </span>
<span class="syntax7">  </span><span class="syntax3">"http://java.sun.com/dtd/web-app_2_3.dtd"</span><span class="syntax7">&gt;</span>

<span class="syntax10">&lt;</span><span class="syntax10">web-app</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">listener</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">listener-class</span><span class="syntax10">&gt;</span>
      org.araneaframework.http.core.StandardSessionListener
    <span class="syntax10">&lt;</span><span class="syntax10">/listener-class</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/listener</span><span class="syntax10">&gt;</span>
   
   <span class="syntax10">&lt;</span><span class="syntax10">servlet</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">servlet-name</span><span class="syntax10">&gt;</span>araneaServlet<span class="syntax10">&lt;</span><span class="syntax10">/servlet-name</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">servlet-class</span><span class="syntax10">&gt;</span>
        org.araneaframework.integration.spring.AraneaSpringDispatcherServlet
      <span class="syntax10">&lt;</span><span class="syntax10">/servlet-class</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">init-param</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">param-name</span><span class="syntax10">&gt;</span>araneaApplicationStart<span class="syntax10">&lt;</span><span class="syntax10">/param-name</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">param-value</span><span class="syntax10">&gt;</span>example.StartWidget<span class="syntax10">&lt;</span><span class="syntax10">/param-value</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">/init-param</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">load-on-startup</span><span class="syntax10">&gt;</span>1<span class="syntax10">&lt;</span><span class="syntax10">/load-on-startup</span><span class="syntax10">&gt;</span>
   <span class="syntax10">&lt;</span><span class="syntax10">/servlet</span><span class="syntax10">&gt;</span>
   
   <span class="syntax10">&lt;</span><span class="syntax10">servlet-mapping</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">servlet-name</span><span class="syntax10">&gt;</span>araneaServlet<span class="syntax10">&lt;</span><span class="syntax10">/servlet-name</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">url-pattern</span><span class="syntax10">&gt;</span>/main/*<span class="syntax10">&lt;</span><span class="syntax10">/url-pattern</span><span class="syntax10">&gt;</span>
   <span class="syntax10">&lt;</span><span class="syntax10">/servlet-mapping</span><span class="syntax10">&gt;</span>  
<span class="syntax10">&lt;</span><span class="syntax10">/web-app</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>This configuration will load Aranea using
      <code class="literal">example.StartWidget</code> as the application starting
      point. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The servlet must be mapped to a all subpathes starting from
          some prefix (in our case <code class="literal">/main/*</code>) so that Aranea
          could do some path-dependent operations like extension file
          importing.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><code class="literal">org.araneaframework.http.core.StandardSessionListener</code>
          is required to allow Aranea to process events like session
          invalidation.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aranea-conf.xml"></a>3.2.2.&nbsp;aranea-conf.xml</h3></div></div></div><p>Aranea can also be configured using a Spring configuration file
      located in <code class="literal">/WEB-INF/aranea-conf.xml</code>. Particularly it
      may be used to set the starting widget instead of the init-parameter:
      </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax7">&lt;!</span><span class="syntax7">DOCTYPE beans PUBLIC </span><span class="syntax3">"-//SPRING//DTD BEAN//EN"</span><span class="syntax7"> </span>
<span class="syntax7">  </span><span class="syntax3">"http://www.springframework.org/dtd/spring-beans.dtd"</span><span class="syntax7">&gt;</span>

<span class="syntax10">&lt;</span><span class="syntax10">beans</span><span class="syntax10">&gt;</span>   
    <span class="syntax10">&lt;</span><span class="syntax10">bean id</span>=<span class="syntax3">"araneaApplicationStart"</span><span class="syntax10"> </span>
<span class="syntax10">      class</span>=<span class="syntax3">"example.StartWidget"</span>
<span class="syntax10">      singleton</span>=<span class="syntax3">"false"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/beans</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>This seems to be more verbose, but it also allows to configure the
      framework components as described in <a href="#framework-configuration" title="3.4.&nbsp;Framework Configuration">Section&nbsp;3.4, &#8220;Framework Configuration&#8221;</a>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aranea-conf.properties"></a>3.2.3.&nbsp;aranea-conf.properties</h3></div></div></div><p>Aranea also takes into account a property file located in
      <code class="literal">/WEB-INF/aranea-conf.properties</code>. The following
      properties are recognized: </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Property</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">l10n.resourceBundle</code></td><td>The base name of the resource bundle used for
                localization. This value isn't used if default
                <code class="literal">araneaLocalizationFilter</code> is overidden (e.g.
                by the <code class="literal">SpringLocalizationFilterService</code>)
                <p><span class="strong"><strong>Default value:</strong></span>
                <code class="literal">org.araneaframework.http.support.DefaultResourceBundle</code></p></td></tr><tr><td><code class="literal">l10n.defaultLocale</code></td><td>The default locale to be used in the application.
                <p><span class="strong"><strong>Default value:</strong></span>
                <code class="literal">en</code></p></td></tr><tr><td><code class="literal">l10n.encoding</code></td><td>The default character encoding to be used throughout
                the application (e.g. for request and response).
                <p><span class="strong"><strong>Default value:</strong></span>
                <code class="literal">UTF-8</code></p></td></tr><tr><td><code class="literal">jsp.path</code></td><td>The path from the webapp root to the directory that
                will act as JSP root. The JSPs put there can be selected using
                widget view selectors (see <a href="#widget-view-selector" title="2.7.7.&nbsp;View Model and Rendering">Section&nbsp;2.7.7, &#8220;View Model and Rendering&#8221;</a>). <p><span class="strong"><strong>Default value:</strong></span>
                <code class="literal">/WEB-INF/jsp</code></p></td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="AraneaSpringDispatcherServlet"></a>3.2.4.&nbsp;AraneaSpringDispatcherServlet</h3></div></div></div><p><code class="literal">AraneaSpringDispatcherServlet</code> provides a number
      of init-params that allow to further customize Aranea configuration:
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>init-param</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">araneaCustomConfXML</code></td><td>The custom location of a Spring XML file used to
                configure Aranea. <p><span class="strong"><strong>Default
                value:</strong></span>
                <code class="literal">/WEB-INF/aranea-conf.xml</code></p></td></tr><tr><td><code class="literal">araneaCustomConfProperties</code></td><td>The custom location of a property file used to
                configure Aranea. <p><span class="strong"><strong>Default
                value:</strong></span>
                <code class="literal">/WEB-INF/aranea-conf.properties</code></p></td></tr><tr><td><code class="literal">araneaApplicationStart</code></td><td>The class name of an Aranea widget that will serve as
                the starting point of an Aranea application. If omitted the
                Spring bean <code class="literal">araneaApplicationStart</code> will be
                used.</td></tr><tr><td><code class="literal">araneaApplicationRoot</code></td><td>The class name of an Spring bean describing an Aranea
                component that will serve as the framework root. If omitted
                the Spring bean <code class="literal">araneaApplicationRoot</code> will
                be used. Can be used to override the default configuration
                altogether.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ExtendingDispatcher"></a>3.2.5.&nbsp;Extending Dispatcher</h3></div></div></div><p>Currently, the most common way to put Aranea to work is to host it
      in a Servlet 2.3 or compatible container. The most generic way to do
      that is to extend the
      <code class="literal">org.araneaframework.http.core.BaseAraneaDispatcherServlet</code>
      and build the root component of type
      <code class="literal">org.araneaframework.http.ServletServiceAdapterComponent</code>
      in the overrided method <code class="literal">buildRootComponent()</code>:
      </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax7">package</span> com.foobar.myapp;

<span class="syntax8">class</span> MyServlet <span class="syntax6">extends</span> BaseAraneaDispatcherServlet <span class="syntax11">{</span>
   <span class="syntax6">protected</span> ServletServiceAdapterComponent <span class="syntax9">buildRootComponent</span>() <span class="syntax11">{</span>
     StandardServletServiceAdapterComponent root <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">StandardServletServiceAdapterComponent</span>();

     <span class="syntax1">//Configure the child components, service widgets using setter injection</span>
     <span class="syntax1">//...</span>

     <span class="syntax6">return</span> root;
   <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p> One can then use such a servlet to configure Aranea in
      a web application as by replacing the standard dispatcher servlet
      with the custom one in <code class="literal">WEB-INF/web.xml</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ConfigurationContext"></a>3.2.6.&nbsp;ConfigurationContext</h3></div></div></div><p>Aranea also provides a central way to configure some settings that
      affect the way some components work or display data. These settings are
      stored in a <code class="literal">Map</code>, where the key names are defined in the
      <a href="/docs/stable/javadoc/org/araneaframework/uilib/ConfigurationContext.html" target="_top"><code class="literal">org.araneaframework.uilib.ConfigurationContext</code></a> interface.
      </p><p>
			The <code class="literal">ConfigurationContext</code> is accessible from the
			<code class="literal">Environment</code> or by the <code class="literal">getConfiguration()</code>
			method of <code class="code">BaseUIWidget</code>.
			</p><p>
			Every application may provide their own values for settings by implementing
			their version of the <code class="literal">ConfigurationContext</code> like following:

</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> CustomConfiguration <span class="syntax6">implements</span> ConfigurationContext <span class="syntax11">{</span>

  <span class="syntax6">private</span> Map configuration <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">HashMap</span>();

  <span class="syntax6">public</span> <span class="syntax9">CustomConfiguration</span>() <span class="syntax11">{</span>
    <span class="syntax1">// Note that these constants are defined by the ConfigurationContext.</span>
    configuration.<span class="syntax9">put</span>(CUSTOM_DATE_FORMAT, <span class="syntax3">"dd.MM.yyyy|d.M.yyyy"</span>);
    configuration.<span class="syntax9">put</span>(CUSTOM_TIME_FORMAT, <span class="syntax3">"HH:mm"</span>);
    configuration.<span class="syntax9">put</span>(FULL_LIST_ITEMS_ON_PAGE, <span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">20</span>));
  <span class="syntax11">}</span>

  <span class="syntax6">public</span> Object <span class="syntax9">getEntry</span>(String entryName) <span class="syntax11">{</span>
    <span class="syntax6">return</span> configuration.<span class="syntax9">get</span>(entryName);
  <span class="syntax11">}</span>

<span class="syntax11">}</span>
</span></pre></pre><p>

			For more information on the settings that can be changed, please see the
			<code class="literal">ConfigurationContext</code> interface in the
			<a href="http://www.araneaframework.org/docs/1.1/javadoc/" target="_top">Aranea API</a>.
			</p><p>
			To make Aranea use the custom-created configuration, the class must be
			defined in <code class="literal">aranea-conf.xml</code> file like this:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">bean id</span>=<span class="syntax3">"araneaConfiguration"</span>
<span class="syntax10">    class</span>=<span class="syntax3">"com.company.conf.CustomConfiguration"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span><span class="syntax10"> /</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
				Note that it is defined as not being a singleton. This means that the
				configuration is created for every context (user). Therefore, the
				settings can be further customized to be more user specific.
			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="StateVersioningContext"></a>3.2.7.&nbsp;StateVersioningContext</h3></div></div></div><p>
		To compensate the lack of support for the back button of the web browser,
		a custom solution for this has been added to Aranea since release 1.2. This
		solution depends on rsh (<a href="http://code.google.com/p/reallysimplehistory/" target="_top">Really Simple History</a>),
		so you also need to import JavaScripts (<code class="filename">js/aranea/aranea-rsh.js</code>,
		<code class="filename">js/rsh/rsh.js</code>, see also <a href="#systemTags" title="4.2.&nbsp;System Tags">System tags</a>).
	</p><p>

		The main interface of this context is <code class="literal">org.araneaframework.http.StateVersioningContext</code>,
		and once enabled, it is accessible form the <code class="literal">Environment</code>, though one
		generally does not need to access it. Every application may provide their own values
		for costumizing the number of pages (default is 20) of the <code class="literal">StateVersioningContext</code>.
		To enable state versioning, one must add following XML code to <code class="filename">aranea-conf.xml</code>:

</p><pre class="programlisting"><pre><span class="syntax0">
<span class="syntax10">&lt;</span><span class="syntax10">bean id</span>=<span class="syntax3">"araneaStateVersioningFilter"</span>
<span class="syntax10">  class</span>=<span class="syntax3">"org.araneaframework.http.filter.StandardStateVersioningFilterWidget"</span>
<span class="syntax10">  singleton</span>=<span class="syntax3">"false"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">property name</span>=<span class="syntax3">"maxVersionedStates"</span><span class="syntax10"> value</span>=<span class="syntax3">"10"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/bean</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>

		Note that it is defined as not being a singleton. This means that the
		configuration is created for every context (user). Therefore, the
		settings can be further customized to be more user specific.
	</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
			Since the visited pages are serialized on the client side, do not set high values for
			<code class="literal">maxVersionedStates</code> as it puts more stress on the client's browser. 
			Therefore, <code class="literal">10</code> is normal, <code class="literal">20</code> should be maximum
			value for this attribute.
		</p></div><p>
		In addition, an update region must be defined in your
		<span class="emphasis"><em>root.jsp</em></span> that wraps system form and has a fixed
		name: <code class="code">araneaGlobalClientHistoryNavigationUpdateRegion</code>.
		This is the region that is updated when the user moves between pages
		using the back button of the browser. Here's an example:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">body</span><span class="syntax10">&gt;</span>
        ...
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">updateRegion</span><span class="syntax10"> globalId</span>=<span class="syntax3">"</span><span class="syntax3">araneaGlobalClientHistoryNavigationUpdateRegion</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
                ...
                <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">systemForm</span><span class="syntax10"> method</span>=<span class="syntax3">"</span><span class="syntax3">post</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
                        ...
                <span class="syntax10">&lt;</span><span class="syntax10">/ui:</span><span class="syntax9">systemForm</span><span class="syntax10">&gt;</span>
                ...
        <span class="syntax10">&lt;</span><span class="syntax10">/ui:</span><span class="syntax9">updateRegion</span><span class="syntax10">&gt;</span>
        ...
<span class="syntax10">&lt;</span><span class="syntax10">/ui:</span><span class="syntax9">body</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
	</p><p>
		Finally, you also need to copy <span class="emphasis"><em>etc/js/rsh/blank.html</em></span>
		from the Aranea 1.2 release package and place it in the root directory of
		your WAR bundle (the same directory where WEB-INF is located). This HTML
		file is needed for compatibility with Internet Explorer.
	</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="framework-assembly"></a>3.3.&nbsp;Framework Assembly</h2></div></div></div><p>Aranea framework is made up of the same Components, Services and
    Widgets that are also used to develop Aranea applications. Each component
    performs a single well-defined function and depends on its parents only
    through the <code class="literal">Environment</code> where component lives. The
    framework components mostly fall in one of the
    three following categories:</p><div class="variablelist"><dl><dt><span class="term">Filter</span></dt><dd><p>Filter components are the simplest. The component (typically <code class="literal">Service</code>, see <a href="#core-services" title="2.5.&nbsp;Services">Section&nbsp;2.5, &#8220;Services&#8221;</a>) contains a
            single unnamed child and implements the
            <span class="emphasis"><em>Filter</em></span> pattern by either passing each call to
            the child or not. However in addition it may enrich the child's
            environment with contexts and provide more functionality like
            exception handling or synchronization. Typical examples of filters
            are localization filter (provides a localization context),
            synchronization filter (synchronizes on <code class="literal">action()</code> method) and transactional filter that
            does not let through double submits.</p></dd><dt><span class="term">Router</span></dt><dd><p>Router typically contains many named children, and chooses
            only one to propagate the calls to according to some
            <code class="literal">InputData</code> parameter. Router may have the
            children either statically preconfigured or created dynamically
            when the request comes (the latter is the case with session
            service router). It may also allow us to add/remove children while
            the application is running. A typical application of a router is
            to distinguish among major application parts by some attribute
            (like component corresponding to a user session, or one of the
            popup window of current user).</p></dd><dt><span class="term">Container</span></dt><dd><p>Container can have one or many children, but it typically
            will do more with them than just passing the calls to one of them.
            A typical example is the <span class="emphasis"><em>widget container</em></span>
            service which translates <code class="literal">action()</code> calls into
            widget <code class="literal">update()/event()/render()</code>
            cycle.</p></dd></dl></div><p>The frameworks itself is assembled using a hierarchy of components
    (this hierarchy is mostly flat, except for the routers and application
    components). The hierarchy is arranged simply by containment, with each
    component containing its chidren as fields as illustrated on <a href="#figure-framework-assembly" title="Figure&nbsp;3.1.&nbsp;Framework assembly example">Figure&nbsp;3.1, &#8220;Framework assembly example&#8221;</a>.</p><div class="figure"><a name="figure-framework-assembly"></a><div class="mediaobject" align="center"><img src="../images/widget-conf.png" align="middle" alt="Framework assembly example"></div><p class="title"><b>Figure&nbsp;3.1.&nbsp;Framework assembly example</b></p></div><p>Of course this illustration is simplified, omitting most of the
    components described in <a href="#framework-components">Section&nbsp;3.5, &#8220;Framework Components&#8221;</a>. If you
    want to find out more about the way framework is built and assembled, see
    the <a href="http://www.araneaframework.org/docs/aranea-technical-paper.pdf" target="_top">Aranea
    Technical Paper</a>.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="framework-configuration"></a>3.4.&nbsp;Framework Configuration</h2></div></div></div><p>Aranea framework is assembled into a mostly-flat hierarchy using
    Spring beans. The default Aranea configuration is loaded by the
    <code class="literal">AraneaSpringDispatcherServlet</code>, but it can be overriden
    with the custom configuration in <code class="literal">aranea-conf.xml</code>. The
    dispatcher servlet loads the configuration in such a way that same named
    beans in <code class="literal">aranea-conf.xml</code> override the ones specified in
    the default configuration. However, not all beans can be safely or
    comfortably overriden, since many of them will also refer to their child
    beans.</p><p>It is always safe to override filters, as they should never refer
    directly to their children. To override a filter just make a bean
    definition with the same name as in default configuration (filters and
    their default configuration names among other components are described in
    <a href="#framework-components">Section&nbsp;3.5, &#8220;Framework Components&#8221;</a>). For instance to override the
    default localization context with a custom-made one, one would need to add
    the following lines:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">bean class</span>=<span class="syntax3">"example.LocalizationFilterService"</span>
<span class="syntax10">  id</span>=<span class="syntax3">"araneaLocalizationFilter"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">property name</span>=<span class="syntax3">"languageName"</span><span class="syntax10"> value</span>=<span class="syntax3">"ee"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/bean</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>There is no good way in Spring to undefine a bean, so instead we use
    a "No OPeration" filter to nullify a filter from the default
    configuration:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">bean class</span>=<span class="syntax3">"org.araneaframework.framework.core.NopFilterWidget"</span>
<span class="syntax10">  id</span>=<span class="syntax3">"araneaTransactionFilter"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>Since filters can be both services and widgets, you have to be
        careful to use the appropriate one for the current context. In current
        case you have override service filters with
        <code class="literal">NopFilterService</code> and widget filters with
        <code class="literal">NopFilterWidget</code>.</p></div><p>There is no generic way to insert filters into an arbitrary
    place in the framework component hierarchy. However there are several
    predefined places left for optional bean insertion at various levels of
    the hierarchy, which should cover most of customization needs. To allow
    inserting more than one filter at a time a filter chain bean is provided
    that allows putting together an arbitrary long chain of filters:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">bean id</span>=<span class="syntax3">"araneaCustomSessionFilters"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span>
<span class="syntax10">  class</span>=<span class="syntax3">"org.araneaframework.framework.filter.StandardFilterChainService"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">property name</span>=<span class="syntax3">"filterChain"</span><span class="syntax10">&gt;</span>     
    <span class="syntax10">&lt;</span><span class="syntax10">list</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ref bean</span>=<span class="syntax3">"araneaSerializingAudit"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ref bean</span>=<span class="syntax3">"myCustomFilter1"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ref bean</span>=<span class="syntax3">"myCustomFilter2"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/list</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/property</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/bean</span><span class="syntax10">&gt;</span>
</span></pre></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Use <code class="literal">StandardFilterChainService</code> for hosting
        service filters and <code class="literal">StandardFilterChainWidget</code> for
        hosting widget filters.</p></div><p>Follows a description of the insertion point beans and their
    scope:</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th align="left">Bean name</th><th align="left">Scope and Description</th></tr></thead><tbody><tr><td><code class="literal">araneaCustomApplicationFilters</code></td><td><p>These filters are created only once and live as
              long as the application does. They are not synchronized and
              should be use to add features generic to the whole application,
              not specific users. The exceptions thrown by this filters are
              intepreted as critical and are handled by the critical exception
              handler.</p><p><span class="bold"><strong>Examples:</strong></span>
              <a href="#araneaFileUploadFilter" title="3.5.5.&nbsp;File Uploading Filter">araneaFileUploadFilter</a>,
              <a href="#araneaStatisticFilter" title="3.5.11.&nbsp;Statistics Logging Filter">araneaStatisticFilter</a>.</p></td></tr><tr><td><code class="literal">araneaCustomSessionFilters</code></td><td><p>These filters are created for every HTTP user
              session and live as long as the session does. They are generally
              synchronized and should be used to add features specific to the
              current user session.</p><p><span class="bold"><strong>Examples:</strong></span> <a href="#araneaLocalizationFilter" title="8.1.2.&nbsp;Spring Localization Filter">araneaLocalizationFilter</a>.</p></td></tr><tr><td><code class="literal">araneaCustomThreadFilters</code></td><td><p>These filters are created for every user browser
              window and live as long as the window does. They are
              synchronized and should be used to add features specific to the
              individual browser window (e.g. most rendering filters will fall
              into this category).</p><p><span class="bold"><strong>Examples:</strong></span> <a href="#araneaThreadCloningFilter" title="3.5.12.&nbsp;Browser Window Cloning Filter">araneaThreadCloningFilter</a>
              .</p></td></tr><tr><td><code class="literal">araneaCustomWidgetFilters</code></td><td><p>These filters are created for every user browser
              window and live as long as the window does. They are
              synchronized and should be used to add features specific to the
              individual browser window. Unlike the rest of the filters this
              can be widgets and thus can take advantage of the widget
              update/event/process/render cycle.</p><p><span class="bold"><strong>Examples:</strong></span> <a href="#araneaTransactionFilter" title="3.5.13.&nbsp;Multi-submit Protection Filter">araneaTransactionFilter</a>,
              <a href="#araneaMessagingFilter" title="3.5.8.&nbsp;User Messages Filter">araneaMessagingFilter</a>.</p></td></tr></tbody></table></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e2979"></a>3.5.&nbsp;Framework Components</h2></div></div></div><p>Aranea configuration is determined by request-processing components
    that can be assembled in many different ways. Following sections are a
    brief reference for pre-existing standard components, most of which are
    also used in Aranea framework default configuration.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaSpringLocalizationFilter"></a>3.5.1.&nbsp;Localization Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardLocalizationFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaLocalizationFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">LocalizationContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Provides localization services to children. See <a href="#LocalizationContext" title="2.8.2.&nbsp;LocalizationContext">Section&nbsp;2.8.2, &#8220;LocalizationContext&#8221;</a>.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>languageName <p> <code class="literal">java.lang.String</code>
              </p></td><td>A valid ISO Language Code. Sets <code class="literal">Locale</code>
              according to given language.</td></tr><tr><td>resourceBundleName
              <p><code class="literal">java.lang.String</code></p></td><td>Name of the used resource bundle used to localize the
              application.</td></tr><tr><td>locale
              <p><code class="literal">java.util.Locale</code></p></td><td><code class="literal">Locale</code> to use. Either that or
              <span class="emphasis"><em>languageName</em></span> should be specified, but not
              both.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaUpdateRegionFilter"></a>3.5.2.&nbsp;AJAX Update Regions Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
                class:</strong></span></td><td><code class="literal">StandardUpdateRegionFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default
                configuration name:</strong></span></td><td><code class="literal">araneaUpdateRegionFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">UpdateRegionContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
                on:</strong></span></td><td>-</td></tr></tbody></table></div><p>When framework receives an event(request) that has <span class="emphasis"><em>update region</em></span> parameters defined,
      this filter is activated and takes care that only the smallest renderable unit that defines 
      named <span class="emphasis"><em>update region</em></span> is actually rendered. Generated response also contains only 
      the rendered content of particular component(s) that needed to be rendered for updating the regions.
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>characterEncoding <p>
              <code class="literal">java.lang.String</code> </p></td><td>The character encoding for responses served by this
              filter, default being "UTF-8".</td></tr></tbody></table></div><span class="emphasis"><em>
        Notes: In Aranea 1.1 this filter has changed from <code class="literal">Service</code> to
        <code class="literal">Widget</code>. Also, the configuration parameter <code class="literal">existingRegions</code>
        only exists in 1.0 branch (TODO: elaborate why? (imho it should remain anyway)).
      </em></span></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaEnvContextFilter"></a>3.5.3.&nbsp;Environment Configuration Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardContextMapFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaEnvContextFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Filter widget that enriches children environment with specified
      context entries.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>contexts <p> <code class="literal">java.util.Map</code>
              </p></td><td>A map of contexts that will be added to environment. The
              keys can contains strings of kind "package.ClassName.class",
              which will use a Class object of the specified classname as the
              context key. The context value should be an object instance of
              the context interface. By convention a context should be
              registered under a key that is an interface it
              implements.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaCriticalErrorHandler"></a>3.5.4.&nbsp;Critical Exception Handler</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardCriticalExceptionHandlingFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaCriticalErrorHandler</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Catches the exceptions (if any) occuring while executing children
      methods; passes the exceptions on to <code class="literal">Service</code> that
      deals with exception handling (obtained from
      <code class="literal">ExceptionHandlerFactory</code>).</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>exceptionHandlerFactory<p><code class="literal">ExceptionHandlerFactory</code>
              </p></td><td>A factory for creating exception handlers. An exception
              handler is a service, which handles the user notification and
              recovery.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaFileUploadFilter"></a>3.5.5.&nbsp;File Uploading Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardFileUploadFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaFileUploadFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">FileUploadContext</code>,
              <code class="literal">FileUploadInputExtension</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Enriches child environment with
      <code class="literal">FileUploadContext</code> (which is just a marker interface).
      When incoming request is multi-part request, children's
      <code class="literal">InputData</code> is extended with
      <code class="literal">FileUploadInputExtension</code> that allows children easy
      access to uploaded files.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>multipartEncoding <p>
              <code class="literal">java.lang.String</code> </p></td><td>Character encoding that will be used to decode the
              <code class="literal">multipart/form-data</code> encoded strings. The
              default encoding is determined by <span class="emphasis"><em>Apache
              Commons</em></span> <code class="literal">FileUpload</code> class.</td></tr><tr><td>useRequestEncoding
              <p><code class="literal">boolean</code></p></td><td>When set to "true" request character encoding will be
              used to parse the <code class="literal">multipart/form-data</code> encoded
              strings.</td></tr><tr><td>maximumCachedSize
              <p><code class="literal">java.lang.Integer</code></p></td><td>Maximum size of file that may be cached in
              memory.</td></tr><tr><td>maximumSize
              <p><code class="literal">java.lang.Long</code></p></td><td>Maximum size of file that may be uploaded to
              server.</td></tr><tr><td>maximumRequestSize
              <p><code class="literal">java.lang.Long</code></p></td><td>Maximum size of the request that server will
              parse to the end.</td></tr><tr><td>tempDirectory
              <p><code class="literal">java.lang.String</code></p></td><td>Temporary directory to use when uploading files.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaResponseHeaderFilter"></a>3.5.6.&nbsp;HTTP Response Headers Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardHttpResponseFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaResponseHeaderFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Filter that sets necessay headers of the response.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>cacheable <p> <code class="literal">boolean</code>
              </p></td><td>Whether the response is cacheable or not. By default it
              is not cacheable.</td></tr><tr><td>contentType
              <p><code class="literal">java.lang.String</code></p></td><td>Sets the content type of the response. Default is
              "text/html; charset=UTF-8".</td></tr><tr><td>cookies
              <p><code class="literal">java.util.Map</code></p></td><td>Constructs cookies from the &lt;cookieName,
              cookieValue&gt; pairs in the map and sets them in
              response.</td></tr><tr><td>headers
              <p><code class="literal">java.util.Map</code></p></td><td>Sets the headers of the response from the map of
              &lt;headerName, headerValue&gt;.</td></tr><tr><td>cacheHoldingTime
              <p><code class="literal">long</code></p></td><td>Sets the cache-control's max-age parameter, value is in
              milliseconds. Response must be cacheable for this to have any
              effect.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaJspConfigFilter"></a>3.5.7.&nbsp;JSP Configuration Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardJspFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaJspConfigFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">JspContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">LocalizationContext</code></td></tr></tbody></table></div><p>Provides JSP specific information to children.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>submitCharset <p> <code class="literal">java.lang.String</code>
              </p></td><td>Sets the "accept-charset" attribute value that will be
              used for rendering Aranea JSP specific <a href="#systemForm">systemForm</a>.</td></tr><tr><td>jspPath
              <p><code class="literal">java.lang.String</code></p></td><td>Path where widgets rendering themselves with jsp
              templates should search for them. Default is
              "/WEB-INF/jsp".</td></tr><tr><td>jspExtension
              <p><code class="literal">java.lang.String</code></p></td><td>File name extension jsp templates are assumed to have. 
              Default is ".jsp".</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaMessagingFilter"></a>3.5.8.&nbsp;User Messages Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardMessagingFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaMessagingFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">MessageContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>See <a href="#MessageContext" title="2.8.1.&nbsp;MessageContext">Section&nbsp;2.8.1, &#8220;MessageContext&#8221;</a>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaPopupFilter"></a>3.5.9.&nbsp;Popup Windows Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardPopupFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaPopupFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">PopupWindowContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">ThreadContext</code>,
              <code class="literal">TopServiceContext</code>,
              <code class="literal">TransactionContext</code></td></tr></tbody></table></div><p>Provides methods for opening new session-threads and renders these
      in different browser windows at client-side.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>threadServiceFactory
              <p><code class="literal">ServiceFactory</code> </p></td><td>Factory that should build the component chain according
              to effective Aranea configuration, beginning with
              sessionthread-level filters.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaSerializingAudit"></a>3.5.10.&nbsp;Component Serialization Auditing Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardSerializingAuditFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaSerializingAudit</code> (not included
              in default filter chain)</td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Always serializes the the session during the request routing. This filter
      helps to be aware of serializing issues during development as when the
      session does not serialize, exception is always thrown. In production
      configuration, this filter should never be enabled, thus it is disabled
      by default.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>testXmlSessionPath
              <p><code class="literal">java.lang.String</code> </p></td><td>The path where the serialized sessions should be logged
              in XML format. If not specified, serialization tests are
              performed in-memory.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaStatisticFilter"></a>3.5.11.&nbsp;Statistics Logging Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardStatisticFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaStatisticFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Filter that logs the time it takes for the child service to serve
      the request (complete its action method).</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>message <p><code class="literal">java.lang.String</code>
              </p></td><td>The prefix of the statistics log statement.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaThreadCloningFilter"></a>3.5.12.&nbsp;Browser Window Cloning Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardThreadCloningFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaThreadCloningFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">ThreadCloningContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">ThreadContext</code>,
              <code class="literal">TopServiceContext</code></td></tr></tbody></table></div><p>Implementation of a service that clones currently running session
      thread upon request and sends a response that redirects to cloned
      session thread. It can be used to support "open link in new window"
      feature in browsers. Cloning is generic and resource demanding, as whole
      tree of session thread components is recreated. Custom applications may
      find that they can implement some application specific cloning strategy
      that demands less memory and processing power.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>timeToLive <p><code class="literal">java.lang.Long</code>
              </p></td><td>Inactivity time for cloned thread after which thread
              router may kill the thread service. This is specified in
              milliseconds. If unset, threads created by cloning service
              usually live until HTTP session in which they were spawned
              expires.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaTransactionFilter"></a>3.5.13.&nbsp;Multi-submit Protection Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardTransactionFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaTransactionFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">TransactionContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">SystemFormContext</code></td></tr></tbody></table></div><p><span class="emphasis"><em>TransactionContext</em></span> implementation that
      filters routing of duplicate requests. The detection of duplicate
      requests is achieved through defining new transaction ID in each
      response and checking that next request submits the consistent
      transaction ID. Missing (<span class="emphasis"><em>null</em></span>) transaction ID is
      always considered inconsistent. For purposes of asynchronous requests,
      <code class="literal">override</code> transaction ID is always considered
      consistent.</p><p>Transactions work in Aranea application by default. You may notice
			it in a web page as a hidden field, for example:
			</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">input name</span><span class="syntax11">=</span><span class="syntax3">"araTransactionId"</span><span class="syntax10"> type</span><span class="syntax11">=</span><span class="syntax3">"hidden"</span><span class="syntax10"> value</span><span class="syntax11">=</span><span class="syntax3">"-8629560801569274688"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
			The value is random, and a <code class="literal">TransactionContext</code> checks
			every request whether it is the same as expected (it remembers the previous
			<code class="literal">transactionId</code> value it gave to the page). If it is not the
			same, the request will be ignored. Therefore, one may notice when
			transactions are inconsistent: the pages won't update itself (on first click).
			</p><p>Sometimes, however, a <code class="literal">transactionId</code> may become
			inconsistent (for various reasons, such as due to a background request).
			Then the solution would be to change the <code class="literal">transactionId</code>
			value to <code class="literal">"override"</code> (for example, by using JavaScript).
			(In the next response, the <code class="literal">transactionId</code> will still have a
			new random numeric value.)
			</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Request parameter name</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">transactionId</code></td><td>Transaction id must be equal to the last one generated
              for the transaction to be consistent.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaClassReloadingFilter"></a>3.5.14.&nbsp;Class Reloading Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardClassReloadingFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>This filter allows to reload the underlying object classes
      dynamically. This means that you can just change the widget source file,
      compile it (e.g. with IDE built-in compiler) and it will be reloaded
      seamlessly in Aranea. This will apply only to Aranea widget classes
      under this filter and the classes they contain (but not e.g. Spring
      beans). This filter must be registered instead of the
      <code class="literal">araneaApplicationStart</code> to function.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>None of the classes under this filter may be configured by
        Spring or anything else using its own classloader!</p></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>childClass
              <p><code class="literal">java.lang.String</code></p></td><td>The full names of the child widget class.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaClientStateFilter"></a>3.5.15.&nbsp;Client State Serialization Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardClientStateFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaClientStateFilter</code> (not included
              in default filter chain)</td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">SystemFormContext</code></td></tr></tbody></table></div><p>This filter will serialize the state of underlying widgets onto
      client-side. This significantly decreases the server-side session size
      and thus memory use. It is especially useful in intranet applications
      with lots of spare bandwidth. The filter should be positioned as the
      first custom widget filter for most gain.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The filter will protect against tampering with the serialized
          state and will throw an exception if modified state is submitted
          from the client-side. As a bonus this filter will also allow a user
          to make up to 10 steps back and forward in browser history,
          restoring the correct state.</p></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>compress <p><code class="literal">boolean</code> </p></td><td>If true the serialized state will also be GZIP'ed,
              trading processor time for bandwidth. False by default.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaFileImportFilter"></a>3.5.16.&nbsp;Extension File Import Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java class:</strong></span></td><td><code class="literal">StandardFileImportFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration name:</strong></span></td><td><code class="literal">araneaFileImportFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Depends on:</strong></span></td><td>-</td></tr></tbody></table></div><p>This filter is responsible for providing a virtual file system so
      that extensions could make use of the resources included in .JAR files.
      See <a href="#framework-extensions" title="3.6.1.&nbsp;Extension Resources">Section&nbsp;3.6.1, &#8220;Extension Resources&#8221;</a></p><p>When the file importer is used to provide aranea resources
	(styles/JavaScripts) it also defines cache time, after which the browser
	reloads the resources. You can configure this value through
	<code class="literal">web.xml</code> configuration parameter (the default time is 1 hour):
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">context-param</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">param-name</span><span class="syntax10">&gt;</span>fileImporterCacheInMillis<span class="syntax10">&lt;</span><span class="syntax10">/param-name</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">param-value</span><span class="syntax10">&gt;</span>10800000<span class="syntax10">&lt;</span><span class="syntax10">/param-value</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/context-param</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
	</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaMountingFilter"></a>3.5.17.&nbsp;Bookmarking/URL Mounting Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardMountingFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaMountingFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">MountContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Implementation of a service that allows to "mount" flow components
      to a publicly accessible URL. It is used when it is needed that some (read-only) parts of application
      are accessible to users who are not able to enter the session-based conversation with application.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>mounts<p><code class="literal">java.util.Map&lt;String, MountContext.MessageFactory&gt;</code></p></td><td>
              	Keys in the map are URL prefixes under which the flow component is mapped.
              	Values are <code class="literal">org.araneaframework.Message</code> factories of type <code class="literal">MountContext.MessageFactory</code>&#8212;producing
              	messages that generate component hierarchy for serving wanted content.
              </td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaRootFlowContainer"></a>3.5.18.&nbsp;Root Flow Container</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">RootFlowContainerWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaRootFlowContainer</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">RootFlowContext</code>,
              <code class="literal">FlowContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>See <a href="#FlowContext" title="2.8.3.&nbsp;FlowContext">Section&nbsp;2.8.3, &#8220;FlowContext&#8221;</a> for purpose and philosophy
      behind <code class="literal">FlowContext</code>.
      <code class="literal">RootFlowContext</code> is same as
      <code class="literal">FlowContext</code>, but allows acces to the root flow
      container at any time. Remember that <code class="literal">RootFlowContext</code>
      is the topmost flow context that everything else depends on. One can find
      it from the <code class="literal">Environment</code>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Tip</h3><p>Flow containers are not generally a part of the framework and
          can be used in your application as needed. In a typical Aranea
          application the menu will inherit from
          <code class="literal">ExceptionHandlingFlowContainerWidget</code> that besides
          providing the flow container functionality also allows to handle
          flow exceptions inside the container, preserving the menus and
          current state. See business application tutorial for more
          information.</p></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>top <p><code class="literal">org.araneaframework.Widget</code>
              </p></td><td>First widget to be started in this container.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="StandardOverlayContainerWidget"></a>3.5.19.&nbsp;Overlay Container</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardOverlayContainerWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaOverlayContainer</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">OverlayContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>Supports running processes in "overlay" layer (in parallel FlowContext of the same session thread). Allows
      construction of modal dialogs and modal processes.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Injectable properties</th><th>Description</th></tr></thead><tbody><tr><td>main<p><code class="literal">Widget</code> </p></td><td>Widget corresponding to main process running outside overlay.</td></tr><tr><td>overlay
              <p><code class="literal">FlowContextWidget</code> </p></td><td>Component responsible for running processes in overlay layer.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="StandardSystemFormFilterService"></a>3.5.20.&nbsp;System Form Field Storage Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardSystemFormFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaSystemFormFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">SystemFormContext</code> (for adding/examining managed form fields).</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">TopServiceContext</code>, <code class="literal">ThreadContext</code></td></tr></tbody></table></div><p>Stores system form fields that will be written out when <code class="literal">&lt;ui:systemForm&gt;</code> tag is used. 
      Form fields that indicate service levels (<code class="code">topServiceId</code> and <code class="code">threadServiceId</code>) are
      always automatically added to every response by this implementation.</p><p>
				This filter does not have any special injectable properties (except the usual <code class="literal">childService</code>).
				<code class="literal">SystemFormContext</code> interface is accessible from the <code class="literal">Environment</code>
				when this filter is present in the hierarchy and provides <code class="literal">addField(String key, String value);</code>
				and <code class="literal">Map getFields();</code> methods for managing special form fields. See also information 
				about <a href="#systemForm">systemForm</a> tag.
			</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="StandardWindowScrollPositionFilterWidget"></a>3.5.21.&nbsp;Window Scroll Position Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">StandardWindowScrollPositionFilterWidget</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td><code class="literal">araneaScrollingFilter</code></td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td>WindowScrollPositionContext</td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td>-</td></tr></tbody></table></div><p>
      This filter provides a way to preserve the scroll position of the window so that the
      user would not have to scroll back to the same place on the page every time they click
      on something. With every submit, the page sends its scroll coordinates so that the next
      response would know where to scroll the page. All-in-all, you can consider it a nice
      feature to have.
      </p><p>
			To enable this feature, one must define it in <code class="literal">aranea-conf.xml</code>:

</p><pre class="programlisting"><pre><span class="syntax0"> <span class="syntax10">&lt;</span><span class="syntax10">bean id</span>=<span class="syntax3">"araneaCustomWidgetFilters"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span>
<span class="syntax10">    class</span>=<span class="syntax3">"org.araneaframework.framework.filter.StandardFilterChainWidget"</span><span class="syntax10">&gt;</span>
   <span class="syntax10">&lt;</span><span class="syntax10">property name</span>=<span class="syntax3">"filterChain"</span><span class="syntax10">&gt;</span>
     <span class="syntax10">&lt;</span><span class="syntax10">list</span><span class="syntax10">&gt;</span>
       <span class="syntax10">&lt;</span><span class="syntax10">ref bean</span>=<span class="syntax3">"araneaScrollingFilter"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
     <span class="syntax10">&lt;</span><span class="syntax10">/list</span><span class="syntax10">&gt;</span>
   <span class="syntax10">&lt;</span><span class="syntax10">/property</span><span class="syntax10">&gt;</span>
 <span class="syntax10">&lt;</span><span class="syntax10">/bean</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>

			Note the <code class="literal">araneaScrollingFilter</code>, which you do not have
			to define yourself (just reference it).
			</p><p>
			In addition, this feature must be registered in a (root) JSP page:

</p><pre class="programlisting"><pre><span class="syntax0"> ...
  <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">body</span><span class="syntax10">&gt;</span>

    <span class="syntax10">&lt;</span><span class="syntax10">div id</span>=<span class="syntax3">"</span><span class="syntax3">cont1</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">systemForm</span><span class="syntax10"> method</span>=<span class="syntax3">"</span><span class="syntax3">POST</span><span class="syntax3">"</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">registerScrollHandler</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">registerPopups</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">registerOverlay</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
...
</span></pre></pre><p>

			Notice the <code class="literal">&lt;ui:registerScrollHandler/&gt;</code> tag!
			</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4427"></a>3.6.&nbsp;Other</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="framework-extensions"></a>3.6.1.&nbsp;Extension Resources</h3></div></div></div><p>External resources, such as javascript, style and image files of
      Aranea components are managed through different configuration files. The
      resources are listed in XML files and can be accessed through
      <code class="literal">StandardFileImportFilterService</code>. This approach makes
      it possible to package all the resources into the aranea
      <code class="literal">jar</code> archives and no manual copying of necessary files
      to fixed locations is needed.</p><p>Aranea comes bundled with a
      <code class="literal">aranea-resources.xml</code> file which defines all the
      external resources. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">resources</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">files content-type</span>=<span class="syntax3">"text/css"</span><span class="syntax10"> group</span>=<span class="syntax3">"defaultStyles"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">file path</span>=<span class="syntax3">"styles/_styles_global.css"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax10">file path</span>=<span class="syntax3">"styles/_styles_screen.css"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/files</span><span class="syntax10">&gt;</span>

  <span class="syntax10">&lt;</span><span class="syntax10">files content-type</span>=<span class="syntax3">"image/gif"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">file path</span>=<span class="syntax3">"gfx/i01.gif"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax10">file path</span>=<span class="syntax3">"gfx/i02.gif"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/files</span><span class="syntax10">&gt;</span>
  ...
<span class="syntax10">&lt;</span><span class="syntax10">/resources</span><span class="syntax10">&gt;</span>
</span></pre></pre><p> All the files listed in the configuration
      files are allowed to be loaded through the
      <code class="literal">FileImportFilter</code>. Some are grouped by name to provide
      an easy access for reading files in bulk.</p><p>To <span class="emphasis"><em>override</em></span> specific files in the
      configuration file, the new file should be placed in a subdirectory
      <code class="literal">override</code>. When loading a file, Aranea first trys to
      open the file in the <code class="literal">override</code> directory and on
      failure trys to read the file without the prefix directory.</p><p>To <span class="emphasis"><em>add</em></span> files to the defined list, construct a
      configuration file and name it <code class="literal">aranea-resources.xml</code>.
      All such configuration files from the classpath are parsed for the
      resources. If two file groups are defined with the same name, the group
      is formed by taking a union from the files in the group.</p><p>Groupnames <code class="literal">defaultStyles</code> and
      <code class="literal">defaultScripts</code> are predefined groups for managing the
      necessary core files that must be included for Aranea to work
      correctly.</p><p>For custom loading a resource, the URL to use is
      <code class="literal">/fileimporter/filepath</code>. The
      <code class="literal">fileimporter</code> is
      <code class="literal">StandardFileImportFilterService.FILE_IMPORTER_NAME</code>
      and <code class="literal">filepath</code> is the path that is defined for the file
      in the resource configuration file.</p><p>Extensions of the framework provide their own configuration files
      for configuring their resources. New extensions cannot be defined right
      now on the fly.</p></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="jsp"></a>Chapter&nbsp;4.&nbsp;JSP and Custom Tags</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e4500"></a>4.1.&nbsp;Aranea Standard Tag Library</h2></div></div></div><p>Aranea supports JSP rendering by providing a JSP 1.2 custom tag
    library that tries to abstract away from HTML and allow programming in
    terms of widgets, layouts and logical GUI elements. The tag library URI is
    "http://araneaframework.org/tag-library/standard" and it is contained in
    <code class="literal">aranea-presentation.jar</code>, so putting this JAR in the
    classpath (e.g. <code class="literal">WEB-INF/lib</code>) is enough to put it to
    work. Library tags support JSP Expression Language that is used in JSTL
    1.0.</p><p>Aranea examples use JSP XML form and in such form importing the
    library should look like this: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">jsp</span><span class="syntax10">:root </span><span class="syntax5">xmlns</span><span class="syntax10">:jsp</span>=<span class="syntax3">"http://java.sun.com/JSP/Page"</span><span class="syntax10"> </span>
<span class="syntax10">  </span><span class="syntax5">xmlns</span><span class="syntax10">:ui</span>=<span class="syntax3">"http://araneaframework.org/tag-library/standard"</span><span class="syntax10"> version</span>=<span class="syntax3">"1.2"</span><span class="syntax10">&gt;</span>
  ...
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">jsp</span><span class="syntax10">:root</span><span class="syntax10">&gt;</span>
</span></pre></pre><p> In a usual JSP file it should look like
    this: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">&lt;%@</span><span class="syntax10"> </span><span class="syntax6">taglib</span><span class="syntax10"> </span><span class="syntax7">uri</span>=<span class="syntax3">"</span><span class="syntax3">http://araneaframework.org/tag-library/standard</span><span class="syntax3">"</span><span class="syntax10"> </span><span class="syntax7">prefix</span>=<span class="syntax3">"</span><span class="syntax3">ui</span><span class="syntax3">"</span><span class="syntax10"> </span><span class="syntax6">%&gt;</span>
...
</span></pre></pre><p> The suggested prefix for the tag library is "ui".</p><p>
        There is otherwise identical taglib that has <code class="literal">&lt;rtexprvalue&gt;</code> set to <code class="literal">true</code>
        for each tag attribute. URI for that taglib is <code class="literal">http://araneaframework.org/tag-library/standard_rt</code>.
        When using JSP version 2.0 or higher, this taglib should be used, otherwise EL in attributes is rejected by
        containers.
    </p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="systemTags"></a>4.2.&nbsp;System Tags</h2></div></div></div><p>Aranea JSP rendering should start from some root JSP (<span class="emphasis"><em>root template</em></span>) that will 
    include the root widget(s) (which typically are some kind of flowcontainers or menus). To
    support widgets and other custom tags one needs to make sure that the
    template looks something like this: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">jsp</span><span class="syntax10">:root </span>
<span class="syntax10">  </span><span class="syntax5">xmlns</span><span class="syntax10">:jsp</span>=<span class="syntax3">"http://java.sun.com/JSP/Page"</span><span class="syntax10"> </span>
<span class="syntax10">  </span><span class="syntax5">xmlns</span><span class="syntax10">:ui</span>=<span class="syntax3">"http://araneaframework.org/tag-library/standard"</span><span class="syntax10"> version</span>=<span class="syntax3">"1.2"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">html</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">head</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">title</span><span class="syntax10">&gt;</span>Aranea Template Application<span class="syntax10">&lt;</span><span class="syntax10">/title</span><span class="syntax10">&gt;</span>
         
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:importScripts/</span><span class="syntax10">&gt;</span>      
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:importStyles/</span><span class="syntax10">&gt;</span>      
   
      <span class="syntax10">&lt;</span><span class="syntax10">/head</span><span class="syntax10">&gt;</span>
    
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:body</span><span class="syntax10">&gt;</span>
          <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:systemForm method</span>=<span class="syntax3">"POST"</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax10">h1</span><span class="syntax10">&gt;</span>Aranea Application<span class="syntax10">&lt;</span><span class="syntax10">/h1</span><span class="syntax10">&gt;</span>
              
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:messages/</span><span class="syntax10">&gt;</span>

            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetInclude id</span>=<span class="syntax3">"root"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
          <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:systemForm</span><span class="syntax10">&gt;</span>
          
      <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:body</span><span class="syntax10">&gt;</span>   
    <span class="syntax10">&lt;</span><span class="syntax10">/html</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">jsp</span><span class="syntax10">:root</span><span class="syntax10">&gt;</span>
</span></pre></pre><p> Next are described all these tags except
    &lt;ui:widgetInclude&gt;, which is described in the following
    section.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4541"></a>4.2.1.&nbsp;&lt;ui:importScripts&gt;</h3></div></div></div><p>Aranea comes bundled with different external resources: javascript
      libraries, stylesheets and images. To automate the process of loading
      the javascript files without the manual copying of them to specific
      webapp locations, a special filter is used. The filter is able to read
      files from aranea <code class="literal">jar</code> files.</p><p>&lt;ui:importScripts&gt; depends on the filter
      <span class="emphasis"><em>StandardServletFileImportFilterService</em></span> being set.
      The filter provides the functionality of reading files from the jars on
      the server.</p><p>If no attributes specified, the default group of javascript files
      are loaded.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e4556"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>file</td><td><span class="emphasis"><em>no</em></span></td><td>Writes HTML <code class="literal">&lt;script&gt;</code> tag to
                load the specific file.</td></tr><tr><td>group</td><td><span class="emphasis"><em>no</em></span></td><td>Writes HTML <code class="literal">&lt;script&gt;</code> tag to
                load a group of javascript files.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"></div><p>Here is the list of all available values for the <code class="literal">group</code> attribute:</p><div class="orderedlist"><ol type="1"><li><span class="emphasis"><em>all</em></span> - imports all of the groups described below.</li><li><span class="emphasis"><em>core-all</em></span> - imports the core Aranea scripts, in addition,
					popup, modalbox, back-button support (rsh) scripts.</li><li><span class="emphasis"><em>core</em></span> - imports only core aranea scripts that are always needed.</li><li><span class="emphasis"><em>calendar</em></span> - imports only <a href="#dhtmlcalendar" title="9.1.1.&nbsp;The DHTML Calendar (http://www.dynarch.com/projects/calendar/)">DHTML calendar</a> scripts.</li><li><span class="emphasis"><em>calendar_et</em></span> - imports only <a href="#dhtmlcalendar" title="9.1.1.&nbsp;The DHTML Calendar (http://www.dynarch.com/projects/calendar/)">DHTML calendar</a> scripts
				with an interface in estonian language.</li><li><span class="emphasis"><em>modalbox</em></span> - imports only <a href="#modalbox" title="9.1.6.&nbsp;ModalBox (http://www.wildbit.com/labs/modalbox/)">ModalBox</a> scripts.</li><li><span class="emphasis"><em>rsh</em></span> - imports only back-button support scripts.</li><li><span class="emphasis"><em>prototip</em></span> - imports only <a href="#prototip" title="9.1.5.&nbsp;Prototip (http://www.nickstakenburg.com/projects/prototip/)">Prototip</a> scripts.</li><li><span class="emphasis"><em>ajaxupload</em></span> - imports only <a href="#">AJAX upload</a> functionality scripts.</li><li><span class="emphasis"><em>logger</em></span> - imports only <a href="#log4javascript" title="9.1.7.&nbsp;log4javascript (http://log4javascript.org/)">log4javascript</a> scripts.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Since 1.2.1 these Aranea JavaScript files (groups) are compressed for faster download. However, it also possible
				to see these scripts in more readable form by appenging "-devel" to these group names, e.g. <span class="emphasis"><em>all</em></span>
				vs. <span class="emphasis"><em>all-devel</em></span>. These groups don't have the <span class="emphasis"><em>devel</em></span> version:</p><div class="itemizedlist"><ul type="disc"><li><span class="emphasis"><em>calendar</em></span></li><li><span class="emphasis"><em>calendar_et</em></span></li><li><span class="emphasis"><em>prototip</em></span></li><li><span class="emphasis"><em>ajaxupload</em></span></li><li><span class="emphasis"><em>logger</em></span> (always compressed)</li></ul></div><p>If you are used to including <span class="emphasis"><em>aranea*.js</em></span> scripts one-by-one then your scripts will be
					automatically compressed. To include original scripts, insert "src/" right before the file name, e.g.
					</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">importScripts</span><span class="syntax10"> file</span>=<span class="syntax3">"</span><span class="syntax3">js/aranea/aranea.js</span><span class="syntax3">"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
					to:
					</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">importScripts</span><span class="syntax10"> file</span>=<span class="syntax3">"</span><span class="syntax3">js/aranea/src/aranea.js</span><span class="syntax3">"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
				</p></div><p>To use <a href="#tinymce" title="9.1.4.&nbsp;TinyMCE (http://tinymce.moxiecode.com/)">TinyMCE editor</a>, you need to include its scripts like this:
			</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">ui:</span><span class="syntax9">importScripts</span><span class="syntax10"> file</span>=<span class="syntax3">"</span><span class="syntax3">js/tiny_mce/tiny_mce.js</span><span class="syntax3">"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e4707"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:importScripts/</span><span class="syntax10">&gt;</span> <span class="syntax1">&lt;!-- imports files from 'all' group --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:importScripts group</span>=<span class="syntax3">"logger"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span> <span class="syntax1">&lt;!-- imports additional debug scripts (js logger) --&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4712"></a>4.2.2.&nbsp;&lt;ui:importStyles&gt;</h3></div></div></div><p>Aranea comes bundled with CSS files to provide custom look for
      different predefined components (the template app, calendar, htmleditor,
      etc.). Just as with javascript, to use them one would have to extract
      them from the jars and use them just like any other css file would be
      used. To automate this process with aranea css files one can use the
      &lt;ui:importStyles&gt; tag to include the css files
      <span class="emphasis"><em>automatically</em></span>.</p><p>&lt;ui:importStyles&gt; depends on the filter
      <span class="emphasis"><em>StandardServletFileImportFilterService</em></span> being set.
      The filter provides the functionality of reading files from the jars on
      the server.</p><p>If no are attributes specified, the default group
      (<span class="emphasis"><em>i.e. all</em></span>) of css files are loaded.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e4730"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>file</td><td><span class="emphasis"><em>no</em></span></td><td>Writes out the HTML's CSS handling
                <code class="literal">link</code> to load the specific file.</td></tr><tr><td>group</td><td><span class="emphasis"><em>no</em></span></td><td>Writes out the HTML's CSS handling
                <code class="literal">link</code> to load the group of files.</td></tr><tr><td>media</td><td><span class="emphasis"><em>no</em></span></td><td>Media type to which imported styles are applied.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"></div><p>Here is the list of all available values for the <code class="literal">group</code> attribute:</p><div class="orderedlist"><ol type="1"><li><span class="emphasis"><em>all</em></span> - imports all of the styles (CSS) from the groups described below.</li><li><span class="emphasis"><em>aranea</em></span> - imports only Aranea styles (<span class="emphasis"><em>aranea.css</em></span>
				for the page loading message, and <span class="emphasis"><em>comboselect.css</em></span> for multiselect combo box.</li><li><span class="emphasis"><em>calendar</em></span> - imports only <a href="#dhtmlcalendar" title="9.1.1.&nbsp;The DHTML Calendar (http://www.dynarch.com/projects/calendar/)">DHTML calendar</a> styles.</li><li><span class="emphasis"><em>contextmenu</em></span> - imports only <a href="#contextmenu" title="7.3.&nbsp;Context Menu">Aranea context menu</a> styles.</li><li><span class="emphasis"><em>modalbox</em></span> - imports only <a href="#modalbox" title="9.1.6.&nbsp;ModalBox (http://www.wildbit.com/labs/modalbox/)">ModalBox</a> styles.</li><li><span class="emphasis"><em>prototip</em></span> - imports only <a href="#prototip" title="9.1.5.&nbsp;Prototip (http://www.nickstakenburg.com/projects/prototip/)">Prototip</a> styles.</li></ol></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e4826"></a>4.2.3.&nbsp;&lt;ui:body&gt;</h3></div></div></div><p>This tag will render an HTML &lt;body&gt; tag with Aranea JSP
      specific <span class="emphasis"><em>onload</em></span> and <span class="emphasis"><em>onunload</em></span>
      events attached. It usually writes out some other page initialization
      scripts too, depending on the circumstances. It must be present in
      a JSP template, otherwise most client-side functionality will cease to function.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e4837"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>onload</td><td><span class="emphasis"><em>no</em></span></td><td>Overwrite the standard Aranea JSP HTML body onload
                event. Use with caution.</td></tr><tr><td>onunload</td><td><span class="emphasis"><em>no</em></span></td><td>Overwrite the standard Aranea JSP HTML body onload
                event. Use with caution.</td></tr><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>HTML BODY id.</td></tr><tr><td>dir</td><td><span class="emphasis"><em>no</em></span></td><td>HTML BODY dir attribute.</td></tr><tr><td>lang</td><td><span class="emphasis"><em>no</em></span></td><td>HTML BODY lang attribute.</td></tr><tr><td>title</td><td><span class="emphasis"><em>no</em></span></td><td>HTML BODY title attribute.</td></tr></tbody></table></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="systemForm"></a>4.2.4.&nbsp;&lt;ui:systemForm&gt;</h3></div></div></div><p>This tag will render an HTML &lt;form&gt; tag along with some
      Aranea-specific hidden fields. When making custom web applications it is
      strongly suggested to have only one system form in the template and have
      it submit using <span class="emphasis"><em>POST</em></span>. This will ensure that no
      matter what user does no data is ever lost. However Aranea does not
      impose this idiom and one may just as well submit using
      <span class="emphasis"><em>GET</em></span>, define system forms in widgets and use usual
      HTML links instead of JavaScript. See <a href="#systemTags" title="4.2.&nbsp;System Tags">Section&nbsp;4.2, &#8220;System Tags&#8221;</a> for
      usage example and <a href="#StandardSystemFormFilterService" title="3.5.20.&nbsp;System Form Field Storage Filter">Section&nbsp;3.5.20, &#8220;System Form Field Storage Filter&#8221;</a> about a
      filter that provides some essential hidden fields.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e4917"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>The HTML "id" of the <code class="literal">&lt;form&gt;</code>
                tag that may be used in JavaScript. It will be autogenerated
                if omitted.</td></tr><tr><td>method</td><td><span class="emphasis"><em>yes</em></span></td><td>HTTP submit method, either <code class="literal">GET</code> or
                <code class="literal">POST</code>.</td></tr><tr><td>enctype</td><td><span class="emphasis"><em>no</em></span></td><td>Same as HTML <code class="literal">&lt;form&gt;</code> attribute
                <code class="literal">enctype</code>, defines how form data is
                encoded.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e4973"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>systemFormId</td><td>SystemForm FORM id.</td><td align="center"><code class="literal">String</code></td></tr></tbody></table></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="uimessagesjsp"></a>4.2.5.&nbsp;&lt;ui:messages&gt;</h3></div></div></div><p>This tag will render messages of given type if they are present in
      current <code class="literal">MessageContext</code>. When type is not specified,
      all types of messages are rendered. As <code class="literal">MessageContext</code>
      is typically used for error messages, it is common to render these
      messages somewhere near top of the page, where they can easily be
      spotted.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5009"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td><span class="emphasis"><em>no</em></span></td><td>Message type.</td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>CSS class applied to rendered messages, default being
                <code class="literal">aranea-messages</code>.</td></tr><tr><td>divId</td><td><span class="emphasis"><em>no</em></span></td><td>Sets the id of the HTML <span class="emphasis"><em>&lt;div&gt;</em></span> inside which the messages are rendered.
                If left unspecified, no id is assigned.</td></tr><tr><td>style</td><td><span class="emphasis"><em>no</em></span></td><td>CSS inline style applied to rendered messages. Use <code class="literal">styleClass</code> instead.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5067"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:messages type</span>=<span class="syntax3">"info"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:messages type</span>=<span class="syntax3">"error"</span><span class="syntax10"> styleClass</span>=<span class="syntax3">"custom-error-message-class"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:messages/</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5072"></a>4.3.&nbsp;Basic Tags</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5075"></a>4.3.1.&nbsp;&lt;ui:attribute&gt;</h3></div></div></div><p>Defines an attribute of the containing element, where possible.
      See also <a href="#uielementTag" title="4.3.3.&nbsp;<ui:element&gt;">Section&nbsp;4.3.3, &#8220;&lt;ui:element&gt;&#8221;</a>. Most form element tags accept
      attributes set by this tag too, see <a href="#attribute_examples" title="Examples">the section called &#8220;Examples&#8221;</a>.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td><span class="emphasis"><em>yes</em></span></td><td>Attribute name.</td></tr><tr><td>value</td><td><span class="emphasis"><em>yes</em></span></td><td>Attribute value.</td></tr></tbody></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="attribute_examples"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax1">&lt;!-- set the onkeypress attribute for HTML input produced by ui:textInput--&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"onkeypress"</span><span class="syntax10"> value</span>=<span class="syntax3">"upperCase(this);"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:textInput</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5120"></a>4.3.2.&nbsp;&lt;ui:elementContent&gt;</h3></div></div></div><p>Defines an HTML element content, meaning the body of the HTML
      element where text and other tags go.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="uielementTag"></a>4.3.3.&nbsp;&lt;ui:element&gt;</h3></div></div></div><p>Defines HTML node, can be used together with
      <code class="literal">&lt;ui:attribute&gt;</code> and
      <code class="literal">&lt;ui:elementContent&gt;</code> to define a full HTML
      node.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>name</td><td><span class="emphasis"><em>no</em></span></td><td>HTML element name.</td></tr></tbody></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="element_attribute_examples"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:element name</span>=<span class="syntax3">"span"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"class"</span><span class="syntax10"> value</span>=<span class="syntax3">"fancy"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:elementContent</span><span class="syntax10">&gt;</span>Contents of fancy span.<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:elementContent</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:element</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="keyboardHandlerTag"></a>4.3.4.&nbsp;&lt;ui:keyboardHandler&gt;</h3></div></div></div><p>Registers a simple javascript keyboard handler.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>scope</td><td><span class="emphasis"><em>no</em></span></td><td>When a keyboard event happens, it is usually associated
                with a certain form element / form / widget / etc. The object
                with which an event is associated is identified by a
                hierarchical id (e.g. there may be widget 'somelist',
                containing form 'somelist.form', containing textbox
                'somelist.form.textbox'. The scope is a prefix of that id that
                must match in order for the handler to be triggered. For
                example, the handler with scope='somelist.form.textbox' will
                be triggered only when the event in the textbox occurs, but
                the handler with scope="somelist" will be triggered when any
                event in any of the elements inside any of the forms of
                "somelist" occurs. I.e. for any element with ID beginning with
                'somelist'. When scope is not specified, a global handler is
                registered, that reacts to an event in any
                form/widget.</td></tr><tr><td>handler</td><td><span class="emphasis"><em>yes</em></span></td><td>A javascript handler function that takes two parameters
                - the event object and the element id for which the event was
                fired. Example: <pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">function</span>(event<span class="syntax11">,</span> elementId) <span class="syntax11">{</span> <span class="syntax9">alert</span>(elementId)<span class="syntax11">;</span> <span class="syntax11">}</span>
</span></pre></pre></td></tr><tr><td>keyCode</td><td><span class="emphasis"><em>no</em></span></td><td>Keycode to which the event must be triggered. 13 means
                enter. Either keyCode or key must be specified, but not
                both.</td></tr><tr><td>key</td><td><span class="emphasis"><em>no</em></span></td><td>Key, to which the event must be triggered. Key is
                specified as a certain 'alias'. The alias may be an ASCII
                character or a digit (this will denote the corresponding key
                on a US keyboard), a space (' '), or one of the following:
                'return', 'escape', 'backspace', 'tab', 'shift', 'control',
                'space', 'f1', 'f2', ..., 'f12'.</td></tr><tr><td>keyCombo</td><td><span class="emphasis"><em>no</em></span></td><td>Key combination, which should trigger the event. It can
                is specified with key aliases separated with "+" signs.
                For example "ctrl+alt+f1", "alt+r" etc.</td></tr></tbody></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="keyboardHandler_examples"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax1">&lt;!-- Globally-scoped F2 listener --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:keyboardHandler </span>
<span class="syntax10">  scope</span>=<span class="syntax3">""</span><span class="syntax10"> </span>
<span class="syntax10">  key</span>=<span class="syntax3">"f2"</span><span class="syntax10"> </span>
<span class="syntax10">  handler</span>=<span class="syntax3">"function() { alert('You pressed F2. Do it again if you dare!');}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5231"></a>4.3.5.&nbsp;&lt;ui:eventKeyboardHandler&gt;</h3></div></div></div><p>Registers a 'server-side' keyboard handler that sends an event to
      the specified widget.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>scope</td><td><span class="emphasis"><em>no</em></span></td><td><a href="#keyboardHandlerTag" title="4.3.4.&nbsp;<ui:keyboardHandler&gt;">Section&nbsp;4.3.4, &#8220;&lt;ui:keyboardHandler&gt;&#8221;</a></td></tr><tr><td>widgetId</td><td><span class="emphasis"><em>no</em></span></td><td>Id of Widget that is target of event produced by
                keyboard handler.</td></tr><tr><td>eventId</td><td><span class="emphasis"><em>no</em></span></td><td>Id of event that should be sent to target
                widget.</td></tr><tr><td>eventParam</td><td><span class="emphasis"><em>no</em></span></td><td>Event parameters</td></tr><tr><td>updateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Enumerates the regions of markup to be updated in this
                widget scope. Please see &lt;ui:updateRegion&gt; for
                details.</td></tr><tr><td>globalUpdateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Enumerates the regions of markup to be updated
                globally. Please see &lt;ui:updateRegion&gt; for
                details.</td></tr><tr><td>keyCode</td><td><span class="emphasis"><em>no</em></span></td><td>Keycode to which the event must be triggered. 13 means
                enter. Either keyCode or key must be specified, but not
                both.</td></tr><tr><td>key</td><td><span class="emphasis"><em>no</em></span></td><td>Key, to which the event must be triggered. Key is
                specified as a certain 'alias'. The alias may be an ASCII
                character or a digit (this will denote the corresponding key
                on a US keyboard), a space (' '), or one of the following:
                'return', 'escape', 'backspace', 'tab', 'shift', 'control',
                'space', 'f1', 'f2', ..., 'f12'.</td></tr><tr><td>keyCombo</td><td><span class="emphasis"><em>no</em></span></td><td>Key combination, which should trigger the event. It can
                is specified with key aliases separated with "+" signs.
                For example "ctrl+alt+f1", "alt+r" etc.</td></tr></tbody></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="eventKeyboardHandler_examples"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax1">&lt;!-- F2 listener that sends event 'add' to context widget upon activation --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:eventKeyboardHandler eventId</span>=<span class="syntax3">"add"</span><span class="syntax10"> key</span>=<span class="syntax3">"f2"</span><span class="syntax10"> widgetId</span>=<span class="syntax3">"${widgetId}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5328"></a>4.4.&nbsp;Widget Tags</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5331"></a>4.4.1.&nbsp;&lt;ui:widgetContext&gt;</h3></div></div></div><p>This tag should generally be the root of every widget JSP. It
      makes the widget view model accessible as an EL variable. It can also be
      used to render a descendant widget in the same JSP with the current
      widget. In the latter case you should set the <span class="emphasis"><em>id</em></span>
      attribute to the identifier path of the descendant widget in question.
      Note that all widget-related tags inside of this tag will assume that
      the widget in question is their parent or ancestor (that is all the
      identifier paths will start from it).</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5339"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>A dot-separated widget identifier path leading from the
                current context widget to the new one.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5364"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td>widget</td><td>The context widget instance. Can be used to access
                JavaBean property data from the widget (e.g.
                <code class="literal">${widget.foo}</code> will translate to a
                <code class="literal">getFoo()</code> widget call}.</td></tr><tr><td>widgetId</td><td>The full dot-separated identifier of the context
                widget.</td></tr><tr><td>viewData</td><td>The view data of the context widget (see
                <code class="literal">BaseApplicationWidget.putViewData()</code>).</td></tr><tr><td>viewModel</td><td>The view model of the context widget.</td></tr><tr><td>scopedWidgetId</td><td>The scoped id of the context widget.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5412"></a>Examples</h4></div></div></div>

         The most common usage of &lt;ui:widgetContext&gt; is as root tag for widget JSPs: 

        <pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:out value</span>=<span class="syntax3">"${viewData.myMessage}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
...
</span></pre></pre>

         The other use case is to render a descendant widget: 

        <pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext id</span>=<span class="syntax3">"child.ofMyChild"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:out value</span>=<span class="syntax3">"${viewData.messageFromChildOfMyChild}"</span>
<span class="syntax10">    &lt;/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5421"></a>4.4.2.&nbsp;&lt;ui:widget&gt;</h3></div></div></div><p>This tag is used when one needs to render a child or descendant
      widget while still retaining in both current widget context and JSP. It
      publishes the widget view model and full identifier as EL variables, but
      does little else and does not setup a widget context (e.g.
      <code class="literal">&lt;ui:widgetInclude&gt;</code> tag will not take it into
      account).</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5429"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>A dot-separated widget identifier path leading from the
                current context widget to the target widget.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5454"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Variable</th><th>Description</th></tr></thead><tbody><tr><td>widget</td><td>The widget instance. Can be used to access JavaBean
                property data from the widget (e.g.
                <code class="literal">${widget.foo}</code> will translate to a
                <code class="literal">getFoo()</code> widget call}.</td></tr><tr><td>widgetId</td><td>The full dot-separated identifier of the
                widget.</td></tr><tr><td>viewData</td><td>The view data of the widget (see
                <code class="literal">BaseApplicationWidget.putViewData()</code>).</td></tr><tr><td>viewModel</td><td>The view model of the widget.</td></tr><tr><td>scopedWidgetId</td><td>The scoped id of the context widget.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5502"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widget id</span>=<span class="syntax3">"child.ofMyChild"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:out value</span>=<span class="syntax3">"${viewData.messageFromChildOfMyChild}"</span>
<span class="syntax10">          </span><span class="syntax5">&lt;ui</span><span class="syntax10">:widgetInclude id</span>=<span class="syntax3">"child"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widget</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5507"></a>4.4.3.&nbsp;&lt;ui:widgetInclude&gt;</h3></div></div></div><p>This tag is used to render some child or descendant widget. It
      will call the widget's <code class="literal">render()</code> method, which will
      allow the target widget to choose how to render itself.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5515"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>A dot-separated widget identifier path leading from the
                current context widget to the target widget.</td></tr><tr><td>path</td><td><span class="emphasis"><em>no</em></span></td><td>Path to JSP, relative to <code class="literal">jspPath</code> of <code class="literal">StandardJspFilterService</code>.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5554"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetInclude id</span>=<span class="syntax3">"child.ofMyChild"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5559"></a>4.5.&nbsp;Event-producing Tags</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5562"></a>4.5.1.&nbsp;&lt;ui:eventButton&gt; and &lt;ui:eventLinkButton&gt;</h3></div></div></div><p>These tags will render a button (or a link) that when clicked will
      send a specified event to the target widget with an optional
      <code class="literal">String</code> parameter.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5570"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>HTML "id" of the element that can be used to access it
                via DOM.</td></tr><tr><td>labelId</td><td><span class="emphasis"><em>no</em></span></td><td>The key of the localizable label that will be displayed
                on the button.</td></tr><tr><td>eventId</td><td><span class="emphasis"><em>no</em></span></td><td>The identifier of the event that will be sent to the
                target widget.</td></tr><tr><td>eventParam</td><td><span class="emphasis"><em>no</em></span></td><td><code class="literal">String</code> event parameter that will
                accompany the event.</td></tr><tr><td>eventTarget</td><td><span class="emphasis"><em>no</em></span></td><td>ID of receiving widget. Almost never set directly.
                Defaults to current context widget.</td></tr><tr><td>disabled</td><td><span class="emphasis"><em>no</em></span></td><td>If set to a not null value will show the button
                disabled.</td></tr><tr><td>renderMode</td><td><span class="emphasis"><em>no</em></span></td><td>Allowed values are (button | input) - the corresponding HTML tag will be used for rendering. Default is button.
                This attribute only applies to <code class="literal">&lt;ui:eventButton&gt;</code>, <code class="literal">&lt;ui:eventLinkButton&gt;</code>
                is always rendered with HTML link.
                </td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>The CSS class that will override the default one.</td></tr><tr><td>updateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Comma separated list of update regions that should be
                updated upon button receiving event. This attribute is only
                needed when using AJAX features&#8212;ordinary HTTP requests always
                update whole page.</td></tr><tr><td>globalUpdateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Comma separated list of global update regions that
                should be updated upon button receiving event. This attribute
                is only needed when using AJAX features&#8212;ordinary HTTP requests
                always update whole page.</td></tr><tr><td>onClickPrecondition</td><td><span class="emphasis"><em>no</em></span></td><td>Precondition for deciding whether onclick event should
                go server side or not. If left unspecified, this is considered
                to be <code class="literal">true</code>.</td></tr><tr><td>tabindex</td><td><span class="emphasis"><em>no</em></span></td><td>This attribute specifies the position of the current element in the tabbing order for the current document. This value must be a number between 0 and 32767.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5694"></a>HTML, Styles and JavaScript</h4></div></div></div><p>The <code class="literal">eventButton</code> tag writes out an HTML
        <code class="literal">&lt;button&gt;</code> closed tag with a default CSS class
        of "aranea-button".</p><p>The <code class="literal">eventLinkButton</code> tag writes out an HTML
        <code class="literal">&lt;a&gt;</code> open tag with a default CSS class of
        "aranea-link-button".</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5713"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    ...
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:eventButton eventId</span>=<span class="syntax3">"test"</span><span class="syntax10"> eventParam</span>=<span class="syntax3">"${bean.id}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:eventLinkButton eventId</span>=<span class="syntax3">"edit"</span><span class="syntax10"> eventParam</span>=<span class="syntax3">"${bean.id}"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">img src</span>=<span class="syntax3">"editButton.png"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:eventLinkButton</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5719"></a>4.5.2.&nbsp;&lt;ui:onLoadEvent&gt;</h3></div></div></div><p>This tag will register events that are executed when HTML page
      body has completely loaded. This tag can be used multiple times, all
      specified events will be added to event queue and executed in order of
      addition.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5724"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>event</td><td><span class="emphasis"><em>yes</em></span></td><td>Event to register.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5749"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:onLoadEvent event</span>=<span class="syntax3">"activateFlashLights();"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:onLoadEvent event</span>=<span class="syntax3">"changeMenuBackGroundColor();"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5754"></a>4.5.3.&nbsp;&lt;ui:registerPopups&gt;</h3></div></div></div><p>This tag checks presence of server-side session-threads that
      represent popups and adds system loadevent for opening them in new
      browser window at client-side. For tag to have an effect, HTML page
      <code class="literal">BODY</code> tag must have attribute onload event set to
      <span class="emphasis"><em>AraneaPage</em></span> (See <a href="#aranea_clientside_js">Aranea Clientside Javascript</a>) onload event. Also, this tag only
      works inside &lt;ui:systemForm&gt; tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5767"></a>Attributes</h4></div></div></div><p>This tag has no attributes.</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5772"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:body</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:systemForm method</span>=<span class="syntax3">"POST"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:registerPopups/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:systemForm</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:body</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5777"></a>4.6.&nbsp;HTML entity Tags</h2></div></div></div><p>HTML entities can be inserted by using the predefined entity tags or
    using the &lt;ui:entity&gt; for entities that have not been defined by
    Aranea JSP library.</p><p>The <code class="literal">entity</code> tag accepts a attribute
    <code class="literal">code</code> which is used as &amp;<code class="literal">code</code>; to
    get the HTML entity.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>code</td><td><span class="emphasis"><em>no</em></span></td><td>HTML entity code, e.g. <span class="emphasis"><em>nbsp</em></span> or
            <span class="emphasis"><em>#012</em></span>.</td></tr><tr><td>count</td><td><span class="emphasis"><em>no</em></span></td><td>Number of times to repeat the entity.</td></tr></tbody></table></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5829"></a>4.6.1.&nbsp;Predefined entity tags</h3></div></div></div><p>The following predefined entities also accept the
      <code class="literal">count</code> attribute. It defines the number of times to
      repeat the entity.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Tag</th><th>Description</th></tr></thead><tbody><tr><td>&lt;ui:acute&gt;</td><td>HTML <code class="literal">&amp;acute;</code> entity.</td></tr><tr><td>&lt;ui:copyright&gt;</td><td>HTML <code class="literal">&amp;copyright;</code> entity.</td></tr><tr><td>&lt;ui:gt&gt;</td><td>HTML <code class="literal">&amp;gt;</code> entity.</td></tr><tr><td>&lt;ui:laquo&gt;</td><td>HTML <code class="literal">&amp;laquo;</code> entity.</td></tr><tr><td>&lt;ui:lt&gt;</td><td>HTML <code class="literal">&amp;lt;</code> entity.</td></tr><tr><td>&lt;ui:nbsp&gt;</td><td>HTML <code class="literal">&amp;nbsp;</code> entity.</td></tr><tr><td>&lt;ui:raquo&gt;</td><td>HTML <code class="literal">&amp;raquo;</code> entity.</td></tr><tr><td>&lt;ui:acute&gt;</td><td>HTML <code class="literal">&amp;acute;</code> entity.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5912"></a>4.7.&nbsp;Putting Widgets to Work with JSP</h2></div></div></div><p>Now we have defined enough JSP tags to render our example widget
    (see <a href="#widgets-example-widget" title="2.7.8.&nbsp;Putting It All Together">Section&nbsp;2.7.8, &#8220;Putting It All Together&#8221;</a>): </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">jsp</span><span class="syntax10">:root </span>
<span class="syntax10">  </span><span class="syntax5">xmlns</span><span class="syntax10">:jsp</span>=<span class="syntax3">"http://java.sun.com/JSP/Page"</span><span class="syntax10"> </span>
<span class="syntax10">  </span><span class="syntax5">xmlns</span><span class="syntax10">:c</span>=<span class="syntax3">"http://java.sun.com/jstl/core"</span>
<span class="syntax10">  </span><span class="syntax5">xmlns</span><span class="syntax10">:ui</span>=<span class="syntax3">"http://araneaframework.org/tag-library/standard"</span><span class="syntax10"> version</span>=<span class="syntax3">"1.2"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">h3</span><span class="syntax10">&gt;</span>Test widget<span class="syntax10">&lt;</span><span class="syntax10">/h3</span><span class="syntax10">&gt;</span>
    
    Data field: <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:out value</span>=<span class="syntax3">"${viewData.myData.field}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:eventButton labelId</span>=<span class="syntax3">"#Test"</span><span class="syntax10"> eventId</span>=<span class="syntax3">"test"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>      
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetContext</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">jsp</span><span class="syntax10">:root</span><span class="syntax10">&gt;</span>
</span></pre></pre><p> We can use just usual JSTL Core library
    tags to access the widget view data, as long as the
    <code class="literal">&lt;ui:widgetContext&gt;</code> is present via the
    <code class="literal">viewData</code> EL variable.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e5928"></a>4.8.&nbsp;Layout Tags</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e5931"></a>4.8.1.&nbsp;&lt;ui:layout&gt;</h3></div></div></div><p>Represents a layout. Layouts allow to describe the way content
      will be placed on the page.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>width</td><td><span class="emphasis"><em>no</em></span></td><td>Layout width.</td></tr><tr><td>rowClasses</td><td><span class="emphasis"><em>no</em></span></td><td>Default style of rows in this layout.</td></tr><tr><td>cellClasses</td><td><span class="emphasis"><em>no</em></span></td><td>Default style of cells in this layout.</td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>CSS class for tag.</td></tr></tbody></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e5983"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>rowClassProvider</td><td>Provides row class, usually should not be used from JSP.</td><td align="center"><code class="literal">RowClassProvider</code></td></tr><tr><td>cellClassProvider</td><td>Provides cell class, usually should not be used from JSP.</td><td align="center"><code class="literal">CellClassProvider</code></td></tr></tbody></table></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6016"></a>4.8.2.&nbsp;&lt;ui:row&gt;</h3></div></div></div><p>Represents a row in layout.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>height</td><td><span class="emphasis"><em>no</em></span></td><td>Row height.</td></tr><tr><td>cellClasses</td><td><span class="emphasis"><em>no</em></span></td><td>Default style of cells in this row..</td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>Cell css class, defines the way the cell will be
                rendered.</td></tr><tr><td>overrideLayout</td><td><span class="emphasis"><em>no</em></span></td><td>Boolean that determines whether row's own styleClass
                completely overrides styleClass provided by surrounding layout
                (default behaviour), or is appended to layout's
                styleClass.</td></tr></tbody></table></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6068"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>cellClassProvider</td><td>Provides cell class, usually should not be used from JSP.</td><td align="center"><code class="literal">CellClassProvider</code></td></tr></tbody></table></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6093"></a>4.8.3.&nbsp;&lt;ui:cell&gt;</h3></div></div></div><p>Represents a cell in layout.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>height</td><td><span class="emphasis"><em>no</em></span></td><td>Row height.</td></tr><tr><td>width</td><td><span class="emphasis"><em>no</em></span></td><td>Row width.</td></tr><tr><td>colSpan</td><td><span class="emphasis"><em>no</em></span></td><td>Cell colspan, same as in HTML.</td></tr><tr><td>rowSpan</td><td><span class="emphasis"><em>no</em></span></td><td>Cell rowspan, same as in HTML.</td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>Cell css class, defines the way the cell will be
                rendered.</td></tr><tr><td>overrideLayout</td><td><span class="emphasis"><em>no</em></span></td><td>Boolean that determines whether cells's own styleClass
                completely overrides styleClass provided by surrounding layout
                or row (default behaviour), or is appended to layout's or
                row's styleClass.</td></tr></tbody></table></div><p>
        </p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6162"></a>Examples</h4></div></div></div>

         Layouts, rows and cells are used together like this: 

        <pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:layout rowClasses</span>=<span class="syntax3">"even,odd"</span><span class="syntax10"> cellClasses</span>=<span class="syntax3">"one,two,three,four"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
         <span class="syntax1">&lt;!-- cell content --&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:layout</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6168"></a>4.8.4.&nbsp;&lt;ui:updateRegion&gt;,  &lt;ui:updateRegionRow&gt;, and &lt;ui:updateRegionRows&gt;</h3></div></div></div><p>These three tags define the update regions in the output that can be
      updated via AJAX requests. The update regions chosen to be updated when
      some event occurs is decided by tags that take the
      <code class="literal">updateRegion</code> attribute (See <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>).</p><p>The <code class="literal">&lt;ui:updateRegion&gt;</code> should be used when
      defining updateregion when the region is not contained in HTML table
      (layout). The <code class="literal">&lt;ui:updateRegionRow&gt;</code> is basically
      a table row (<code class="literal">td</code>) and is for updating a table row.
      The <code class="literal">&lt;ui:updateRegionRows&gt;</code> is for defining a
      region which is an HTML table body, and contains table rows itself.
      Updating only single cells is not possible due to browser incompatibilities.</p><div class="sect3" lang="en"><div class="titlepage"></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The id of the region. Will be used to reference the
                region when POST'ing a form.</td></tr><tr><td>globalId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>When not using the <code class="literal">globalId</code>, the
                full id will be formed by concatenating the context widget id
                with the specified <code class="literal">id</code>. If for a reason you
                would want to avoid that, then you specify the id with the
                <code class="literal">globalId</code> attribute.</td></tr></tbody></table></div></div><p>
        Either <code class="literal">id</code> or <code class="literal">globalId</code> attribute is required.
      </p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="updateRegionTag_examples"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax1">&lt;!-- First update region, placed outside HTML table --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:updateRegion id</span>=<span class="syntax3">"outsideTable"</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:updateRegion</span><span class="syntax10">&gt;</span>

<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:layout</span><span class="syntax10">&gt;</span>
  <span class="syntax1">&lt;!-- Second update region, placed inside HTML table --&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:updateRegionRows id</span>=<span class="syntax3">"insideTable"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
      ...
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
    <span class="syntax1">&lt;!-- Third update region for updating a row, placed inside HTML table --&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:updateRegionRow id</span>=<span class="syntax3">"aRow"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>...<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>...<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:updateRegionRow/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:updateRegionRows</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:layout</span><span class="syntax10">&gt;</span>

<span class="syntax1">&lt;!-- Button that makes a background submit of specified event. </span>
<span class="syntax1">     When response arrives specified updateregions are updated --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:eventButton id</span>=<span class="syntax3">"test"</span><span class="syntax10"> updateRegions</span>=<span class="syntax3">"outsideTable,insideTable"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6249"></a>4.9.&nbsp;Presentation Tags</h2></div></div></div>

     Aranea JSP library contains synonyms for some (deprecated) HTML presentation tags. 

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6253"></a>4.9.1.&nbsp;&lt;ui:bold&gt;</h3></div></div></div><p>Acts as the HTML  <span class="emphasis"><em>&lt;b&gt;</em></span> tag.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6261"></a>4.9.2.&nbsp;&lt;ui:italic&gt;</h3></div></div></div><p>Acts as <span class="emphasis"><em>&lt;i&gt;</em></span> HTML tag.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6269"></a>4.9.3.&nbsp;&lt;ui:font&gt;</h3></div></div></div><p>Acts as <span class="emphasis"><em>&lt;font&gt;</em></span> HTML tag.</p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>face</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The font face of the font.</td></tr><tr><td>color</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The color of the font.</td></tr></tbody></table></div><p>
      </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6314"></a>4.9.4.&nbsp;&lt;ui:style&gt;</h3></div></div></div><p>Sets a CSS class for the tag content, acts as a
      <span class="emphasis"><em>&lt;span&gt;</em></span> HTML tag with the
      <span class="emphasis"><em>class</em></span> atribute set.</p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>styleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>CSS class for tag.</td></tr></tbody></table></div><p>
      </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6352"></a>4.9.5.&nbsp;&lt;ui:newline&gt;</h3></div></div></div><p>Puts a visual new line (<code class="literal">&lt;br/&gt;</code>).</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tooltiphtmltag"></a>4.9.6.&nbsp;&lt;ui:tooltip&gt;</h3></div></div></div><p>Defines tooltip that is shown when web application user hovers mouse over element to which the tooltip is attached.</p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>element</td><td>
                  <span class="emphasis"><em>yes</em></span>
                </td><td>HTML id of DOM element that is target of the tooltip.</td></tr><tr><td>text</td><td>
                  <span class="emphasis"><em>yes</em></span>
                </td><td>Tooltip content.</td></tr><tr><td>options</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Options for tooltip (including tooltip classname, title, etc -- see prototip.js for details).</td></tr></tbody></table></div><p>
      </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6412"></a>4.9.7.&nbsp;&lt;ui:basicButton&gt;</h3></div></div></div><p>Represents an HTML form button.</p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>renderMode</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Allowed values are (button | input) - the corresponding
                HTML tag will be used for rendering. Default is
                button.</td></tr><tr><td>id</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Button id, allows to access button from
                JavaScript.</td></tr><tr><td>labelId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Id of button label.</td></tr><tr><td>onclick</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td><code class="literal">onClick</code> Javascript action.</td></tr><tr><td>styleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>CSS class for button.</td></tr><tr><td>style</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Inline CSS style for button.</td></tr></tbody></table></div><p>
      </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6496"></a>4.9.8.&nbsp;&lt;ui:basicLinkButton&gt;</h3></div></div></div><p>Represents a link with an onClick JavaScript action.</p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>id</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Button id, allows to access button from
                JavaScript.</td></tr><tr><td>styleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>CSS class for tag.</td></tr><tr><td>style</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Inline CSS style for tag.</td></tr><tr><td>onclick</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td><code class="literal">onClick</code> Javascript action.</td></tr><tr><td>labelId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Id of button label.</td></tr></tbody></table></div><p>
      </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6570"></a>4.9.9.&nbsp;&lt;ui:link&gt;</h3></div></div></div><p>Usual HTML link, acts as a <span class="emphasis"><em>&lt;a&gt;</em></span> HTML
      tag.</p><p>
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>disabledStyleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>CSS class for disabled link.</td></tr><tr><td>id</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Link id, allows to access link from JavaScript.</td></tr><tr><td>href</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Link target URL.</td></tr><tr><td>target</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Link target, same as <span class="emphasis"><em>&lt;a&gt;</em></span>
                HTML tag <span class="emphasis"><em>target</em></span> attribute.</td></tr><tr><td>disabled</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Controls whether the link is disabled, disabled link
                doesn't link anywhere.</td></tr><tr><td>styleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>CSS class for tag.</td></tr><tr><td>style</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Inline CSS style for tag.</td></tr></tbody></table></div><p>
      </p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6671"></a>4.10.&nbsp;Programming JSPs without HTML</h2></div></div></div><p>Aranea standard tag library should mostly be enough to shelter
    end-users from the need to write HTML inside JSPs. Snippets of HTML are
    alright but using it too often tends to lead to inflexible UI; instead of
    embedding HTML in JSPs custom tags should be written if the need
    arises.</p><p>When writing JSPs without embedded HTML, programmers best friends
    are <span class="emphasis"><em>styleClass</em></span> attributes of presentation tags,
    allowing tuning of tag appearances and <span class="emphasis"><em>layout</em></span>
    tags.</p><p>Layout tags are tags extending <code class="literal">BaseLayoutTag</code>.
    Layout tags allow placing of rows inside them (and rows allow using of
    cells inside). Standard layout tag (&lt;ui:layout&gt;) outputs HTML
    <span class="emphasis"><em>table</em></span>, and standard row and cell tags output HTML
    <span class="emphasis"><em>tr</em></span> and <span class="emphasis"><em>td</em></span> tags, respectively.
    This is by no means a requirement for layout tags&#8212;there are probably ways
    to achieve the same behaviour with correctly styled HTML
    <span class="emphasis"><em>div</em></span> tags; but the tables should do just fine for
    majority of needs.</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6701"></a>4.11.&nbsp;Customizing Tag Styles</h2></div></div></div><p>Presentation tags (tags extending <code class="literal">PresentationTag</code>
    or implementing <code class="literal">StyledTagInterface</code>) have attribute
    <code class="literal">styleClass</code> that specifies the CSS style class used for
    rendering the tag. When <code class="literal">styleClass</code> attribute for tag is
    not specified, some default style bundled with Aranea is used; or in some
    cases no HTML <code class="literal">class</code> attribute is output at all&#8212;allowing
    cascading styles from some parent (HTML) tag to take over the
    presentation.</p><p>Presentation tags also have <code class="literal">style</code> attribute for
    specifying inline style for tag. Using it is discouraged&#8212;tweaking style
    classes to fit ones specific needs is highly recommended.</p><p>Some tags may have more than one attributes for defining tag style.
    For example <code class="literal">&lt;ui:layout&gt;</code> tag and other layout tags
    that extend <code class="literal">LayoutHtmlTag</code> or
    <code class="literal">BaseLayoutTag</code> have attributes
    <code class="literal">rowClasses</code> and <code class="literal">cellClasses</code> that
    specify the default styles for <code class="literal">&lt;ui:row&gt;</code> and
    <code class="literal">&lt;ui:cell&gt;</code> tags used within the layout. These can
    be overriden with row and cell own <code class="literal">styleClass</code>
    attribute.</p><p>To actually use new style(s) for some tag one often can just write a
    new CSS style (i.e. <code class="literal">"somestyle { background: #ffc; color: #900;
    text-decoration: none; }"</code>)&#8212;apply that and be done with it. For
    more complicated tags, one may need to take a quick peek at tag source
    code to see what HTML tags are output and design their styles accordingly.
    Most of the time that should not be necessary.</p><p>Changing default tag styles can be done in two ways&#8212;modifying CSS
    files or extending the tag one wants to customize with dynamic initializer
    like this:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax11">{</span>
    styleClass <span class="syntax11">=</span> <span class="syntax3">"some-wanted-style"</span>;
<span class="syntax11">}</span>
</span></pre></pre><p>needless to say, first method is very much preferred because
    creating custom tags just for changing tag styles is quite
    pointless.</p><p>There is also a <code class="literal">renderMode</code> attribute; in current
    tag library there are very few tags supporting this attribute. One of
    those is <code class="literal">ButtonHtmlTag</code>
    (<code class="literal">&lt;ui:basicButton&gt;</code>)&#8212;its renderMode should have
    value <code class="literal">"input"</code> or <code class="literal">"button"</code> (default)
    and it specifies whether the button should be rendered in HTML with
    <code class="literal">&lt;input type=button ... &gt;</code> or <code class="literal">&lt;button
    ... &gt;</code> tag. In the future, number of JSP tags having
    renderMode attribute will probably increase (this can be used to get rid
    of multiple JSP tags for rendering different types of (multi)selects,
    inputs and displays).</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6786"></a>Attributes defining tag styles</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Applicable to:</th></tr></thead><tbody><tr><td>style</td><td>Inline CSS style applied to tag. Avoid.</td><td>Presentation tags.</td></tr><tr><td>styleClass</td><td>CSS class applied to tag.</td><td>Presentation tags.</td></tr><tr><td>rowClass</td><td>CSS class applied to rows inside the tag.</td><td>Layout tags.</td></tr><tr><td>cellClass</td><td>CSS class applied to cells inside the tag.</td><td>Layout tags, row tags.</td></tr><tr><td>renderMode</td><td>Defines the renderMode used for rendering the
              tag.</td><td><code class="literal">&lt;ui:basicButton&gt;</code>,
              <code class="literal">&lt;ui:eventButton&gt;</code>,
              <code class="literal">&lt;ui:button&gt;</code>.</td></tr></tbody></table></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e6846"></a>4.12.&nbsp;Making New JSP Tags</h2></div></div></div>

     JSP tags are very application specific, need for additional or modified JSP tags arises quite often. Due to presentational nature of HTML and Javascript, extending the tags that really output HTML instead of providing some information to subtags is messy. We look here at some more general tags and contracts that should be followed when writing Aranea JSP tags. 

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6850"></a>4.12.1.&nbsp;Utilities and base classes</h3></div></div></div><p>Custom tags should extend at least
      <span class="emphasis"><em>org.araneaframework.jsp.tag.BaseTag</em></span> that provides
      methods for registering subtags, manipulation of pagecontext and
      attribute evaluation. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax7">import</span> java.io.Writer;
<span class="syntax7">import</span> org.araneaframework.jsp.tag.entity.NbspEntityHtmlTag;
<span class="syntax7">import</span> org.araneaframework.jsp.util.JspUtil;

<span class="syntax6">public</span> <span class="syntax8">class</span> DummyTag <span class="syntax6">extends</span> BaseTag <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax6">static</span> String KEY <span class="syntax11">=</span> <span class="syntax3">"org.araneaframework.jsp.tag.DummyTag"</span>;
  
  BaseTag subTag;
  
  @Override
  <span class="syntax6">protected</span> <span class="syntax8">int</span> <span class="syntax9">doStartTag</span>(Writer out) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax8">int</span> result <span class="syntax11">=</span> <span class="syntax4">super</span>.<span class="syntax9">doStartTag</span>(out);

    <span class="syntax1">// make this tag implementation accessible to subtags which </span>
    <span class="syntax1">// is quite pointless since this tag does not implement any useful interface.</span>
    <span class="syntax1">// it demonstrates Aranea JSP convention for providing info to subtags</span>
    <span class="syntax9">addContextEntry</span>(KEY, <span class="syntax4">this</span>);
    
    <span class="syntax1">// write some real output that ends up at the served web page</span>
    JspUtil.<span class="syntax9">writeOpenStartTag</span>(out, <span class="syntax3">"div"</span>);
    JspUtil.<span class="syntax9">writeAttribute</span>(out, <span class="syntax3">"id"</span>, <span class="syntax3">"dummyDivId"</span>);
    JspUtil.<span class="syntax9">writeCloseStartTag</span>(out);
    
    <span class="syntax1">// it is possible to register in JAVA code too, this one just writes out nbsp entity.</span>
    subTag <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">NbspEntityHtmlTag</span>();
    <span class="syntax9">registerSubtag</span>(subTag);
    <span class="syntax9">executeStartSubtag</span>(subTag);
    
    <span class="syntax6">return</span> result;
  <span class="syntax11">}</span>

  @Override
  <span class="syntax6">protected</span> <span class="syntax8">int</span> <span class="syntax9">doEndTag</span>(Writer out) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax9">executeEndTagAndUnregister</span>(subTag);
    
    JspUtil.<span class="syntax9">writeEndTag</span>(out, <span class="syntax3">"div"</span>);
    
    <span class="syntax6">return</span> <span class="syntax4">super</span>.<span class="syntax9">doEndTag</span>(out);
    <span class="syntax1">// Now everything about this tag ceases to exist, </span>
    <span class="syntax1">// context entries are removed, souls are purged.</span>
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p><code class="literal">org.araneaframework.jsp.util.JspUtil</code> that was
      used here is an utility class containing some functions for writing out
      (XML) tags with somewhat less room for errors than just
      <code class="literal">out.write()</code>. Other notable methods provided by
      <code class="literal">BaseTag</code> are <code class="literal">getOutputData()</code> that
      returns response data, <code class="literal">getConfiguration()</code> and
      <code class="literal">getLocalizationContext()</code>. For tags with attributes,
      attribute evaluation functions that support <span class="emphasis"><em>Expression
      Language (EL)</em></span> expressions are provided in
      <code class="literal">BaseTag</code>. Typical usage of these functions is
      following: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setWidth</span>(String width) <span class="syntax6">throws</span> JspException <span class="syntax11">{</span>
  <span class="syntax4">this</span>.width <span class="syntax11">=</span> (String)<span class="syntax9">evaluate</span>(<span class="syntax3">"width"</span>, width, String.<span class="syntax8">class</span>);
<span class="syntax11">}</span>
</span></pre></pre><p>Another common base tag for tags that output real HTML is
      <code class="literal">org.araneaframework.jsp.PresentationTag</code>. The
      <code class="literal">DummyTag</code> should really extend it too, since it
      outputs some HTML. <code class="literal">PresentationTag</code> defines
      <span class="emphasis"><em>style</em></span> and <span class="emphasis"><em>styleClass</em></span>
      attributes that can be applied to most HTML tags.</p><p>Important tag cleanup method is <code class="literal">doFinally()</code>
      that is called after rendering. It should be used to clear references to
      objects that should no longer be referenced after rendering. As in
      containers tag instances can live very long time, they can leak quite a
      lot of memory unless resources are deallocated.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tagattributeinheritance"></a>4.12.2.&nbsp;Inheriting tag attributes from base tags.</h3></div></div></div><p>
      	Custom tags extending Aranea tags are able to accept all supertag attributes,
      	but these must be also defined in TLD, otherwise the JSP containers
      	will complain. As some base tags may be abstract, information about
      	their attributes cannot be deduced from Aranea JSP standard TLD. 
      	To address this problem, Aranea distribution does the following: 
      	aranea.jar and aranea-jsp.jar include the file META-INF/aranea-standard.tcd
      	(<span class="emphasis"><em>TCD</em></span> stands for <span class="emphasis"><em>Tag Class Descriptor</em></span>)
      	which includes the attribute information for all Aranea Standard JSP classes.
      	To make use of this information, one first generates TLD for custom tag classes and then
      	merges the TCD information into it. It is done with <code class="literal">org.araneaframework.buildutil.TcdAndTldMerger</code>
      	utility included in aranea.jar (since 1.0.10, previously it had to be compiled separately after downloading distribution).
      	All custom compiled tag classes as well as Aranea JSP tag classes must be available on classpath when using this utility.
      </p><p>
        Example of using the <code class="literal">TcdAndTldMerger</code> utility:
      </p><p>
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">target name</span>=<span class="syntax3">"tld"</span><span class="syntax10">&gt;</span>
  <span class="syntax1">&lt;!-- generate TLD without parent attribute information --&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">webdoclet destdir</span>=<span class="syntax3">"somedir"</span><span class="syntax10"> force</span>=<span class="syntax3">"false"</span><span class="syntax10"> </span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">fileset dir</span>=<span class="syntax3">"${src.dir}"</span><span class="syntax10"> includes</span>=<span class="syntax3">"**/*Tag.java"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>

    <span class="syntax10">&lt;</span><span class="syntax10">jsptaglib validatexml</span>=<span class="syntax3">"true"</span>
<span class="syntax10">      shortName</span>=<span class="syntax3">"shortName"</span>
<span class="syntax10">      filename</span>=<span class="syntax3">"filename.tld"</span>
<span class="syntax10">      uri</span>=<span class="syntax3">"customuri"</span>
<span class="syntax10">      description</span>=<span class="syntax3">"description"</span>
<span class="syntax10">    /</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/webdoclet</span><span class="syntax10">&gt;</span>

  <span class="syntax1">&lt;!-- invoke the TcdAndTldMerger utility --&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">java classname</span>=<span class="syntax3">"org.araneaframework.buildutil.TcdAndTldMerger"</span><span class="syntax10"> fork</span>=<span class="syntax3">"true"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">arg value</span>=<span class="syntax3">"META-INF/aranea-standard.tcd"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>    <span class="syntax1">&lt;!-- Tag class descriptor to merge with --&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">arg value</span>=<span class="syntax3">"somedir/filename.tld"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>            <span class="syntax1">&lt;!-- Source TLD --&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">arg value</span>=<span class="syntax3">"somedir/filename.tld"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>            <span class="syntax1">&lt;!-- Destination TLD --&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">classpath</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">path refid</span>=<span class="syntax3">"araneaclasspath"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">path refid</span>=<span class="syntax3">"compiledcustomtagclasses"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">path refid</span>=<span class="syntax3">"varia"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/classpath</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/java</span><span class="syntax10">&gt;</span>

<span class="syntax10">&lt;</span><span class="syntax10">/target</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
      </p><p>
      When running given target, one should see messages similar to following:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax12">8</span> attributes <span class="syntax6">for</span> <span class="syntax3">'custom.RandomTag'</span> found from <span class="syntax3">'org.araneaframework.jsp.tag.presentation.PresentationTag'</span>.
</span></pre></pre><p>
</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6938"></a>4.12.3.&nbsp;Widgets and events</h3></div></div></div><p>Sending events to widgets is accomplished with javascript submit
      functions, helpful utility being
      <code class="literal">org.araneaframework.jsp.util.JspUtil</code> and
      <code class="literal">org.araneaframework.jsp.util.JspWidgetCallUtil</code>. First
      one would construct <code class="literal">org.araneaframework.jsp.UiEvent</code>
      and (in case of HTML element which receives only one event) calls
      <code class="literal">JspUtil.writeEventAttributes(Writer out, UiEvent
      event)</code> and afterwards
      <code class="literal">writeSubmitScriptForEvent(Writer out, String
      attributeName)</code>. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax1">//public UiEvent(String eventId, String eventTargetWidget, String eventParameter)</span>
UiEvent event <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">UiEvent</span>(<span class="syntax3">"hello"</span>, <span class="syntax3">"contextWidgetId"</span>, <span class="syntax3">"name"</span>);
<span class="syntax1">// long way to ouput custom attributes version</span>
JspUtil.<span class="syntax9">writeEventAttributes</span>(out, event);
JspWidgetCallUtil.<span class="syntax9">writeSubmitScriptForEvent</span>(out, attributeName);
<span class="syntax1">// short version</span>
JspWidgetCallUtil.<span class="syntax9">writeSubmitScriptForEvent</span>(out, <span class="syntax3">"onclick"</span>, event);

<span class="syntax1">// both will output something like this:</span>
    <span class="syntax1">// arn-evntId="hello" </span>
    <span class="syntax1">// arn-trgtwdgt="contextWidgetId" </span>
    <span class="syntax1">// arn-evntPar="name" </span>
    <span class="syntax1">// onclick="return _ap.event(this);"</span>
</span></pre></pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6960"></a>4.12.4.&nbsp;Layouts</h3></div></div></div><p>New layouts are mostly concerned with styles or render layouts
      with some additional tags instead plain <code class="literal">table, tr,
      td</code>. As simple example, we define a layout that applies a class
      "error" to cells which contain invalid <code class="literal">FormElement</code>.
      Note that approach we use only works when cell tag is aware of the
      surrounding <code class="literal">FormElement</code> at the moment of rendering,
      meaning that <code class="literal">FormElement</code> is rendered in JSP something
      like this:</p><p>
        </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"someId"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:label/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>

    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
...
</span></pre></pre><p>
      </p><p>What is needed foremost is a decorator for cells that are used
      inside invalid <code class="literal">FormElement</code>. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> ErrorMarkingCellClassProviderDecorator <span class="syntax6">implements</span> CellClassProvider <span class="syntax11">{</span>
  <span class="syntax6">protected</span> CellClassProvider superProvider;
  <span class="syntax6">protected</span> PageContext pageContext;

  <span class="syntax1">// constructs a decorator for superProvider, makes pageContext accessible</span>
  <span class="syntax6">public</span> <span class="syntax9">ErrorMarkingCellClassProviderDecorator</span>(CellClassProvider superProvider, PageContext pageContext) <span class="syntax11">{</span>
    <span class="syntax4">this</span>.superProvider <span class="syntax11">=</span> superProvider;
    <span class="syntax4">this</span>.pageContext <span class="syntax11">=</span> pageContext;
  <span class="syntax11">}</span>

  <span class="syntax6">public</span> String <span class="syntax9">getCellClass</span>() <span class="syntax6">throws</span> JspException <span class="syntax11">{</span>
    FormElement.ViewModel formElementViewModel <span class="syntax11">=</span> (FormElement.ViewModel)
      pageContext.<span class="syntax9">getAttribute</span>(FormElementTag.VIEW_MODEL_KEY, PageContext.REQUEST_SCOPE);
    <span class="syntax1">// superProvider.getCellClass() may only be called once, otherwise moves on to next cell's style</span>
    String superClass <span class="syntax11">=</span> superProvider.<span class="syntax9">getCellClass</span>();

    <span class="syntax6">if</span> (formElementViewModel <span class="syntax11">!=</span> <span class="syntax4">null</span> <span class="syntax11">&amp;&amp;</span> <span class="syntax11">!</span>formElementViewModel.<span class="syntax9">isValid</span>()) <span class="syntax11">{</span>
      <span class="syntax6">if</span> (superClass <span class="syntax11">!=</span> <span class="syntax4">null</span>)
        <span class="syntax6">return</span> superClass <span class="syntax11">+</span> <span class="syntax3">" error"</span>;
      <span class="syntax6">else</span>
        <span class="syntax6">return</span> <span class="syntax3">"error"</span>;
    <span class="syntax11">}</span>

    <span class="syntax6">return</span> superClass;
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>Actual layout tag that decorates its cells according to described
      logic: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> CustomLayoutTag <span class="syntax6">extends</span> LayoutHtmlTag <span class="syntax11">{</span>
  <span class="syntax6">protected</span> <span class="syntax8">int</span> <span class="syntax9">doStartTag</span>(Writer out) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax8">int</span> result <span class="syntax11">=</span> <span class="syntax4">super</span>.<span class="syntax9">doStartTag</span>(out);
    <span class="syntax9">addContextEntry</span>(CellClassProvider.KEY, <span class="syntax6">new</span> <span class="syntax9">ErrorMarkingCellClassProviderDecorator</span>(<span class="syntax4">this</span>, pageContext));

    <span class="syntax6">return</span> result;
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="forms"></a>Chapter&nbsp;5.&nbsp;Forms and Data Binding</h2></div></div></div><p>One of the most common tasks in web applications is gathering user
  input, converting it to model objects and then validating it. This is
  typically referred to as <span class="emphasis"><em>data binding</em></span> and every major
  web framework has support for this activity. In this chapter we will
  introduce the widgets and supporting API that implement this tasks.</p><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e7002"></a>5.1.&nbsp;Forms</h2></div></div></div><p>Unlike many other frameworks, in Aranea request processing,
    validating and data binding is not a separate part of the framework, but
    just another component. Specially it is widget
    <code class="literal">org.araneaframework.uilib.form.FormWidget</code> and some
    support widgets. A typical form is shown on <a href="#person-form" title="Figure&nbsp;5.1.&nbsp;Form example">Figure&nbsp;5.1, &#8220;Form example&#8221;</a>.</p><div class="figure"><a name="person-form"></a><div class="mediaobject"><img src="../images/form.png" alt="Form example"></div><p class="title"><b>Figure&nbsp;5.1.&nbsp;Form example</b></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7018"></a>5.1.1.&nbsp;FormWidget</h3></div></div></div><p>Let's say we have a <code class="literal">Person</code> model JavaBean that
      looks like this:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> Person <span class="syntax11">{</span>
  <span class="syntax6">private</span> Long id;
  <span class="syntax6">private</span> String name;
  <span class="syntax6">private</span> String surname;   
  <span class="syntax6">private</span> String phone;

  <span class="syntax6">public</span> Long <span class="syntax9">getId</span>() <span class="syntax11">{</span><span class="syntax6">return</span> id;<span class="syntax11">}</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setId</span>(Long id) <span class="syntax11">{</span><span class="syntax4">this</span>.id <span class="syntax11">=</span> id;<span class="syntax11">}</span>
  
  <span class="syntax6">public</span> String <span class="syntax9">getName</span>() <span class="syntax11">{</span><span class="syntax6">return</span> name;<span class="syntax11">}</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setName</span>(String name) <span class="syntax11">{</span><span class="syntax4">this</span>.name <span class="syntax11">=</span> name;<span class="syntax11">}</span>
  
  <span class="syntax6">public</span> String <span class="syntax9">getSurname</span>() <span class="syntax11">{</span><span class="syntax6">return</span> surname;<span class="syntax11">}</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setSurname</span>(String surname) <span class="syntax11">{</span><span class="syntax4">this</span>.surname <span class="syntax11">=</span> surname;<span class="syntax11">}</span>
  
  <span class="syntax6">public</span> String <span class="syntax9">getPhone</span>() <span class="syntax11">{</span><span class="syntax6">return</span> phone;<span class="syntax11">}</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setPhone</span>(String phone) <span class="syntax11">{</span><span class="syntax4">this</span>.phone <span class="syntax11">=</span> phone;<span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>A typical form will be created and used like this:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> BeanFormWidget personForm;
<span class="syntax6">private</span> Person person;
...
<span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax11">{</span>
  ...
  personForm <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BeanFormWidget</span>(Person.<span class="syntax8">class</span>);
  <span class="syntax9">addWidget</span>(<span class="syntax3">"personForm"</span>, personForm);

  personForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"name"</span>, <span class="syntax3">"#Name"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(<span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">3</span>), <span class="syntax4">null</span>), <span class="syntax4">true</span>);
  personForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"surname"</span>, <span class="syntax3">"#Last name"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">true</span>);
  personForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"#Phone no"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">true</span>);
  ...
  person <span class="syntax11">=</span> <span class="syntax9">lookupPersonService</span>().<span class="syntax9">getSomePerson</span>();
  personForm.<span class="syntax9">readFromBean</span>(person);
  ...
<span class="syntax11">}</span>
...
</span></pre></pre><p>Note that here we basically do three things: </p><div class="variablelist"><dl><dt><span class="term">Create and register the form</span></dt><dd>
               The line 

              <code class="literal">new BeanFormWidget(Person.class)</code>

               creates a new form widget that is associated with the 

              <span class="emphasis"><em>JavaBean</em></span>

               model class 

              <code class="literal">Person</code>

              . The line 

              <code class="literal">addWidget("personForm", personForm)</code>

               initializes and registers the form allowing it to function. 
            </dd><dt><span class="term">Add form fields</span></dt><dd>
               The line 

              <code class="literal">personForm.addBeanElement("name", "#Name", new
              TextControl(new Long(3), null), true)</code>

               adds an element associated with the JavaBean property "name" (this is also the identifier of the field), with a label "Name" (labels in Aranea are localizable by default and "#" escapes a non-localizable string), a text box control with a minimal length of 3 and that is mandatory. 
            </dd><dt><span class="term">Write JavaBean</span></dt><dd>
               The line 

              <code class="literal">personForm.readFromBean(person)</code>

               reads the data from JavaBean properties to the corresponding form fields. 
            </dd></dl></div><p>Now that we have created the form we show how to process events,
      validate and read the request data. The following example code should be
      in the same widget as the previous:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> <span class="syntax8">void</span> <span class="syntax9">handleEventSave</span>() <span class="syntax11">{</span>
  <span class="syntax6">if</span> (personForm.<span class="syntax9">convertAndValidate</span>()) <span class="syntax11">{</span>
   personForm.<span class="syntax9">writeToBean</span>(person);
   ...
   <span class="syntax9">lookupPersonService</span>()().<span class="syntax9">savePerson</span>(person);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
...
</span></pre></pre><p>This code will execute if an event "save" comes and will do the
      following: </p><div class="itemizedlist"><ul type="disc" compact><li>
             Convert the request data to the JavaBean types and validate it according to the rules specified in controls (e.g. minimal length). Wrapping event body in 

            <code class="literal">if (personForm.convertAndValidate()) {...}</code>

             is a generic idiom in Aranea as we believe that explicitly leads to flexibility. By default the values will be just read from request without any parsing, conversion or validation and the latter will be done only after the 

            <code class="literal">convertAndValidate()</code>

             call. This allows for example to validate only a subform or even one element, by calling only their 

            <code class="literal">convertAndValidate()</code>

             method. 
          </li><li>
             Read the 

            <code class="literal">person</code>

             object from the form, filling it in with the user data. Note that the same object that was originally read from the business layer is used here and forms take care of merging the new data and preserving the old. 
          </li></ul></div><p>Note the use of the <code class="literal">getValueByFullName()</code>
      method. Form API contains several such methods (named
      <code class="literal">*ByFullName()</code>), which allow to access fields,
      controls and values using full dot-separated element names.</p><p>If you have a composite JavaBean (containing other JavaBeans) you
      may want to create a form with a similar structure. Let's say that our
      <code class="literal">Person</code> bean contains an <code class="literal">Address</code>
      under "address" JavaBean property:</p><pre class="programlisting"><pre><span class="syntax0">...
personForm <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BeanFormWidget</span>(Person.<span class="syntax8">class</span>);
<span class="syntax9">addWidget</span>(<span class="syntax3">"personForm"</span>, personForm);
...
BeanFormWidget addrForm <span class="syntax11">=</span> personForm.<span class="syntax9">addBeanSubForm</span>(<span class="syntax3">"address"</span>);
addrForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"postalCode"</span>, <span class="syntax3">"#Postal code"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">true</span>);
addrForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"street"</span>, <span class="syntax3">"#Street"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">true</span>);
...
</span></pre></pre><p>Note that the fields will be available from the main form using a
      dot-separated name, e.g. <code class="literal">String street = (String)
      personForm.getValueByFullName("address.street")</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7114"></a>5.1.2.&nbsp;Controls</h3></div></div></div><p>At the core of the data binding API lies the notion of
      <span class="emphasis"><em>controls</em></span>
      (<code class="literal">org.araneaframework.uilib.form.Control</code>). Controls
      are the widgets that do the actual parsing of the request parameters and
      correspond to the controls found in HTML forms, like textbox, textarea,
      selectbox, button, ... Additionally controls also do a bit of validating
      the submitted data. For example textbox control validates the minimum
      and maximum string length, since the HTML tag can do the same.
      Programmer usually does not read values from <code class="literal">Control</code>
      directly, but from <code class="literal">FormElement</code> that takes care of
      converting value of <code class="literal">Control</code> to
      <code class="literal">FormElement</code> <code class="literal">Data</code>.</p><p>The following example shows how to create a control:</p><pre class="programlisting"><pre><span class="syntax0">...
TextControl textBox <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(<span class="syntax6">new</span> <span class="syntax9">Long</span>(<span class="syntax12">10</span>), <span class="syntax4">null</span>);
...
</span></pre></pre><p>This code will create a textbox with a minimal length of 10. Note
      that this code does not yet put the control to work, as controls are
      never used without forms, which are reviewed in the next section.</p><p>Follows a table of standard controls all found in
      <code class="literal">org.araneaframework.uilib.form.control</code> package:
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Control</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">ButtonControl</code></td><td>A control that represents a HTML form button.</td></tr><tr><td><code class="literal">CheckboxControl</code></td><td>A control that represents a binary choice and is
                usually rendered as a checkbox.</td></tr><tr><td><code class="literal">DateControl</code></td><td>A date selection control that allows to choose a date.
                Supports custom formats of date input and output.</td></tr><tr><td><code class="literal">DateTimeControl</code></td><td>A date and time selection control that allows to choose
                a date with a corresponding time. Supports custom formats of
                date and time input and output.</td></tr><tr><td><code class="literal">DisplayControl</code></td><td>A control that can be used to render a read-only value
                that will not be submitted with an HTML form.</td></tr><tr><td><code class="literal">FileUploadControl</code></td><td>A control that can be used to upload files to the
                server.</td></tr><tr><td><code class="literal">FloatControl</code></td><td>A textbox control that constrains the text to be
                floating-point numbers. Can also check the allowed minimum and
                maximum limits.</td></tr><tr><td><code class="literal">HiddenControl</code></td><td>A control that can be used to render an invisible value
                that will be submitted with an HTML form.</td></tr><tr><td><code class="literal">JodaDateControl</code></td><td>A date selection control that allows to choose a date.
                Supports custom formats of date input and output. The data is stored and returned as
                <code class="literal">org.joda.time.DateTime</code>.</td></tr><tr><td><code class="literal">JodaDateTimeControl</code></td><td>A date and time selection control that allows to choose
                a date with a corresponding time. Supports custom formats of
                date and time input and output. The data is stored and returned as
                <code class="literal">org.joda.time.DateTime</code>.</td></tr><tr><td><code class="literal">JodaTimeControl</code></td><td>A time selection control that allows to choose a time
                of day. Supports custom formats of time input and output. The
                data is stored and returned as <code class="literal">org.joda.time.DateTime</code>.</td></tr><tr><td><code class="literal">NumberControl</code></td><td>A textbox control that constrains the text to be
                integer numbers. Can also check the allowed minimum and
                maximum limits.</td></tr><tr><td><code class="literal">TimeControl</code></td><td>A time selection control that allows to choose a time
                of day. Supports custom formats of time input and
                output.</td></tr><tr><td><code class="literal">TextareaControl</code></td><td>A multirow textbox control that can constrain the
                inserted text minimal and maximal length.</td></tr><tr><td><code class="literal">TextControl</code></td><td>A simple textbox control with one row of text that can
                constrain the inserted text minimal and maximal
                length.</td></tr><tr><td><code class="literal">AutoCompleteTextControl</code></td><td><code class="literal">TextControl</code> with autocompletion
                capability.</td></tr><tr><td><code class="literal">TimestampControl</code></td><td>Similar to <code class="literal">DateControl</code> but works
                with <code class="literal">java.sql.TimeStamp</code>.</td></tr><tr><td><code class="literal">SelectControl</code></td><td>A control that allows to select one of many choices
                (may be rendered as a dropdown list or option buttons).
                Ensures that the submitted value was one of the
                choices.</td></tr><tr><td><code class="literal">MultiSelectControl</code></td><td>A control that allows to select several from many
                choices (may be rendered as a multiselect list or checkbox
                list). Ensures that the submitted values are a subset of the
                choices.</td></tr></tbody></table></div><p><code class="literal">SelectControl</code> and
      <code class="literal">MultiSelectControl</code> deserve a special mention, as they
      need a bit more handling than the rest. The difference comes from the
      fact that we also need to handle the selectable options, which we refer
      to as <code class="literal">DisplayItem</code>. Each
      <code class="literal">DisplayItem</code> has a label, a string value and can be
      disabled. Disabled display items cannot be selected in neither select
      box nor multiselect box.</p><p>Both <code class="literal">SelectControl</code> and
      <code class="literal">MultiSelectControl</code> implement the
      <code class="literal">DisplayItemContainer</code> interface that allows to
      manipulate the <code class="literal">DisplayItem</code>:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">interface</span> DisplayItemContainer <span class="syntax11">{</span>
  <span class="syntax8">void</span> <span class="syntax9">addItem</span>(DisplayItem item);
  <span class="syntax8">void</span> <span class="syntax9">addItems</span>(Collection items);
  <span class="syntax8">void</span> <span class="syntax9">clearItems</span>();
  List <span class="syntax9">getDisplayItems</span>();
  <span class="syntax8">int</span> <span class="syntax9">getValueIndex</span>(String value);
<span class="syntax11">}</span>
</span></pre></pre><p>In addition to this interface we also provide a
      <code class="literal">DisplayItemUtil</code> that provides some support methods on
      display items. These include the method
      <code class="literal">addItemsFromBeanCollection</code> that allows to add the
      items to a (multi)select control from a business method returning a
      collection of model JavaBean objects (which is one of the most common
      use cases). So a typical select control will be filled as
      follows:</p><pre class="programlisting"><pre><span class="syntax0">SelectControl control <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">SelectControl</span>();
control.<span class="syntax9">addItem</span>(<span class="syntax6">new</span> <span class="syntax9">DisplayItem</span>(<span class="syntax4">null</span>, <span class="syntax3">"- choice -"</span>));
DisplayItemUtil.<span class="syntax9">addItemsFromBeanCollection</span>(
  control,
  <span class="syntax9">lookupMyService</span>().<span class="syntax9">getMyItemCollection</span>(),
  <span class="syntax3">"value"</span>,
  <span class="syntax3">"label"</span>);
</span></pre></pre><p>Controls can also listen to user events. For example
      <code class="literal">ButtonControl</code> can react to an
      <code class="literal">onClick</code> event, while most others can react to an
      <code class="literal">onChange</code> event. The only thing needed to receive the
      control events is to register an appropriate event listener:</p><pre class="programlisting"><pre><span class="syntax0">...
SelectControl selControl <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">SelectControl</span>();
FormElement selEl <span class="syntax11">=</span> form.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"clientId"</span>, <span class="syntax3">"#Client id"</span>, selControl, <span class="syntax4">true</span>);
selControl.<span class="syntax9">addOnChangeEventListener</span>(<span class="syntax6">new</span> <span class="syntax9">OnChangeEventListener</span>() <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">onChange</span>() <span class="syntax11">{</span>
    <span class="syntax1">//We convert and validate one element only as the rest of the form</span>
    <span class="syntax1">//might be invalid</span>
    <span class="syntax6">if</span> (selEl.<span class="syntax9">convertAndValidate</span>()) <span class="syntax11">{</span>
      Long clientId <span class="syntax11">=</span> (Long) selEl.<span class="syntax9">getValue</span>();
      <span class="syntax1">//Now we can use the client id to do whatever we want</span>
      <span class="syntax1">//E.g. update another select control</span>
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>
<span class="syntax11">}</span>);
...
</span></pre></pre><p><code class="literal">onChange</code> events are also produced by text boxes
      and similar, so the user input can processed right after the user has
      finished it.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7349"></a>5.1.3.&nbsp;Constraints</h3></div></div></div><p>Though controls provide some amount of validation they are limited
      only to the rules that can be controlled on the client-side. To support
      more diverse rules Aranea has
      <code class="literal">org.araneaframework.uilib.form.Constraint</code>, that
      allows to put any logical and/or business validation rules. Typically
      constraints are used as follows:</p><pre class="programlisting"><pre><span class="syntax0">...
myForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"registration"</span>, <span class="syntax3">"#Registration"</span>, <span class="syntax6">new</span> <span class="syntax9">DateControl</span>(), <span class="syntax4">true</span>);
myForm.<span class="syntax9">getElement</span>(<span class="syntax3">"registration"</span>).<span class="syntax9">setConstraint</span>(<span class="syntax6">new</span> <span class="syntax9">AfterTodayConstraint</span>(<span class="syntax4">false</span>));
...
</span></pre></pre><p>The
      <code class="literal">org.araneaframework.uilib.form.constraint.AfterTodayConstraint</code>
      makes sure that the date is today or later, with the boolean parameter
      indicating whether today is allowed. The constraint will validate if the
      form or the element in question is validated (e.g.
      <code class="literal">convertAndValidate()</code> is called) and will show an
      error message to the user, if the constraint was not satisfied. The
      error message is customizable using localization and involves the label
      of the field being validated.</p><p>The following is a more complex example that shows how to use
      constraints that apply to more than one field, and how to combine
      constraints using logical expressions:</p><pre class="programlisting"><pre><span class="syntax0">...
searchForm <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">FormWidget</span>();

<span class="syntax1">//Adding form controls</span>
searchForm.<span class="syntax9">addElement</span>(<span class="syntax3">"clientFirstName"</span>, <span class="syntax3">"#Client first name"</span>, 
  <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax6">new</span> <span class="syntax9">StringData</span>(), <span class="syntax4">false</span>);
searchForm.<span class="syntax9">addElement</span>(<span class="syntax3">"clientLastName"</span>, <span class="syntax3">"#Client last name"</span>, 
  <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax6">new</span> <span class="syntax9">StringData</span>(), <span class="syntax4">false</span>);

searchForm.<span class="syntax9">addElement</span>(<span class="syntax3">"clientAddressTown"</span>, <span class="syntax3">"#Town"</span>, 
  <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax6">new</span> <span class="syntax9">StringData</span>(), <span class="syntax4">false</span>);
searchForm.<span class="syntax9">addElement</span>(<span class="syntax3">"clientAddressStreet"</span>, <span class="syntax3">"#Street"</span>, 
  <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax6">new</span> <span class="syntax9">StringData</span>(), <span class="syntax4">false</span>);

<span class="syntax1">//First searching scenario</span>
AndConstraint clientNameConstraint <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">AndConstraint</span>();
clientNameConstraint.<span class="syntax9">addConstraint</span>(
  <span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(searchForm.<span class="syntax9">getElementByFullName</span>(<span class="syntax3">"clientFirstName"</span>)));
clientNameConstraint.<span class="syntax9">addConstraint</span>(
  <span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(searchForm.<span class="syntax9">getElementByFullName</span>(<span class="syntax3">"clientLastName"</span>)));

<span class="syntax1">//Second searching scenario</span>
AndConstraint clientAddressConstraint <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">AndConstraint</span>();
clientAddressConstraint.<span class="syntax9">addConstraint</span>(
  <span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(searchForm.<span class="syntax9">getElementByFullName</span>(<span class="syntax3">"clientAddressTown"</span>)));
clientAddressConstraint.<span class="syntax9">addConstraint</span>(
  <span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(searchForm.<span class="syntax9">getElementByFullName</span>(<span class="syntax3">"clientAddressStreet"</span>)));

<span class="syntax1">//Combining scenarios</span>
OrConstraint searchConstraint <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">OrConstraint</span>();    
searchConstraint.<span class="syntax9">addConstraint</span>(clientNameConstraint);
searchConstraint.<span class="syntax9">addConstraint</span>(clientAddressConstraint);

<span class="syntax1">//Setting custom error message</span>
searchConstraint.<span class="syntax9">setCustomErrorMessage</span>(<span class="syntax3">"Not enough data for search!"</span>);

<span class="syntax1">//Setting constraint</span>
searchForm.<span class="syntax9">setConstraint</span>(searchConstraint);

<span class="syntax1">//Putting the widget</span>
<span class="syntax9">addWidget</span>(<span class="syntax3">"searchForm"</span>, searchForm);    
...
</span></pre></pre><p>The example use case is a two scenario search&#8212;either both client
      first name and client last name fields are filled in or both town and
      street address fields are filled in, otherwise an error message "Not
      enough data for search!" is shown. The constraints will be validated
      when <code class="literal">convertAndValidate()</code> method is called on
      <code class="literal">searchForm</code>. Note that the constraint is added to the
      form itself, rather than to its elements&#8212;this is a typical idiom, when
      the constraint involves several elements.</p><p>Table of standard <code class="literal">Constraint</code>s. </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Constraint</th><th>Purpose</th></tr></thead><tbody><tr><td><code class="literal">AfterTodayConstraint</code></td><td>Field constraint, checks that field contains
                <code class="literal">Date</code> later than current date.</td></tr><tr><td><code class="literal">NotEmptyConstraint</code></td><td>Field constraint, checks that field contains non-empty
                value.</td></tr><tr><td><code class="literal">NumberInRangeConstraint</code></td><td>Field constraint, checks that number in a field belongs
                on given range (integer only).</td></tr><tr><td><code class="literal">StringLengthInRangeConstraint</code></td><td>Field constraint, checks that length of a string in a
                field falls within given boundaries.</td></tr><tr><td><code class="literal">RangeConstraint</code></td><td>Multiple field constraint, checks that value of one
                field is lower than value of other field. Field values must
                <code class="literal">Comparable</code>.</td></tr><tr><td><code class="literal">AndConstraint</code></td><td>Composite constraint, checks that all subconstraints
                are satisfied.</td></tr><tr><td><code class="literal">OrConstraint</code></td><td>Composite constraint, checks that at least one
                subconstraint is satisfied.</td></tr></tbody></table></div><p>There are two constraints that deserve a special mention. One of
      them is <code class="literal">OptionalConstraint</code> that will only let its
      subconstraint to validate the field, if the field has been submitted by
      user (it is very useful for instance when non-mandatory fields must
      nevertheless follow some pattern, whereas empty input should still be
      allowed).</p><p>The other constraint is called
      <code class="literal">GroupedConstraint</code>. It is useful in cases when
      different constraints should be activated depending on the particular
      state of the component (a typical use case is that some groups of fields
      are made mandatory in different states of document approval). The
      constraint is created using the <code class="literal">ConstraintGroupHelper</code>
      as follows:</p><pre class="programlisting"><pre><span class="syntax0">...
ConstraintGroupHelper groupHelper <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">ConstraintGroupHelper</span>();
AndConstraint andCon <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">AndConstraint</span>();
andCon.<span class="syntax9">addConstraint</span>(
  groupHelper.<span class="syntax9">createGroupedConstraint</span>(<span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(field1), <span class="syntax3">"group1"</span>));
andCon.<span class="syntax9">addConstraint</span>(
  groupHelper.<span class="syntax9">createGroupedConstraint</span>(<span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(field2), <span class="syntax3">"group1"</span>));
andCon.<span class="syntax9">addConstraint</span>(
  groupHelper.<span class="syntax9">createGroupedConstraint</span>(<span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(field3), <span class="syntax3">"group2"</span>));
andCon.<span class="syntax9">addConstraint</span>(
  groupHelper.<span class="syntax9">createGroupedConstraint</span>(<span class="syntax6">new</span> <span class="syntax9">NotEmptyConstraint</span>(field4), <span class="syntax3">"group2"</span>));
form.<span class="syntax9">setConstraint</span>(andCon);

<span class="syntax1">//Now only field1 and field2 will be required from user!</span>
groupHelper.<span class="syntax9">setActiveGroup</span>(<span class="syntax3">"group1"</span>);
...
</span></pre></pre><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7458"></a>Custom Constraints</h4></div></div></div><p>It is a very common need to validate some additional logic for a
        particular field (e.g. a field must follow some particular pattern).
        In this case it is comfortable to create a custom constraint. Most
        often the constraint is associated with one field only, so we will
        extend the <code class="literal">BaseFieldConstraint</code>, which supports this
        particular idiom:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">class</span> PersonIdentifierConstraint <span class="syntax6">extends</span> BaseFieldConstraint <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">validateConstraint</span>() <span class="syntax11">{</span>
    <span class="syntax6">if</span> (<span class="syntax11">!</span>PersonUtil.<span class="syntax9">validateIdentifier</span>(<span class="syntax9">getValue</span>()) <span class="syntax11">{</span>
      <span class="syntax9">addError</span>(<span class="syntax3">"Field '"</span> <span class="syntax11">+</span> <span class="syntax9">getLabel</span>() <span class="syntax11">+</span> <span class="syntax3">"' is not a valid personal identifier"</span>);
    <span class="syntax11">}</span>
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
...
</span></pre></pre><p>Note that we can use <code class="literal">getValue()</code> that contains
        the converted value of the field. We can also use the fields label via
        <code class="literal">getLabel()</code>. We might also want to localize the
        message and in such a case you will find
        <code class="literal">MessageUtil</code> to contain some helpful methods.</p><p>If we need to validate more than one field we should extend the
        <code class="literal">BaseConstraint</code> and take those fields into the
        constructor. In this case the developer will have to provide this
        fields to the constraint and the constraint should be added to the
        enclosing form.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7484"></a>5.1.4.&nbsp;Data</h3></div></div></div><p>The typical use of forms includes associating the form fields with
      JavaBean properties. However this is not always possible, since it is
      not feasible to make a JavaBean property for each and every form field.
      In such cases one may still want to use type conversion and data
      validation. To do that forms allow the
      <code class="literal">org.araneaframework.uilib.form.Data</code> and its
      subclasses (subclasses correspond to specific types) to be associated
      with the field:</p><pre class="programlisting"><pre><span class="syntax0">...
personForm <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BeanFormWidget</span>(Person.<span class="syntax8">class</span>);
<span class="syntax9">addWidget</span>(<span class="syntax3">"personForm"</span>, personForm);
...
personForm.<span class="syntax9">addElement</span>(<span class="syntax3">"numberOfChildren"</span>, <span class="syntax3">"#No. of chidren"</span>,
  <span class="syntax6">new</span> <span class="syntax9">NumberControl</span>(), <span class="syntax6">new</span> <span class="syntax9">LongData</span>(), <span class="syntax4">true</span>);
...
</span></pre></pre><p>In such a case one can retrieve the data directly from the
      field:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> <span class="syntax8">void</span> <span class="syntax9">handleEventSave</span>() <span class="syntax11">{</span>
  <span class="syntax6">if</span> (myForm.<span class="syntax9">convertAndValidate</span>()) <span class="syntax11">{</span>
    ...
    Long numberOfChildren <span class="syntax11">=</span> (Long) personForm.<span class="syntax9">getValueByFullName</span>(<span class="syntax3">"numberOfChildren"</span>);
    <span class="syntax1">//Alternative:</span>
    <span class="syntax1">//FormElement nocEl = (FormElement) personForm.getElement("numberOfChildren");</span>
    <span class="syntax1">//Long numberOfChildren = (Long) nocEl.getValue();</span>
    ...
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
...
</span></pre></pre><p>If there is no JavaBean to associate the form with
      <code class="literal">org.araneaframework.uilib.form.FormWidget</code> may be used
      instead of <code class="literal">BeanFormWidget</code>.</p><p>Note that the reason for existence of <code class="literal">Data</code>
      objects is that Java types correspond poorly to some restricted
      types&#8212;for instance enumerations, type encodings and collections
      container types (this problem is somewhat solved in Java 5, but Aranea
      is compatible with Java 1.3).</p><p>Table of <code class="literal">Data</code> types. </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Data</th><th>Value Type</th></tr></thead><tbody><tr><td><code class="literal">BigDecimalData</code></td><td><code class="literal">java.math.BigDecimal</code></td></tr><tr><td><code class="literal">BigDecimalListData</code></td><td><code class="literal">List
                &lt;java.math.BigDecimal</code>&gt;</td></tr><tr><td><code class="literal">BooleanData</code></td><td><code class="literal">java.lang.Boolean</code></td></tr><tr><td><code class="literal">BooleanListData</code></td><td><code class="literal">List
                &lt;java.lang.Boolean</code>&gt;</td></tr><tr><td><code class="literal">DateData</code></td><td><code class="literal">java.util.Date</code></td></tr><tr><td><code class="literal">DisplayItemListData</code></td><td><code class="literal">List
                &lt;org.araneaframework.uilib.support.DisplayItemDisplayItem</code>&gt;</td></tr><tr><td><code class="literal">FileInfoData</code></td><td><code class="literal">org.araneaframework.uilib.support.FileInfo</code></td></tr><tr><td><code class="literal">IntegerData</code></td><td><code class="literal">java.lang.Integer</code></td></tr><tr><td><code class="literal">IntegerListData</code></td><td><code class="literal">List
                &lt;java.lang.Integer</code>&gt;</td></tr><tr><td><code class="literal">LongData</code></td><td><code class="literal">java.lang.Long</code></td></tr><tr><td><code class="literal">LongListData</code></td><td><code class="literal">List &lt;java.lang.Long</code>&gt;</td></tr><tr><td><code class="literal">StringData</code></td><td><code class="literal">java.lang.String</code></td></tr><tr><td><code class="literal">StringListData</code></td><td><code class="literal">List
                &lt;java.lang.String</code>&gt;</td></tr><tr><td><code class="literal">TimestampData</code></td><td><code class="literal">java.sql.Timestamp</code></td></tr><tr><td><code class="literal">YNData</code></td><td><code class="literal">java.lang.String</code></td></tr></tbody></table></div><p>Finally <code class="literal">Data</code> constructor also accepts both a
      <code class="literal">Class</code> instance and a simple string. So if you have a
      custom datatype with an appropriate converter (see next section) you can
      just assign the data with the same type (in fact if you have your own
      converter the type doesn't matter that much, it will just allow some
      checks to be done on the programmer).</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7646"></a>5.1.5.&nbsp;Converters</h3></div></div></div><p>Converter sole purpose is conversion of values with one type to
      values of another type. Conventionally converter which
      <code class="literal">convert()</code> method accepts object of type
      <span class="emphasis"><em>A</em></span> and returns object of type <span class="emphasis"><em>B</em></span>
      is named <code class="literal">AToBConverter</code>. Converter from type
      <span class="emphasis"><em>B</em></span> to type <span class="emphasis"><em>A</em></span> is obtained with
      <code class="literal">new ReverseConverter(new AToBConverter())</code>.</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Converter <span class="syntax6">extends</span> Serializable, FormElementAware <span class="syntax11">{</span>
    <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">setFormElementCtx</span>(FormElementContext feCtx);
    <span class="syntax6">public</span> Object <span class="syntax9">convert</span>(Object data);
    <span class="syntax6">public</span> Object <span class="syntax9">reverseConvert</span>(Object data);
    <span class="syntax6">public</span> Converter <span class="syntax9">newConverter</span>();
<span class="syntax11">}</span>
</span></pre></pre><p>Converters are used internally to convert
      <code class="literal">Control</code> values to values of
      <code class="literal">FormElement</code> <code class="literal">Data</code> and vice-versa.
      Converters are usually looked up from
      <code class="literal">ConverterFactory</code>, but each
      <code class="literal">FormElement</code> can be set explicit
      <code class="literal">Converter</code> by calling
      <code class="literal">FormElement.setConverter()</code>. Direction of
      <code class="literal">Converter</code> set this way should be from
      <code class="literal">FormElement</code> <code class="literal">Control</code> value type to
      <code class="literal">FormElement</code> <code class="literal">Data</code> type.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="formvalidation"></a>5.1.6.&nbsp;Form validation</h3></div></div></div><p>
			As already mentioned, form validation is mostly explicit. By default, the values will be just read from 
			request without any parsing, conversion or validation. Validation will be performed after call to
			<code class="literal">FormWidget.convertAndValidate()</code>.
		</p><p>
			It is also possible to configure forms to be validated in the background, as end-user is filling it.
			Background validation is enabled by calling <code class="literal">FormWidget.setBackgroundValidation(true)</code>. This
			performs XMLHttp requests (using Aranea Action API) to server each time when user moves from changed form field 
			to another. Background validation takes place on server-side and is implicit.
		</p><p>
			Produced form validation error messages are rendered by active <code class="literal">FormElementValidationErrorRenderer</code>
			implementation, which adheres to these methods:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> FormElementValidationErrorRenderer <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>

  <span class="syntax8">void</span> <span class="syntax9">addError</span>(FormElement element, String error);

  <span class="syntax8">void</span> <span class="syntax9">clearErrors</span>(FormElement element);

  String <span class="syntax9">getClientRenderText</span>(FormElement element);

<span class="syntax11">}</span>
</span></pre></pre><p>
			The last method is used to provide the client-side script (together with
			<code class="literal">&lt;script&gt;...&lt;/script&gt;</code> tags) that binds its validator with the given
			form element and updates error messages inside the &lt;span&gt; element of the given form element.
		</p><p>
		  It is possible to choose between two bundled implementations &#8212;
		  <code class="literal">StandardFormElementValidationErrorRenderer</code>, which is enabled by default, and
		  <code class="literal">LocalFormElementValidationErrorRenderer</code>. The first one renders
		  <code class="literal">FormElement</code> validation errors to standard <code class="literal">MessageContext</code>.
		  The second bundled implementation renders the validation messages into the same HTML
		  <code class="literal">span</code> element as input field (using the script returned by the
		  <code class="literal">getClientRenderText(FormElement)</code> method).
		</p><p>
		   <code class="literal">FormElementValidationErrorRenderer</code> default implementation can be switched by configuring the 
		   bean representing <code class="literal">ConfigurationContext</code> (named <code class="literal">'araneaConfiguration'</code>) 
           to have entry with key '<code class="literal">uilib.widgets.forms.formelement.error.renderer</code>' value set to desired
           <code class="literal">FormElementValidationErrorRenderer</code> instance:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax10">bean id</span>=<span class="syntax3">"araneaConfiguration"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span>
<span class="syntax10">    class</span>=<span class="syntax3">"org.araneaframework.uilib.core.StandardConfiguration"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">property name</span>=<span class="syntax3">"confEntries"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">map</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">entry key</span>=<span class="syntax3">"uilib.widgets.forms.formelement.error.renderer"</span><span class="syntax10">&gt;</span>
          <span class="syntax10">&lt;</span><span class="syntax10">bean class</span>=<span class="syntax3">"org.araneaframework.uilib.form.LocalFormElementValidationErrorRenderer"</span><span class="syntax10"> singleton</span>=<span class="syntax3">"false"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/entry</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/map</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/property</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/bean</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>
		</p><p>
			For the cases where validation errors should be rendered differently for just few elements, 
			<code class="literal">FormElement.setFormElementValidationErrorRenderer()</code> method should be used.
		</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e7782"></a>5.2.&nbsp;Forms JSP Tags</h2></div></div></div><p>Form JSP tags can be divided into two categories&#8212;tags providing
    <span class="emphasis"><em>contexts</em></span> (&lt;ui:form&gt;, &lt;ui:formElement&gt;)
    and tags for <span class="emphasis"><em>rendering</em></span> form elements containing
    different controls. We will first describe the attributes that are common
    to all form element rendering tags; then proceed to explain
    <span class="emphasis"><em>context</em></span> tags and different form element rendering
    tags with their unique attributes.</p><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="common-formelement-attributes"></a>5.2.1.&nbsp;Common attributes for all form element rendering tags.</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no/yes</em></span></td><td>Id of form element to be rendered. If not specified, it
              is usually taken from current form element context (<a href="#uiFormElementTag" title="5.2.3.&nbsp;<ui:formElement&gt;">Section&nbsp;5.2.3, &#8220;&lt;ui:formElement&gt;&#8221;</a>). For few tags, it is required.</td></tr><tr><td>events</td><td><span class="emphasis"><em>no</em></span></td><td>Whether element will send events that are registered by
              server-side, <code class="literal">true</code> by default.</td></tr><tr><td>validateOnEvent</td><td><span class="emphasis"><em>no</em></span></td><td>Whether the form should be validated on the client-side
              (or by making AJAX request to server) when <span class="emphasis"><em>element
              generates an event</em></span> (this is <code class="literal">false</code>
              by default and is not supported by any default Aranea JSP
              tags).</td></tr><tr><td>tabindex</td><td><span class="emphasis"><em>no</em></span></td><td>This attribute specifies the position of the current element in the tabbing order for the current document. This value must be a number between 0 and 32767.</td></tr><tr><td>updateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Comma separated list of update regions that should be
              updated upon button receiving event. This attribute is only
              needed when using AJAX features&#8212; ordinary HTTP requests always
              update whole page.</td></tr><tr><td>globalUpdateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Comma separated list of global update regions that should
              be updated upon button receiving event. This attribute is only
              needed when using AJAX features&#8212; ordinary HTTP requests always
              update whole page.</td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>CSS class applied HTML tag(s) that are used for rendering
              element.</td></tr><tr><td>style</td><td><span class="emphasis"><em>no</em></span></td><td>Inline CSS style applied to HTML tag(s) that are used for rendering element.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7890"></a>5.2.2.&nbsp;&lt;ui:form&gt;</h3></div></div></div><p>Specifies form context for inner tags. Form view model and id are
      made accessible to inner tags as EL variables.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7895"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>Id of context form. When not specified, current form
                context is preserved (if it exists).</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7920"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>form</td><td>View model of form.</td><td align="center"><code class="literal">FormWidget.ViewModel</code></td></tr><tr><td>formId</td><td>Id of form.</td><td align="center"><code class="literal">String</code></td></tr><tr><td>formFullId</td><td>Full id of form.</td><td align="center"><code class="literal">String</code></td></tr><tr><td>formScopedFullId</td><td>Full scoped id of form.</td><td align="center"><code class="literal">String</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7969"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"loginForm"</span><span class="syntax10">&gt;</span>
    ...  <span class="syntax1">&lt;!-- formElements, formElementLabels, ... --&gt;</span> ...
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="uiFormElementTag"></a>5.2.3.&nbsp;&lt;ui:formElement&gt;</h3></div></div></div><p>Specifies form element context for inner tags. Must be surrounded
      by &lt;ui:form&gt; tag. Form element view model, id and value are made
      accessible to inner tags as EL variables.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7980"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>Id of context form element.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8005"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>formElement</td><td>View model of form element.</td><td align="center"><code class="literal">FormElement.ViewModel</code></td></tr><tr><td>formElementId</td><td>Id of form element.</td><td align="center"><code class="literal">String</code></td></tr><tr><td>formElementValue</td><td>Value currently kept inside form element.</td><td align="center"><code class="literal">Object</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8046"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"loginForm"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"username"</span><span class="syntax10">&gt;</span>
        ...
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8052"></a>5.2.4.&nbsp;&lt;ui:label&gt;</h3></div></div></div><p>Renders localizable label bound to form element. Rendered with
      HTML &lt;span&gt; and &lt;label&gt; tags.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8057"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>Id of form element which label should be rendered. If
                left unspecified, form element id from form element context is
                used.</td></tr><tr><td>showMandatory</td><td><span class="emphasis"><em>no</em></span></td><td>Indicates whether mandatory input fields label is
                marked with asterisk. Value should be <code class="literal">true</code>
                or <code class="literal">false</code>, default is
                <code class="literal">true</code></td></tr><tr><td>showColon</td><td><span class="emphasis"><em>no</em></span></td><td>Indicates whether colon is shown after the label.
                Default is <code class="literal">true</code>.</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">style</code> and <code class="literal">styleClass</code> attributes.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8117"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"loginForm"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"username"</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
                <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:label/</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8123"></a>5.2.5.&nbsp;&lt;ui:simpleLabel&gt;</h3></div></div></div><p>Renders localizable label (with HTML &lt;span&gt; and
      &lt;label&gt; tags).</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8128"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>labelId</td><td><span class="emphasis"><em>yes</em></span></td><td>ID of label to render.</td></tr><tr><td>showMandatory</td><td><span class="emphasis"><em>no</em></span></td><td>Indicates whether label is marked with asterisk. Value
                should be <code class="literal">true</code> or <code class="literal">false</code>,
                default is <code class="literal">false</code></td></tr><tr><td>showColon</td><td><span class="emphasis"><em>no</em></span></td><td>Indicates whether colon is shown after the label.
                Default is <code class="literal">true</code>.</td></tr><tr><td>for</td><td><span class="emphasis"><em>no</em></span></td><td>ID of the form element for which the label is
                created.</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">style</code> and <code class="literal">styleClass</code> attributes.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8196"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"loginForm"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:simpleLabel labelId</span>=<span class="syntax3">"username.input.label"</span><span class="syntax10"> showMandatory</span>=<span class="syntax3">"true"</span><span class="syntax10"> for</span>=<span class="syntax3">"username"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8202"></a>5.2.6.&nbsp;&lt;ui:button&gt;</h3></div></div></div><p>Renders form buttons that represent
      <code class="literal">ButtonControls</code>. Either HTML &lt;button&gt; or
      &lt;input type="button" ... &gt; will be used for rendering.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8210"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>showLabel</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Indicates whether button label is shown.Value should be
                <code class="literal">true</code> or <code class="literal">false</code>, default
                is <code class="literal">true</code></td></tr><tr><td>onClickPrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether onclick event should
                go server side or not. If left unspecified, this is considered
                to be <code class="literal">true</code>.</td></tr><tr><td>renderMode</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Allowed values are <code class="literal">button</code> and
                <code class="literal">input</code>&#8212;the corresponding HTML tag will be
                used to render the button. Default is button.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8278"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"loginForm"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:button id</span>=<span class="syntax3">"loginButton"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8284"></a>5.2.7.&nbsp;&lt;ui:linkButton&gt;</h3></div></div></div><p>Renders HTML link that represents
      <code class="literal">ButtonControl</code>. HTML &lt;a href="javascript:" ... &gt;
      tag will be used for rendering. Default
      <code class="literal">styleClass="aranea-link"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8295"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>showLabel</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Indicates whether button label is shown.Value should be
                <code class="literal">true</code> or <code class="literal">false</code>, default
                is <code class="literal">true</code></td></tr><tr><td>onClickPrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onclick
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8348"></a>5.2.8.&nbsp;&lt;ui:formKeyboardHandler&gt;</h3></div></div></div><p>Registers a simple keyboard handler. Invokes a
      <code class="literal">uiRegisterKeyboardHandler</code> javascript. This is
      basically the same stuff as &lt;ui:keyboardHandler&gt; with a few
      modifications.</p><p>There is no <code class="literal">scope</code> attribute. Instead, the tag
      assumes that it is located inside a form, and takes the full id of that
      form as its scope.</p><p>As an alternative to specifying the <code class="literal">handler</code>
      attribute, you may specify a form element and a javascript event to
      invoke on that element. You specify the element by its id relative to
      the surrounding form. The event is given as a name of the javascript
      function to be invoked on the element. For example, if you specify the
      element as "someButton", and event as "click", then when the required
      keyboard event occurs, the following javascript will be executed:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">var</span> el <span class="syntax11">=</span> document<span class="syntax11">.</span><span class="syntax9">getElementById</span>(<span class="syntax3">"&lt;form-id&gt;.someButton"</span>)<span class="syntax11">;</span>
el<span class="syntax11">.</span><span class="syntax9">click</span>()<span class="syntax11">;</span>
</span></pre></pre><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8368"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>handler</td><td><span class="emphasis"><em>no</em></span></td><td>A javascript handler function that takes two parameters
                - the event object and the element id for which the event was
                fired. Example: <code class="literal">function(event, elementId) {
                alert(elementId); } </code> Either handler or
                elementId/event pair should be specified, not both.</td></tr><tr><td>subscope</td><td><span class="emphasis"><em>no</em></span></td><td>Specifies form element which is the scope of this
                handler. By default the "scope" (as in
                <code class="literal">&lt;ui:keyboardHandlerTag&gt;</code>) of this
                keyboard handler is the form inside which the handler is
                defined. By specifying this, scope of certain element may be
                narrowed. For example if the handler is defined inside form
                "myForm", and subscope is specified as "myelement", the scope
                of the handler will be "myForm.myelement", not the default
                "myForm". The handler will therefore be active only for the
                element 'someElement'".</td></tr><tr><td>elementId</td><td><span class="emphasis"><em>no</em></span></td><td>Sets the (relative) <code class="literal">id</code> of the
                element whose javascript event should be invoked. The
                <code class="literal">id</code> is relative with respect to the
                surrounding form. Instead of this attribute, element's full id
                may be set using the <code class="literal">fullElementId</code>
                attribute, but only one of those attributes should be set at
                once.</td></tr><tr><td>fullElementId</td><td><span class="emphasis"><em>no</em></span></td><td>Sets the full <code class="literal">id</code> of the element
                whose javascript event should be invoked.</td></tr><tr><td>event</td><td><span class="emphasis"><em>no</em></span></td><td>Set the javascript event that should be invoked when
                keypress is detected&#8212;"click" and "focus" are safe for most
                controls. If target element (the one given by
                <code class="literal">elementId</code>) is a selectbox "select" may be
                used. For more, javascript reference should be consulted. This
                attribute is not foolproof and invalid javascript may be
                produced when it is not used cautiously.</td></tr><tr><td>keyCode</td><td><span class="emphasis"><em>no</em></span></td><td>Keycode to which the event must be triggered. Either
                keyCode or key must be specified, but not both.</td></tr><tr><td>key</td><td><span class="emphasis"><em>no</em></span></td><td>Key to which the event must be triggered, accepts key
                "aliases" instead of codes. Accepted aliases include
                <code class="literal">F1..F12, RETURN, ENTER, BACKSPACE, ESCAPE, TAB,
                SHIFT, CONTROL, SPACE</code>.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8465"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"loginForm"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:eventButton id</span>=<span class="syntax3">"btnLogin"</span><span class="syntax10"> eventId</span>=<span class="syntax3">"login"</span><span class="syntax10"> labelId</span>=<span class="syntax3">"button.login.enter"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formKeyboardHandler fullElementId</span>=<span class="syntax3">"btnLogin"</span><span class="syntax10"> key</span>=<span class="syntax3">"enter"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8471"></a>5.2.9.&nbsp;&lt;ui:formEnterKeyboardHandler&gt;</h3></div></div></div><p>Same as <code class="literal">&lt;ui:formKeyboardHandlerTag&gt;</code>
      except <code class="literal">key</code> is already set to
      <code class="literal">enter</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8486"></a>5.2.10.&nbsp;&lt;ui:formEscapeKeyboardHandler&gt;</h3></div></div></div><p>Same as <code class="literal">&lt;ui:formKeyboardHandlerTag&gt;</code>
      except <code class="literal">key</code> is already set to
      <code class="literal">escape</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8501"></a>5.2.11.&nbsp;&lt;ui:textInput&gt;</h3></div></div></div><p>Form text input field, represents <code class="literal">TextControl</code>.
      It is rendered in HTML with <code class="literal">&lt;input type="text"
      ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-text"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8515"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Maximum length of accepted text (in
                characters).</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>. For this tag,
                <span class="emphasis"><em>onchange</em></span> event is simulated with
                <span class="emphasis"><em>onblur</em></span>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8565"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"someForm"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"firstField"</span><span class="syntax10">&gt;</span>
     <span class="syntax1">&lt;!-- Renders input field binded to form's firstField element --&gt;</span>
     <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8570"></a>5.2.12.&nbsp;&lt;ui:autoCompleteTextInput&gt;</h3></div></div></div><p>Form text input field, represents
      <code class="literal">AutoCompleteTextControl</code>. It is rendered in HTML with
      <code class="literal">&lt;input type="text" ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-text"</code>. It is able to make
      background AJAX request to the server, fetching suggested completions to
      user input and displaying these to the user.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8584"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Maximum length of accepted text (in
                characters).</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>. For this tag,
                <span class="emphasis"><em>onchange</em></span> event is simulated with
                <span class="emphasis"><em>onblur</em></span>.</td></tr><tr><td>divClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>CSS class attribute assigned to &lt;DIV&gt; inside
                which suggestions are presented.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="comboTextInput"></a>5.2.13.&nbsp;&lt;ui:comboTextInput&gt;</h3></div></div></div><p>Form text input field, represents <code class="literal">ComboTextControl</code>.
      This is an input field combined with Select&#8212;it allows end-user to enter text
      into field or select some predefined value from provided list of values.
      It is rendered in HTML with <code class="literal">&lt;input type="text"
      ...&gt;</code> tag plus custom select component. Default
      <code class="literal">styleClass="aranea-text"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8658"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Maximum length of accepted text (in
                characters).</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>. For this tag,
                <span class="emphasis"><em>onchange</em></span> event is simulated with
                <span class="emphasis"><em>onblur</em></span>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8708"></a>5.2.14.&nbsp;&lt;ui:textInputDisplay&gt;</h3></div></div></div><p>Form text display field, represents
      <code class="literal">TextControl</code>. It is rendered in HTML with
      <code class="literal">&lt;span ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-text-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8722"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8733"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"someForm"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"firstField"</span><span class="syntax10">&gt;</span>
     <span class="syntax1">&lt;!-- Renders display field for form's firstField element --&gt;</span>
     <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInputDisplay/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8739"></a>5.2.15.&nbsp;&lt;ui:numberInput&gt;</h3></div></div></div><p>Form number input field, represents
      <code class="literal">NumberControl</code>. It is rendered in HTML with
      <code class="literal">&lt;input type="text" ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-number"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8753"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Maximum length of accepted text (in
                characters).</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>. For this tag,
                <span class="emphasis"><em>onchange</em></span> event is simulated with
                <span class="emphasis"><em>onblur</em></span>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8803"></a>5.2.16.&nbsp;&lt;ui:numberInputDisplay&gt;</h3></div></div></div><p>Form number display field, represents
      <code class="literal">NumberControl</code>. It is rendered in HTML with
      <code class="literal">&lt;span ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-number-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8817"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8829"></a>5.2.17.&nbsp;&lt;ui:floatInput&gt;</h3></div></div></div><p>Form floating-point number input field, represents
      <code class="literal">FloatControl</code>. It is rendered in HTML with
      <code class="literal">&lt;input type="text" ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-float"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8843"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Maximum length of accepted floating-point number (in
                characters).</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>. For this tag,
                <span class="emphasis"><em>onchange</em></span> event is simulated with
                <span class="emphasis"><em>onblur</em></span>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8893"></a>5.2.18.&nbsp;&lt;ui:floatInputDisplay&gt;</h3></div></div></div><p>Form floating-point number display field, represents
      <code class="literal">FloatControl</code>. It is rendered in HTML with
      <code class="literal">&lt;span ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-float-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8907"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8919"></a>5.2.19.&nbsp;&lt;ui:passwordInput&gt;</h3></div></div></div><p>Form number input field, represents
      <code class="literal">TextControl</code>. It is rendered in HTML with
      <code class="literal">&lt;input type="password" ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-text"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8933"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Maximum length of password (in characters).</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>. For this tag,
                <span class="emphasis"><em>onchange</em></span> event is simulated with
                <span class="emphasis"><em>onblur</em></span>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e8984"></a>5.2.20.&nbsp;&lt;ui:textDisplay&gt;</h3></div></div></div><p>Form text display field, represents
      <code class="literal">DisplayControl</code>, displays element value as
      <code class="literal">String</code>. It is rendered in HTML with <code class="literal">&lt;span
      ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8998"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9010"></a>5.2.21.&nbsp;&lt;ui:valueDisplay&gt;</h3></div></div></div><p>Puts form element value in page scope variable, represents
      <code class="literal">DisplayControl</code>. It does not output any HTML.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9018"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>var</td><td>
                  <span class="emphasis"><em>true</em></span>
                </td><td>Name of the page-scoped EL variable that will be
                assigned element value.</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">id</code>
        attribute.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9051"></a>5.2.22.&nbsp;&lt;ui:textarea&gt;</h3></div></div></div><p>Form text input area, represents
      <code class="literal">TextareaControl</code>. It is rendered in HTML with
      <code class="literal">&lt;textarea ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-textarea"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9065"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>cols</td><td>
                  <span class="emphasis"><em>true</em></span>
                </td><td>Number of visible columns in textarea.</td></tr><tr><td>rows</td><td>
                  <span class="emphasis"><em>true</em></span>
                </td><td>Number of visible rows in textarea.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9106"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"someForm"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"longLongText"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textarea rows</span>=<span class="syntax3">"15"</span><span class="syntax10"> cols</span>=<span class="syntax3">"150"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9112"></a>5.2.23.&nbsp;&lt;ui:richtextarea&gt;</h3></div></div></div><p>Form text input area, represents
      <code class="literal">TextareaControl</code>. It is rendered in HTML with
      <code class="literal">&lt;textarea ...&gt;</code> tag with
      <code class="literal">styleClass="richTextEditor"</code>. The area is displayed as
      a rich text editor. The configuration of the editor is done via
      <code class="literal">&lt;ui:richTextAreaInit&gt;</code>. The tag shares all the
      attributes of the <code class="literal">&lt;ui:textarea&gt;</code> except the
      <code class="literal">styleClass</code> which cannot be set for this tag.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9135"></a>5.2.24.&nbsp;&lt;ui:richTextAreaInit&gt;</h3></div></div></div><p>A tag for configuring the rich textareas. The <a href="http://tinymce.moxiecode.com/" target="_top">tinyMCE</a> WYSIWYG editor is
      attached to the textareas defined via
      <code class="literal">&lt;ui:richTextarea&gt;</code> . The configuration lets you
      choose the looks, buttons, functionality of the editor. See <a href="http://tinymce.moxiecode.com/tinymce/docs/reference_configuration.html" target="_top">tinyMCE
      configuration reference</a> for different configurable
      options.</p><p>The configuration is done via nesting key value pairs inside the
      <code class="literal">&lt;ui:richTextAreaInit&gt;</code>. For the key value pairs the
      <code class="literal">&lt;ui:attribute&gt;</code> tag is used. See the example for
      an overview.</p><p>The <code class="literal">editor_selector</code> and <code class="literal">mode</code>
      options are set by default and should not be changed. The default
      <code class="literal">theme</code> is "simple".</p><p><span class="emphasis"><em>Important:</em></span> the configuration should be done
      in the <code class="literal">&lt;head&gt;</code> section of the HTML
      document.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9175"></a>Example</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:richTextAreaInit</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"theme"</span><span class="syntax10"> value</span>=<span class="syntax3">"advanced"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"theme_advanced_buttons1"</span><span class="syntax10"> value</span>=<span class="syntax3">"bold,italic,underline,separator,code"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"theme_advanced_toolbar_location"</span><span class="syntax10"> value</span>=<span class="syntax3">"top"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"theme_advanced_toolbar_align"</span><span class="syntax10"> value</span>=<span class="syntax3">"left"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:attribute name</span>=<span class="syntax3">"theme_advanced_path_location"</span><span class="syntax10"> value</span>=<span class="syntax3">"bottom"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:richTextAreaInit</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9180"></a>5.2.25.&nbsp;&lt;ui:textareaDisplay&gt;</h3></div></div></div><p>Form text display area, represents
      <code class="literal">TextareaControl</code>. It is rendered in HTML with
      <code class="literal">&lt;span ...&gt;</code> tag. Default
      <code class="literal">styleClass="aranea-textarea-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9194"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>escapeSingleSpaces</td><td>
                  <span class="emphasis"><em>false</em></span>
                </td><td>Boolean, specifying whether even single spaces (blanks) should be replace with &amp;nbsp; entities in output. It affects
                browser performed text-wrapping. Default value is <code class="literal">false</code>. 
                Attribute is available since tag-library version 1.0.6.</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9233"></a>5.2.26.&nbsp;&lt;ui:hiddenInput&gt;</h3></div></div></div><p>Represents a "hidden" form input
      element&#8212;<code class="literal">HiddenControl</code>. It is rendered in HTML with
      <code class="literal">&lt;input type="hidden" ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9244"></a>Attributes</h4></div></div></div><span class="emphasis"><em>See <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span>

         However, rendered tag is not visible to end-user, thus using any attributes is mostly pointless. 
      </div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9253"></a>5.2.27.&nbsp;&lt;ui:checkbox&gt;</h3></div></div></div><p>Form checkbox <span class="emphasis"><em>input</em></span> field, represents
      <code class="literal">CheckboxControl</code>. By default
      <code class="literal">styleClass="aranea-checkbox"</code>. Rendered in HTML with
      <code class="literal">&lt;input type="checkbox" ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9270"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code></td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9303"></a>5.2.28.&nbsp;&lt;ui:checkboxDisplay&gt;</h3></div></div></div><p>Form checkbox <span class="emphasis"><em>display</em></span> field, represents
      <code class="literal">CheckboxControl</code>. By default
      <code class="literal">styleClass="aranea-checkbox-display"</code>. Rendered in
      HTML inside <code class="literal">&lt;span&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9320"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9332"></a>5.2.29.&nbsp;&lt;ui:fileUpload&gt;</h3></div></div></div><p>
        Form file upload field, represents <code class="literal">FileUploadControl</code>.
        File upload can upload the file automatically once it is selected. This would enable file
        uploads on pages with update regions and overlay. To make a file upload submit its data
        without rendering the page, add a CSS class to the input named <code class="literal">ajax-upload</code>.
        See more info at the <a href="#javascript" title="Chapter&nbsp;9.&nbsp;Javascript Libraries">Chapter&nbsp;9, <i>Javascript Libraries</i></a> part of the documentation.
      </p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9345"></a>Attributes</h4></div></div></div><span class="emphasis"><em>See <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9352"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"uploadForm"</span><span class="syntax10">&gt;</span>
   <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
       <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell styleClass</span>=<span class="syntax3">"name"</span><span class="syntax10">&gt;</span>
           <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:fileUpload id</span>=<span class="syntax3">"file"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
       <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
   <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
...
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9358"></a>5.2.30.&nbsp;&lt;ui:dateInput&gt;</h3></div></div></div><p>Form date input field, represents <code class="literal">(Joda)DateControl</code>.
      Default <code class="literal">styleClass="aranea-date"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9369"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9403"></a>5.2.31.&nbsp;&lt;ui:dateInputDisplay&gt;</h3></div></div></div><p>Form date display field, represents
      <code class="literal">(Joda)DateControl</code>. Default
      <code class="literal">styleClass="aranea-date-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9414"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9426"></a>5.2.32.&nbsp;&lt;ui:timeInput&gt;</h3></div></div></div><p>Form time input field, represents <code class="literal">(Joda)TimeControl</code>.
      Default <code class="literal">styleClass="aranea-time"</code>. HTML &lt;select&gt;s for easy hour/minute selection
      are rendered too, unless <code class="literal">showTimeSelect</code> attribute forbids it.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9440"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr><tr><td>showTimeSelect</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	Boolean, specifying whether HTML &lt;select&gt;'s should be rendered for easy hour/minute selection.
                	Default is to render them (<code class="literal">true</code>).
                </td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9487"></a>5.2.33.&nbsp;&lt;ui:timeInputDisplay&gt;</h3></div></div></div><p>Form time display field, represents
      <code class="literal">(Joda)TimeControl</code>. Default
      <code class="literal">styleClass="aranea-time-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9498"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9509"></a>5.2.34.&nbsp;&lt;ui:dateTimeInput&gt;</h3></div></div></div><p>Form input field for both date and time, represents
      <code class="literal">(Joda)DateTimeControl</code>. It is rendered as input fields for date and time + date picker and
      time picker (time picker can be switched off by setting <code class="literal">showTimeSelect="false"</code> if so desired).</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9520"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr><tr><td>showTimeSelect</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	Boolean, specifying whether HTML &lt;select&gt;'s should be rendered for easy hour/minute selection.
                	Default is to render them (<code class="literal">true</code>).
                </td></tr><tr><td>dateStyleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td><span class="emphasis"><em>styleClass</em></span> for date. Default is
                "aranea-date".</td></tr><tr><td>timeStyleClass</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td><span class="emphasis"><em>styleClass</em></span> for time. Default is
                "aranea-time".</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9591"></a>5.2.35.&nbsp;&lt;ui:dateTimeInputDisplay&gt;</h3></div></div></div><p>Form display field for both date and time, represents
      <code class="literal">(Joda)DateTimeControl</code>. Default
      <code class="literal">styleClass="aranea-datetime-display"</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9602"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ui_select"></a>5.2.36.&nbsp;&lt;ui:select&gt;</h3></div></div></div><p>Form dropdown list input field, represents
      <code class="literal">SelectControl</code>. Default
      <code class="literal">styleClass="aranea-select"</code>, rendered with HTML
      <code class="literal">&lt;select ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9628"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Number of select elements visible at once.</td></tr><tr><td>localizeDisplayItems</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	A boolean specifying whether to localize display items.
                	Provides a way to override
                	ConfigurationContext.LOCALIZE_FIXED_CONTROL_DATA.
                </td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9683"></a>5.2.37.&nbsp;&lt;ui:selectDisplay&gt;</h3></div></div></div><p>Form select display field, represents
      <code class="literal">SelectControl</code>. Default
      <code class="literal">styleClass="aranea-select-display"</code>, rendered with
      HTML <code class="literal">&lt;span ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9697"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>localizeDisplayItems</td><td><span class="emphasis"><em>no</em></span></td><td>
                	A boolean specifying whether to localize display items.
                	Provides a way to override
                	ConfigurationContext.LOCALIZE_FIXED_CONTROL_DATA.
                </td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">id</code> and <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9731"></a>5.2.38.&nbsp;&lt;ui:multiSelect&gt;</h3></div></div></div><p>Form list input field, represents
      <code class="literal">MultiSelectControl</code>. Default
      <code class="literal">styleClass="aranea-multi-select"</code>, rendered with HTML
      <code class="literal">&lt;select multiple="true" ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9745"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>size</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Vertical size, number of options displayed at
                once.</td></tr><tr><td>localizeDisplayItems</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	A boolean specifying whether to localize display items.
                	Provides a way to override
                	ConfigurationContext.LOCALIZE_FIXED_CONTROL_DATA.
                </td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9787"></a>5.2.39.&nbsp;&lt;ui:multiSelectDisplay&gt;</h3></div></div></div><p>Form multiselect display field, represents
      <code class="literal">MultiSelectControl</code>. Default
      <code class="literal">styleClass="aranea-multi-select-display"</code>, rendered
      with HTML <code class="literal">&lt;span ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9801"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>separator</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The separator between list items, can be any string or
                '\n' for newline. Default is ', ').</td></tr><tr><td>localizeDisplayItems</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	A boolean specifying whether to localize display items.
                	Provides a way to override
                	ConfigurationContext.LOCALIZE_FIXED_CONTROL_DATA.
                </td></tr></tbody></table></div><span class="emphasis"><em>Has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9847"></a>5.2.40.&nbsp;&lt;ui:radioSelect&gt;</h3></div></div></div><p>Form radioselect buttons field, represents
      <code class="literal">SelectControl</code>. Default
      <code class="literal">styleClass="aranea-radioselect"</code>. It takes care of
      rendering all its elements; internally using
      &lt;ui:radioSelectItemLabel&gt; and &lt;ui:radioSelectItem&gt;
      tags.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9858"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The way the radio buttons will be rendered - can be
                either <span class="emphasis"><em>vertical</em></span> or
                <span class="emphasis"><em>horizontal</em></span>. By default
                "horizontal".</td></tr><tr><td>labelBefore</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Boolean that controls whether label is before or after
                each radio button, <code class="literal">false</code> by
                default.</td></tr><tr><td>localizeDisplayItems</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	A boolean specifying whether to localize display items.
                	Provides a way to override
                	ConfigurationContext.LOCALIZE_FIXED_CONTROL_DATA.
                </td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9919"></a>5.2.41.&nbsp;&lt;ui:radioSelectItem&gt;</h3></div></div></div><p>Form radio button, represents one item from
      <code class="literal">SelectControl</code>. Default
      <code class="literal">styleClass="aranea-radio"</code>. It will be rendered with
      HTML <code class="literal">&lt;input type="radio" ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9933"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The value of this radio button that will be submitted
                with form if this radio button is selected.</td></tr><tr><td>onChangePrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether registered onchange
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e9978"></a>5.2.42.&nbsp;&lt;ui:radioSelectItemLabel&gt;</h3></div></div></div><p>Form radio button label, represents label of one item from
      <code class="literal">SelectControl</code>. It will be rendered with HTML
      <code class="literal">&lt;span ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e9989"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Select item value.</td></tr><tr><td>showMandatory</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Indicates whether label for mandatory input is marked
                with asterisk. Value should be <code class="literal">true</code> or
                <code class="literal">false</code>, default is
                <code class="literal">true</code>.</td></tr><tr><td>showColon</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Indicates whether colon is shown between the label and
                value. Default is <code class="literal">true</code></td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10056"></a>5.2.43.&nbsp;&lt;ui:checkboxMultiSelect&gt;</h3></div></div></div><p>Form multiselect checkbox field, represents
      <code class="literal">MultiSelectControl</code>. It takes care of rendering all
      its elements; internally using &lt;ui:checkboxMultiSelectItemLabel&gt;
      and &lt;ui:checkboxMultiSelectItem&gt; tags.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10064"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>type</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The way the checkboxes will be rendered - can be either
                <span class="emphasis"><em>vertical</em></span> or
                <span class="emphasis"><em>horizontal</em></span>. Default is
                <span class="emphasis"><em>horizontal</em></span>.</td></tr><tr><td>labelBefore</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Boolean that controls whether label is before or after
                each cehckbox, <code class="literal">false</code> by default.</td></tr><tr><td>localizeDisplayItems</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>
                	A boolean specifying whether to localize display items.
                	Provides a way to override
                	ConfigurationContext.LOCALIZE_FIXED_CONTROL_DATA.
                </td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10128"></a>5.2.44.&nbsp;&lt;ui:checkboxMultiSelectItem&gt;</h3></div></div></div><p>Form radio button, represents one item from
      <code class="literal">MultiSelectControl</code>. Default
      <code class="literal">styleClass="aranea-multi-checkbox"</code>. It will be
      rendered with HTML <code class="literal">&lt;input type="checkbox" ...&gt;</code>
      tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10142"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The value of this checkbox that will be submitted with
                form if this checkbox is selected.</td></tr></tbody></table></div><span class="emphasis"><em>Also see <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10174"></a>5.2.45.&nbsp;&lt;ui:checkboxMultiSelectItemLabel&gt;</h3></div></div></div><p>Form checkbox label, represents label of one item from
      <code class="literal">MultiSelectControl</code>. It will be rendered with HTML
      <code class="literal">&lt;span ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10185"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Select item value.</td></tr><tr><td>showMandatory</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Indicates whether label for mandatory input is marked
                with asterisk. Value should be <code class="literal">true</code> or
                <code class="literal">false</code>, default is
                <code class="literal">true</code>.</td></tr><tr><td>showColon</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Indicates whether colon is shown between the label and
                value. Default is <code class="literal">true</code></td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10252"></a>5.2.46.&nbsp;&lt;ui:conditionalDisplay&gt;</h3></div></div></div><p>Depending whether form element boolean value is
      <span class="emphasis"><em>true</em></span> or <span class="emphasis"><em>false</em></span> display one or
      other content, represents <code class="literal">DisplayControl</code>.
      <code class="literal">&lt;ui:conditionFalse&gt;</code> and
      <code class="literal">&lt;ui:conditionFalse&gt;</code> tags must be used inside
      this tag to define alternative contents. This tag itself is not
      rendered.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10272"></a>Attributes</h4></div></div></div><span class="emphasis"><em>Has standard <code class="literal">id</code> attribute.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10281"></a>5.2.47.&nbsp;&lt;ui:conditionFalse&gt;</h3></div></div></div><p>The content of this tag will be displayed when form element of
      surrounding <code class="literal">&lt;ui:conditionalDisplay&gt;</code> was
      <code class="literal">false</code>. Tag has no attributes.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10293"></a>5.2.48.&nbsp;&lt;ui:conditionTrue&gt;</h3></div></div></div><p>The content of this tag will be displayed when form element of
      surrounding <code class="literal">&lt;ui:conditionalDisplay&gt;</code> was
      <code class="literal">true</code>. Tag has no attributes.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10304"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:form id</span>=<span class="syntax3">"someForm"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:conditionalDisplay id</span>=<span class="syntax3">"isActive"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:conditionTrue</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">img src</span>=<span class="syntax3">"red_flag.png"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:conditionTrue</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:conditionFalse</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">img src</span>=<span class="syntax3">"green_flag.png"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:conditionFalse</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:conditionalDisplay</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:form</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10309"></a>5.2.49.&nbsp;&lt;ui:listDisplay&gt;</h3></div></div></div><p>Display form element value as list of strings, represents
      <code class="literal">DisplayControl</code> and requires that element value would
      be of type <code class="literal">Collection</code>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10320"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>separator</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>The separator between list items, can be any string and
                "\n", meaning a newline (default is "\n").</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">id</code> and
        <code class="literal">styleClass</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10355"></a>5.2.50.&nbsp;&lt;ui:automaticFormElement&gt;</h3></div></div></div><p>Sometimes the type of <code class="literal">FormElement</code> is not known
      for sure when writing JSP (it could be <code class="literal">textInput</code>,
      <code class="literal">floatInput</code>, <code class="literal">select</code>, ...). For that
      purpose, <code class="literal">FormElement</code> that has some known identifier
      can be dynamically associated with some JSP tag in Java code and then
      rendered with <code class="literal">&lt;ui:automaticFormElement&gt;</code> tag
      which uses associated tag to render
      <code class="literal">FormElement</code>.
      </p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10381"></a>Attributes</h4></div></div></div><span class="emphasis"><em>See <a href="#common-formelement-attributes" title="5.2.1.&nbsp;Common attributes for all form element rendering tags.">Section&nbsp;5.2.1, &#8220;Common attributes for all form element rendering tags.&#8221;</a>.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10388"></a>Examples</h4></div></div></div><p>In Java code, setting tag that should rendering element is done
        by either setting <code class="literal">FormElement</code> property or preferably by using <code class="literal">AutomaticFormElementUtil</code>
        utility which makes the code slightly less verbose. Following lines of code all do the same thing:
        </p><pre class="programlisting"><pre><span class="syntax0">element.<span class="syntax9">setProperty</span>(FormElementViewSelector.FORM_ELEMENT_VIEW_SELECTOR_PROPERTY, <span class="syntax6">new</span> <span class="syntax9">FormElementViewSelector</span>(tag, attributes));
AutomaticFormElementUtil.<span class="syntax9">setFormElementViewSelector</span>(element, <span class="syntax6">new</span> <span class="syntax9">FormElementViewSelector</span>(tag, attributes));
AutomaticFormElementUtil.<span class="syntax9">setFormElementTag</span>(element, tag, attributes);
</span></pre></pre><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"someForm"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:automaticFormElement/</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="form_lists"></a>5.3.&nbsp;Form Lists</h2></div></div></div><p>A common need in handling data is allowing a user to list of data,
    where the number of rows is not known beforehand (a typical example being
    user inputting one to many addresses). Aranea supports such a use case by
    providing a special type of <code class="literal">FormElement</code> that deals an
    arbitrary amount of subforms. This element is called
    <code class="literal">FormListWidget</code> and it can be used both on its own or as
    a subelement just like a <code class="literal">FormWidget</code>. An example of a
    form list is shown on <a href="#person-form-list" title="Figure&nbsp;5.2.&nbsp;Insert your name display">Figure&nbsp;5.2, &#8220;Insert your name display&#8221;</a>.</p><div class="figure"><a name="person-form-list"></a><div class="mediaobject"><img src="../images/formList.png" alt="Insert your name display"></div><p class="title"><b>Figure&nbsp;5.2.&nbsp;Insert your name display</b></p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10426"></a>5.3.1.&nbsp;FormListWidget</h3></div></div></div><p>Unlike usual forms, form lists are "lazy", from the point that
      they are tied to a model and update themselves according to it. To
      create a form list widget we pass it a model and a handler:</p><pre class="programlisting"><pre><span class="syntax0">... 
  <span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax6">private</span> FormListWidget personFormList;
    ...
    Map persons <span class="syntax11">=</span> <span class="syntax9">lookupMyService</span>().<span class="syntax9">getPersons</span>();

    personFormList <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BeanFormListWidget</span>(
        <span class="syntax6">new</span> <span class="syntax9">PersonFormRowHandler</span>(),
        <span class="syntax6">new</span> <span class="syntax9">MapFormListModel</span>(persons),
        Person.<span class="syntax8">class</span>);

    <span class="syntax9">addWidget</span>(<span class="syntax3">"personFormList"</span>, personFormList);
  <span class="syntax11">}</span>
...
</span></pre></pre><p>Note here that we have tied the form list to the model that uses a
      <code class="literal">Map</code> as the underlying storage. When we update that
      map, the form list will also be updated. Note also that the form list
      widget is associated with the <code class="literal">Person</code> bean class,
      which can be used to manipulate the beans under the model.</p><p>However this code doesn't yet tell us much. The bulk of the custom
      logic of the form lists is hidden in the
      <code class="literal">PersonFormRowHandler</code> class. Let's inspect it step by
      step.</p><p>Every form row handler must implement the
      <code class="literal">FormRowHandler</code> interface. In our case we choose to
      extend <code class="literal">ValidOnlyIndividualFormRowHandler</code>, which
      processes only valid form rows and allows to process them one by one,
      not all at once:</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">class</span> PersonFormRowHandler
  <span class="syntax6">extends</span> ValidOnlyIndividualFormRowHandler <span class="syntax11">{</span>
  ...
<span class="syntax11">}</span>
</span></pre></pre><p>The first method we have to implement is
      <code class="literal">getRowKey</code>. It is used by the form list widget to
      identify the row among the others. Since typically the row is just a
      bean we can identify it using its identifier (either a natural one or
      artificial, as long as its unique in this context):</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> Object <span class="syntax9">getRowKey</span>(Object rowData) <span class="syntax11">{</span>
  <span class="syntax6">return</span> ((Person) rowData).<span class="syntax9">getId</span>();
<span class="syntax11">}</span>
...
</span></pre></pre><p>The next method is called <code class="literal">initAddForm</code> and it
      will create a form used to add new rows to the form list:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">initAddForm</span>(FormWidget addForm) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  addForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"name"</span>, <span class="syntax3">"#First name"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">true</span>);
  addForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"surname"</span>, <span class="syntax3">"#Last name"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(),  <span class="syntax4">true</span>);
  addForm.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"#Phone no"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">false</span>);

  FormListUtil.<span class="syntax9">addAddButtonToAddForm</span>(<span class="syntax3">"#"</span>, formList, addForm);
<span class="syntax11">}</span>
...
</span></pre></pre><p>The bulk of the logic is just adding the fields to the add form.
      But we also use the <code class="literal">FormListUtil</code> to add a button
      "Add" to the form, that will take care of the actual adding a new row
      (or at least calling the form row handler to do that).
      <code class="literal">FormListUtil</code> contains a lot of helpful methods for
      manipulating form lists and more on it can be found in <a href="#form-list-util" title="5.3.2.&nbsp;FormListUtil">Section&nbsp;5.3.2, &#8220;FormListUtil&#8221;</a>. The next step would be to handle the user
      clicking the add button and add a new row to the model. Since we process
      only valid rows the method will be named
      <code class="literal">addValidRow</code>:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">addValidRow</span>(FormWidget addForm) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  Person person <span class="syntax11">=</span> (Person) (((BeanFormWidget)addForm).<span class="syntax9">writeToBean</span>(<span class="syntax6">new</span> <span class="syntax9">Person</span>()));
  <span class="syntax1">//We want to save changes immediately</span>
  person <span class="syntax11">=</span> lookupPersonService.<span class="syntax9">addPerson</span>(person);
  data.<span class="syntax9">add</span>(person.<span class="syntax9">getId</span>(), person);
<span class="syntax11">}</span>
...
</span></pre></pre><p>Note that although we save the changes here immediately, form
      lists also support deferring this until some later point as described in
      <a href="#form-list-in-memory-helper" title="5.3.5.&nbsp;In Memory Form List">Section&nbsp;5.3.5, &#8220;In Memory Form List&#8221;</a>. Now that we have added a
      row to the model we will also have to initialize a form for that using
      <code class="literal">initFormRow</code> method:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">initFormRow</span>(FormRow formRow, Object rowData) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  <span class="syntax1">// Set initial status of list rows to closed - they cannot be edited before opened.</span>
  formRow.<span class="syntax9">close</span>();

  BeanFormWidget form <span class="syntax11">=</span> (BeanFormWidget)formRow.<span class="syntax9">getForm</span>();

  form.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"name"</span>, <span class="syntax3">"#First name"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">true</span>);
  form.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"surname"</span>, <span class="syntax3">"#Last name"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(),  <span class="syntax4">true</span>);
  form.<span class="syntax9">addBeanElement</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"#Phone no"</span>, <span class="syntax6">new</span> <span class="syntax9">TextControl</span>(), <span class="syntax4">false</span>);

  FormListUtil.<span class="syntax9">addEditSaveButtonToRowForm</span>(<span class="syntax3">"#"</span>, formList, form, <span class="syntax9">getRowKey</span>(rowData));
  FormListUtil.<span class="syntax9">addDeleteButtonToRowForm</span>(<span class="syntax3">"#"</span>, formList, form, <span class="syntax9">getRowKey</span>(rowData));

  form.<span class="syntax9">readFromBean</span>(rowData);
<span class="syntax11">}</span>
...
</span></pre></pre><p>Note that most of the fields are same for add form and edit forms,
      so in a real setup we could easily have added a method
      <code class="literal">addCommonFields(FormWidget)</code> that would add those
      fields to any given form (it is actually a very common idiom to do
      that). Finally we have to handle the saving of row form:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">saveValidRow</span>(FormRow formRow) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  BeanFormWidget form <span class="syntax11">=</span> (BeanFormWidget) formRow.<span class="syntax9">getForm</span>();
  Person person <span class="syntax11">=</span> (Person) form.<span class="syntax9">writeToBean</span>(data.<span class="syntax9">get</span>(formRow.<span class="syntax9">getKey</span>()));

  <span class="syntax9">lookupPersonService</span>().<span class="syntax9">save</span>(rowData);
  data.<span class="syntax9">put</span>(person.<span class="syntax9">getId</span>(), person);
<span class="syntax11">}</span>
...
</span></pre></pre><p>And the last one left is deletion:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">deleteRow</span>(Object key) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  Long id <span class="syntax11">=</span> (Long) key;
  <span class="syntax9">lookupPersonService</span>().<span class="syntax9">remove</span>(id);
  data.<span class="syntax9">remove</span>(id);
<span class="syntax11">}</span>
...
</span></pre></pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="form-list-util"></a>5.3.2.&nbsp;FormListUtil</h3></div></div></div><p><code class="literal">FormListUtil</code> provides a couple of methods that
      help to handle form maps passed to some of the handler methods. However
      of main interest are the methods that add various buttons with ready
      logic to the add forms and row forms.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Method</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">addSaveButtonToRowForm()</code></td><td>Button that will save the current row.</td></tr><tr><td><code class="literal">addDeleteButtonToRowForm()</code></td><td>Button that will delete the current row.</td></tr><tr><td><code class="literal">addOpenCloseButtonToRowForm()</code></td><td>Button that will open or close the current row for
              editing (it inverts the current state).</td></tr><tr><td><code class="literal">addEditSaveButtonToRowForm()</code></td><td>Button that will open/close the row for editing, however
              will also save it after editing is finished and the row is
              closed.</td></tr><tr><td><code class="literal">addAddButtonToAddForm()</code></td><td>Button that will add a new row, should be added to the
              addition form.</td></tr></tbody></table></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10553"></a>5.3.3.&nbsp;Form Row Handlers</h3></div></div></div><p>Since row form handler interface supports bulk
      saving/adding/deleting of row forms it is comfortable to use one of the
      base classes that will do some of the work for you.</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Class</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">DefaultFormRowHandler</code></td><td>Implements all of the menthods and default handling of
              opening/closing rows.</td></tr><tr><td><code class="literal">ValidOnlyFormRowHandler</code></td><td>Checks that all of the added/saved rows are
              valid.</td></tr><tr><td><code class="literal">IndividualFormRowHandler</code></td><td>Supports one by one processing of row saving and
              deleting.</td></tr><tr><td><code class="literal">ValidOnlyIndividualFormRowHandler</code></td><td>Supports one by one processing of row saving and
              deleting. Checks that all of the added/saved rows are
              valid.</td></tr></tbody></table></div><p>Note that row handlers also have an
      <code class="literal">openOrCloseRow</code> method that may be overridden if one
      wants more than just inverting the row state on user action.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10598"></a>5.3.4.&nbsp;Models</h3></div></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="form-list-in-memory-helper"></a>5.3.5.&nbsp;In Memory Form List</h3></div></div></div><p>Often it is the case that we do not want to save the changes in
      the form list to the database until the user presses the "Save" button.
      For such a use case we provide
      <code class="literal">InMemoryFormListHelper</code>. To use the helper we first
      need to initialize the form list to use the helper model:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> BeanFormListWidget personFormList;
<span class="syntax6">private</span> InMemoryFormListHelper inMemoryHelper;

<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  <span class="syntax6">private</span> FormListWidget personFormList;
  ...
  Map persons <span class="syntax11">=</span> <span class="syntax9">lookupMyService</span>().<span class="syntax9">getPersons</span>();

  personFormList <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BeanFormListWidget</span>(<span class="syntax6">new</span> <span class="syntax9">PersonFormRowHandler</span>(), Person.<span class="syntax8">class</span>);
  inMemoryHelper <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">InMemoryFormListHelper</span>(
    personFormList,
    <span class="syntax9">lookupPersonService</span>().<span class="syntax9">getSomePersonList</span>());

  <span class="syntax9">addWidget</span>(<span class="syntax3">"personFormList"</span>, personFormList);
<span class="syntax11">}</span>
...
</span></pre></pre><p>Now we just have to add/save/delete the row to/from the
      helper:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">saveValidRow</span>(FormRow editableRow) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  ...
  inMemoryHelper.<span class="syntax9">update</span>(editableRow.<span class="syntax9">getKey</span>(), rowData);
<span class="syntax11">}</span>

<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">deleteRow</span>(Object key) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  ...
  inMemoryHelper.<span class="syntax9">delete</span>(key);
<span class="syntax11">}</span>

<span class="syntax6">public</span> <span class="syntax8">void</span> <span class="syntax9">addValidRow</span>(FormWidget addForm) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
  ...
  inMemoryHelper.<span class="syntax9">add</span>(rowData);
<span class="syntax11">}</span>
...
</span></pre></pre><p>And when the user presses "Save" we can just process the
      changes:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">handleEventSave</span>() <span class="syntax11">{</span>
  lookupPersonService.<span class="syntax9">addAll</span>(inMemoryHelper.<span class="syntax9">getAdded</span>().<span class="syntax9">values</span>());
  lookupPersonService.<span class="syntax9">saveAll</span>(inMemoryHelper.<span class="syntax9">getUpdated</span>().<span class="syntax9">values</span>());
  lookupPersonService.<span class="syntax9">deleteAll</span>(inMemoryHelper.<span class="syntax9">getDeleted</span>());
<span class="syntax11">}</span>
...
</span></pre></pre></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e10619"></a>5.4.&nbsp;Form Lists JSP Tags</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10622"></a>5.4.1.&nbsp;&lt;ui:formList&gt;</h3></div></div></div><p>Formlist is a list of forms, an editable list. This tag specifies
      editable list context for its inner tags.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10627"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>Id of editable list. When not specified, attempt is
                made to construct it from existing list context&#8212;it this does
                not succeed, tag fails.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10652"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>formList</td><td>Editable list view model.</td><td align="center"><code class="literal">FormListWidget.ViewModel</code></td></tr><tr><td>formListId</td><td>Editable list id.</td><td align="center"><code class="literal">String</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10685"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formList</span><span class="syntax10">&gt;</span>
       ...
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formList</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10691"></a>5.4.2.&nbsp;&lt;ui:formListRows&gt;</h3></div></div></div><p>Iterating tag that gives access to each row and row form on the
      editable list current page. The editable row is accessible as
      "editableRow" variable.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10696"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>var</td><td><span class="emphasis"><em>no</em></span></td><td>Name of variable that represents individual row (by
                default "row").</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10721"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>formRow</td><td>Current editable list row view model.</td><td align="center"><code class="literal">FormRow.ViewModel</code></td></tr><tr><td>row (unless changed with <span class="emphasis"><em>var</em></span>
                attribute).</td><td>Object held in current row.</td><td align="center"><code class="literal">Object</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10757"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formList</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formListRows</span><span class="syntax10">&gt;</span>
           ...
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formListRows</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formList</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10762"></a>5.4.3.&nbsp;&lt;ui:formListAddForm&gt;</h3></div></div></div><p>Allows for adding new forms (rows) to editable list.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10767"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>Editable list id. Searched from context, if not
                specified.</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10792"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>form</td><td>View model of form.</td><td align="center"><code class="literal">FormWidget.ViewModel</code></td></tr><tr><td>formId</td><td>Id of form.</td><td align="center"><code class="literal">String</code></td></tr><tr><td>formFullId</td><td>Full id of form.</td><td align="center"><code class="literal">String</code></td></tr><tr><td>formScopedFullId</td><td>Full scoped id of form.</td><td align="center"><code class="literal">String</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e10841"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formListAddForm</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput id</span>=<span class="syntax3">"name"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput id</span>=<span class="syntax3">"surname"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput id</span>=<span class="syntax3">"phone"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:dateInput id</span>=<span class="syntax3">"birthdate"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>                          
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>       
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formListAddForm</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="lists"></a>Chapter&nbsp;6.&nbsp;Lists and Query Browsing</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Introduction"></a>6.1.&nbsp;Introduction</h2></div></div></div><p>A common task in web applications is displaying tables. This is a
    simple task if the tables are small and do not contain a lot of rows. The
    whole table can be visible at once and there is no need to split the data
    into pages as well as provide an option to order the table by new column
    or display a search form that can be used to filter the data. In such
    cases where these features must be available, Aranea provides widget
    <code class="classname">org.araneaframework.uilib.list.ListWidget</code> and some
    support classes. In this chapter we will introduce these widgets and
    supporting API and show how to use and extend them.</p><p><code class="classname">ListWidget</code> is used to define the list
    columns, the way the list can be filtered and ordered, how many items are
    shown per pages etc. <code class="classname">ListWidget</code> uses
    <code class="classname">org.araneaframework.uilib.list.dataprovider.ListDataProvider</code>
    to get the current list items range that also match with the current
    filter and order conditions. <code class="classname">ListDataProvider</code> can
    cache whole table and provide the <code class="classname">ListWidget</code> with
    the appropriate item range or fetch only the specific item range from
    database. Aranea provides two implementations: </p><div class="variablelist"><dl><dt><span class="term"><code class="classname">org.araneaframework.uilib.list.dataprovider.MemoryBasedListDataProvider</code></span></dt><dd>
             This is the memory-based solution that must be provided with the whole data at once. It does 

            <span class="emphasis"><em>filtering</em></span>

             , 

            <span class="emphasis"><em>ordering</em></span>

             and 

            <span class="emphasis"><em>paging</em></span>

             memory-based. The data source is not restricted here. This is a very fast and easy-to-use solution
             for tables with few (typically less than 100) rows. This is a good solution when your server has
             enough memory to store all the rows, and quering all the rows does not take much time.
          </dd><dt><span class="term"><code class="classname">org.araneaframework.uilib.list.dataprovider.BackendListDataProvider</code></span></dt><dd>
             This is the database solution that will cache only the current item range and executes a new database query each time a 

            <span class="emphasis"><em>filtering</em></span>

             , 

            <span class="emphasis"><em>ordering</em></span>

             or 

            <span class="emphasis"><em>paging</em></span>

             conditions change. This is a powerful solution for tables with more than 500 rows. Especially,
             when the query is complex and takes time (so it would not be useful to query all the rows at once).
          </dd></dl></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ListsAPI"></a>6.2.&nbsp;Lists API</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e10908"></a>6.2.1.&nbsp;A Typical List</h3></div></div></div><p>A typical list will be created used like this: </p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> BeanListWidget myList;
...
<span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax11">{</span>
  ...
  myList <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">BeanListWidget</span>(MyModel.<span class="syntax8">class</span>);

  myList.<span class="syntax9">setOrderableByDefault</span>(<span class="syntax4">true</span>);
  myList.<span class="syntax9">addField</span>(<span class="syntax3">"name"</span>, <span class="syntax3">"#Name"</span>).<span class="syntax9">like</span>();
  myList.<span class="syntax9">addField</span>(<span class="syntax3">"surname"</span>, <span class="syntax3">"#Surname"</span>).<span class="syntax9">like</span>();
  myList.<span class="syntax9">addField</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"#Phone no"</span>).<span class="syntax9">like</span>();
  myList.<span class="syntax9">addField</span>(<span class="syntax3">"birthdate"</span>, <span class="syntax3">"#Birthdate"</span>).<span class="syntax9">range</span>();
  ...
  myList.<span class="syntax9">setInitialOrder</span>(<span class="syntax3">"name"</span>, <span class="syntax4">true</span>);
  myList.<span class="syntax9">setListDataProvider</span>(<span class="syntax6">new</span> <span class="syntax9">MyListDataProvider</span>());  
  <span class="syntax9">addWidget</span>(<span class="syntax3">"myList"</span>, myList);
  ...
<span class="syntax11">}</span>
...
</span></pre></pre><p> Note that here we basically do following things:
      </p><div class="variablelist"><dl><dt><span class="term">Create the list</span></dt><dd>
               The line 

              <code class="literal">new BeanListWidget(MyModel.class)</code>

               creates a new list widget that is associated with the 

              <span class="emphasis"><em>JavaBean</em></span>

               model class 

              <code class="literal">MyModel</code>

               . 
            </dd><dt><span class="term">Make fields orderable</span></dt><dd>
               The line 

              <code class="literal">myList.setOrderableByDefault(true)</code>

               configures the following fields as orderable. 
            </dd><dt><span class="term">Add list fields</span></dt><dd>
               The line 

              <code class="literal">myList.addField("name", "#Name").like()</code>

               adds a field associated with the JavaBean property "name" (this is also the identifier of the field), with a label "Name", makes the field filterable by 

              <code class="literal">Like</code>

               filter. 
            </dd><dt><span class="term">Set the initial list order</span></dt><dd>
               The line 

              <code class="literal">myList.setInitialOrder("name", true)</code>

               sets the list to be ordered by field "name" by default. 
            </dd><dt><span class="term">Set the list data provider</span></dt><dd>
               The line 

              <code class="literal">myList.setListDataProvider(new
              MyListDataProvider())</code>

               sets the data provider for the list. 
            </dd><dt><span class="term">Register the list</span></dt><dd>
               The line 

              <code class="literal">addWidget("myList", myList)</code>

               initializes and registers the list allowing it to function. 
            </dd></dl></div><p>Now that we have created the list we show how to build a simple
      data provider. The following example code should be in the same widget
      as the previous: </p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> <span class="syntax8">class</span> MyMemoryBasedListDataProvider <span class="syntax6">extends</span> MemoryBasedListDataProvider <span class="syntax11">{</span>
  <span class="syntax6">protected</span> <span class="syntax9">MyMemoryBasedListDataProvider</span>() <span class="syntax11">{</span>
    <span class="syntax4">super</span>(MyModel.<span class="syntax8">class</span>);
  <span class="syntax11">}</span>
  <span class="syntax6">public</span> List <span class="syntax9">loadData</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>             
    <span class="syntax6">return</span> <span class="syntax9">lookupMyService</span>().<span class="syntax9">findAllMyModel</span>();
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
...
</span></pre></pre><p> The line <code class="literal">super(MyModel.class)</code>
      associated this <code class="classname">MemoryBasedListDataProvider</code> with
      the <span class="emphasis"><em>JavaBean</em></span> model class
      <code class="literal">MyModel</code>. The method <code class="literal">List
      loadData()</code> implements loading all table rows and returning it
      as a <code class="classname">List</code> object.</p><p>Later, we will also discover using
      <code class="classname">org.araneaframework.uilib.list.dataprovider.BackendListDataProvider</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11002"></a>6.2.2.&nbsp;Fields</h3></div></div></div><p>As the list may be displayed as a table, it is basically an
      ordered collection of items. In the previous example, we defined a list
      of <code class="code">MyModel.class</code> typed items that have fields 'name',
      'surname', 'phone' and 'birthdate'. By listing of
      <code class="code">MyModel.class</code>, we also told <code class="code">ListWidget</code> the
      corresponding field types, e.g <code class="code">String.class</code>,
      <code class="code">String.class</code>, <code class="code">Long.class</code> and
      <code class="code">Date.class</code>. In fact this feature of reflection is the only
      distinction between the <code class="code">ListWidget</code> and
      <code class="code">BeanListWidget</code>.</p><p>Each list field have its own <span class="emphasis"><em>Id</em></span>,
      <span class="emphasis"><em>label</em></span> and <span class="emphasis"><em>type</em></span>. The labels are
      used to automatically create a corresponding title row above the
      displayed table. The types are used to describe how to order or filter
      the whole data using this field. E.g <code class="code">String.class</code> is
      treated differently than other types, because usually one would prefer
      to order by this field ignoring the case. Both the labels and types are
      also used to build a corresponding search form - an automatically built
      <code class="code">FormWidget</code> - for the list.</p><p>If we would like to add some list fields that are not
      <code class="code">MyModel.class</code> fields, we can pass it's type to the
      <code class="code">ListWidget</code> like following: </p><pre class="programlisting"><pre><span class="syntax0">myList.<span class="syntax9">addField</span>(<span class="syntax3">"income"</span>, <span class="syntax3">"#Income"</span>, BigDecimal.<span class="syntax8">class</span>);
</span></pre></pre><p>
      Here the <code class="code">myList</code> could be just a <code class="code">ListWidget</code>
      rather than a <code class="code">BeanListWidget</code>.</p><p>When adding a list field, we can also provide this field-related
      ordering and filtering information.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11073"></a>6.2.3.&nbsp;Ordering</h3></div></div></div><p>Each list field can be orderable or not. We already discovered
      <code class="code">ListWidget</code>'s method
      <code class="code">setOrderableByDefault(boolean)</code> that switch whether to
      configure fields that are added afterwards orderable or not. This method
      can be used several times in the list configuration.</p><p>Another way is to set each field individually orderable or not
      when they are added to the list. In such case add additional boolean
      argument to the <code class="code">addField()</code> method such as: </p><pre class="programlisting"><pre><span class="syntax0">myList.<span class="syntax9">addField</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"#Phone no"</span>, <span class="syntax4">false</span>);
</span></pre></pre><p>
      Notice the <code class="code">false</code> as third parameter. <code class="code">true</code>
      means that the list can be ordered by this field and <code class="code">false</code>
      means the opposite. By not providing this parameter, simply the last
      value is used which has been set by
      <code class="code">setOrderableByDefault(boolean)</code> method.</p><p>In addition, we already used method <code class="code">setInitialOrder(String,
      boolean)</code>. It sets a specified field (the first argument) to be
      ordered by default. <code class="code">true</code> as the second argument tells the
      ordering should be ascending, <code class="code">false</code> would mean descending.
      By not providing this information, the list is displayed in the original
      order.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11115"></a>6.2.4.&nbsp;Filtering</h3></div></div></div><p>Filtering means that we only display a certain list items. The
      list can be filtered using its fields and data provided by the search
      form of this list.</p><p>For this, we must provide the <code class="code">ListWidget</code> with the
      corresponding
      <code class="code">org.araneaframework.uilib.list.structure.ListFilter</code>s and
      <code class="code">FormElement</code>s. As the form elements are dummy "boxes" that
      hold search data, each <code class="code">ListFilter</code> is related to a certain
      filter test, e.g. equality, greater than comparison etc. Each
      <code class="code">ListFilter</code> also knows what information it must consider. In
      general, one list field is compared against a value provided by the
      search form. It's also assumed that a blank search field means that this
      particular <code class="code">ListWidget</code> is currently disabled.</p><p>Fortunately, in most cases it's unnecessary to add these search
      fields manually. Instead, if one is adding a list field, he or she can
      assign both the <code class="code">ListFilter</code> and <code class="code">FormElement</code> for
      this field very simply: </p><pre class="programlisting"><pre><span class="syntax0">myList.<span class="syntax9">addField</span>(<span class="syntax3">"address"</span>, <span class="syntax3">"#Address"</span>).<span class="syntax9">like</span>();
</span></pre></pre><p> Here we simply add an 'Address' field providing it with
      label and telling there's should be a <span class="emphasis"><em>Like filter</em></span>
      for this field. By this, we automatically add a <code class="code">TextControl</code>
      into the search form. By filling it with value 'Paris', we will see only
      rows which 'Address' field contain 'Paris', 'paris', 'PARIS' etc.</p><p>To describe, how this works, we show a longer version of the
      previous code: </p><pre class="programlisting"><pre><span class="syntax0">myList.<span class="syntax9">addField</span>(<span class="syntax3">"address"</span>, <span class="syntax3">"#Address"</span>);
myList.<span class="syntax9">getFilterHelper</span>().<span class="syntax9">like</span>(<span class="syntax3">"address"</span>);
</span></pre></pre><p> So there's a special class
      <code class="code">org.araneaframework.uilib.list.structure.filter.FilterHelper</code>
      that is used to add list filters. All <code class="code">ListWidget.addField()</code>
      methods just return a little different version of this helper class,
      called a <code class="code">FieldFilterHelper</code>. It's methods do not need a
      field Id and thus make one not to repeat the same field Id for each
      filter. In general, the shorter usage is recommended of course. However
      some filters are more complicated and may be related to more than one
      list field. For those, one must use the <code class="code">FilterHelper</code>
      instead.</p><p>By default all filters that deal with the Strings are case
      insensitive. To configure some filters to be different, use the
      following: </p><pre class="programlisting"><pre><span class="syntax0">myList.<span class="syntax9">addField</span>(<span class="syntax3">"country"</span>, <span class="syntax3">"#Country"</span>).<span class="syntax9">setIgnoreCase</span>(<span class="syntax4">false</span>).<span class="syntax9">like</span>();
myList.<span class="syntax9">addField</span>(<span class="syntax3">"city"</span>, <span class="syntax3">"#City"</span>).<span class="syntax9">like</span>();
myList.<span class="syntax9">addField</span>(<span class="syntax3">"address"</span>, <span class="syntax3">"#Address"</span>).<span class="syntax9">setIgnoreCase</span>(<span class="syntax4">true</span>).<span class="syntax9">like</span>();
</span></pre></pre><p> This can be explained following: Before adding a Like filter
      for the 'country' field, we switched to the case sensitive mode. And
      before adding a filter for the 'address' field, we switched to the case
      insensitive mode. Thus the city's filter is case sensitive as the
      country's but the address' filter does ignore the case.</p><p>This state is held by the <code class="code">FilterHelper</code> and can be
      modified either by calling a method of the <code class="code">FilterHelper</code> or
      the <code class="code">FieldFilterHelper</code>. In such way, the following
      parameters can be set: </p><div class="variablelist"><dl><dt><span class="term">Case sensitivity</span></dt><dd>
               By using 

              <code class="code">setIgnoreCase(boolean)</code>

               one assigns new filters to ignore case (default) or not. This applies to filters that use String comparison. 
            </dd><dt><span class="term">Strict/non-strict</span></dt><dd>
               By using 

              <code class="code">setStrict(boolean)</code>

               one assigns new filters to disallow equality or not. By default equality is not allowed (strict). This applies to filters such as GreaterThan, LowerThan, Range etc. 
            </dd></dl></div><p>Sometimes tables need to contain a column (or more) that is not bound to specific
      model object field. One can add such a column to the list structure like this:
      </p><pre class="programlisting"><pre><span class="syntax0">myList.<span class="syntax9">addEmptyField</span>(<span class="syntax3">"choose"</span>, <span class="syntax3">"#Choose"</span>);
</span></pre></pre><p>
      The column still must have unique ID (e.g. <code class="code">"choose"</code> in this case).
      The label for the column is optional. In addition, this column would not be orderable
      as its values are not controlled by the <code class="code">ListWdiget</code>. However, this column
      can be used for check boxes, radio buttons, links, etc.</p><p>Now, let's show which filters we have got: </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th><code class="code">FilterHelper</code> method</th><th><code class="code">ListFilter</code> class</th><th>Description</th></tr></thead><tbody><tr><td><code class="code">eq()</code></td><td><code class="code">EqualFilter</code></td><td>Tests if the value of a certain list field is equal to
                the value of a certain search form field. The filter is
                disabled if the search field is blank.</td></tr><tr><td><code class="code">eqConst()</code></td><td><code class="code">EqualFilter</code></td><td>Tests if the value of a certain list field is equal to
                a certain constant. This filter is always enabled.</td></tr><tr><td><code class="code">gt(), lt()</code></td><td><code class="code">GreaterThanFilter, LowerThanFilter</code></td><td>Tests if the value of a certain list field is greater
                than (lower than) the value of a certain search form field.
                This filter is disabled if the search field is blank.</td></tr><tr><td><code class="code">gtConst(), ltConst()</code></td><td><code class="code">GreaterThanFilter, LowerThanFilter</code></td><td>Tests if the value of a certain list field is greater
                than (lower than) a certain constant. This filter, if used,
                is always enabled.</td></tr><tr><td><code class="code">like()</code></td><td><code class="code">LikeFilter</code></td><td>Tests if the pattern in a certain search form field
                matches with the value of a certain list field. This
                corresponds to the <code class="literal">LIKE</code> expression in SQL
                with some modifications. By default, it takes
                '<code class="literal">%</code>' and '<code class="literal">*</code>' symbols as
                any-string wildcards and '<code class="literal">_</code>',
                '<code class="literal">.</code>' and '<code class="literal">?</code>' as
                any-symbol wildcards. In addition, the pattern does not have
                to match with the whole string ('%' is automatically added
                before and after the pattern string). The wildcards and their
                automatic adding is configured by the
                <code class="code">org.araneaframework.uilib.list.util.like.LikeConfiguration</code>
                which is found from the Aranea
                <code class="code">org.araneaframework.uilib.ConfigurationContext</code>.
                This filter is identical in memory-based and database backend
                usage. This filter is disabled if the search field is
                blank.</td></tr><tr><td><code class="code">likeConst()</code></td><td><code class="code">LikeFilter</code></td><td>Tests if a certain constant pattern matches with the
                value of a certain list field. This filter is always
                enabled.</td></tr><tr><td><code class="code">startsWith(), endsWith()</code></td><td><code class="code">LikeFilter</code></td><td>This is very similar to the <code class="code">like()</code> constraint,
                and tests if the list field value either starts or ends with the
                user-provided pattern. The filter is disabled if the search field
                is blank.</td></tr><tr><td><code class="code">startsWithConst(), endsWithConst()</code></td><td><code class="code">LikeFilter</code></td><td>Tests if given constant pattern is either in the beginning
                or in the end of the field value. This filter, if used,
                is always enabled.</td></tr><tr><td><code class="code">isNull(), notNull()</code></td><td><code class="code">NullFilter</code></td><td>Tests if the value of a certain list field is null (is
                not null) if the value of a certain search form field equals
                to a specified value.</td></tr><tr><td><code class="code">isNullConst(), notNullConst()</code></td><td><code class="code">NullFilter</code></td><td>Tests if the value of a certain list field is null (is
                not null). This filter is always enabled.</td></tr><tr><td><code class="code">range()</code></td><td><code class="code">RangeFilter</code></td><td>Tests if the value of a certain list field is between
                two values of certain search form fields. The filter is
                identical to the greater than or lower than filter in case of
                one of the search fields is blank. This filter is disabled if
                both search fields are blank.</td></tr><tr><td><code class="code">fieldRangeInValueRange(),
                valueRangeInFieldRange(), overlapRange()</code></td><td><code class="code">RangeInRangeFilter</code></td><td>Tests if two values of certain list fields are between
                two values of certain search form fields, vice-versa or do
                they have a non-empty intersection. This filter is disabled if
                both search fields are blank.</td></tr><tr><td><code class="code">in()</code></td><td><code class="code">InFilter</code></td><td>Tests if the value of a list field is among the values
                of a MultiSelectControl. It does a case-sensitive search for
                this.</td></tr><tr><td><code class="code">sqlFunction()</code></td><td><code class="code">SqlFunctionFilter</code></td><td>Tests if the value returned from a certain SQL function
                is equal (or is greater than or is lower than) to the value of
                a certain list field, search form field or a constant. The
                arguments of the SQL function can also be chosen among the
                values of list fields, search form fields and constants. This
                filter cannot be used memory-based. This filter is always
                enabled.</td></tr></tbody></table></div><p>By default the <code class="code">FormElement</code>s added into the search
      form have the same identifiers as the list fields. Therefore there can
      be only one search field per list field. If one would like to override
      the used Id for <code class="code">FormElement</code>, any filter could be added like
      following: </p><pre class="programlisting"><pre><span class="syntax0">
        myList.<span class="syntax9">addField</span>(<span class="syntax3">"country"</span>, <span class="syntax3">"#Country"</span>).<span class="syntax9">like</span>();
        myList.<span class="syntax9">getFilterHelper</span>().<span class="syntax9">like</span>(<span class="syntax3">"country"</span>, <span class="syntax3">"anotherCountry"</span>);
</span></pre></pre><p> The first line adds a list field 'country' and a
      <span class="emphasis"><em>Like filter</em></span> associated with it as well as a new
      <code class="code">FormElement</code> with Id of 'country'. The second line adds
      another <span class="emphasis"><em>Like filter</em></span> associated to the list field
      'country' and a new <code class="code">FormElement</code> with Id of
      'anotherCountry'.</p><p>By adding a filter, the corresponding <code class="code">FormElement</code> is
      automatically created and added to the search form of the list. Now we
      cover the properties of the few <code class="code">FormElement</code> describing
      their default values and showing how to customize them: </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Property</th><th>Default value</th><th>Customizing</th></tr></thead><tbody><tr><td>Id</td><td>Same as the list field Id.</td><td>Call
                <code class="code">addField(...).&lt;filter&gt;("myCustomId");</code></td></tr><tr><td>Label</td><td>Same as the label of the associated list field.</td><td>Call
                <code class="code">addField(...).useCustomLabel("myCustomLabel").xxx(...);</code></td></tr><tr><td>Control</td><td>Is selected considering the type of the associated list
                field: <div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Type</th><th>Control</th></tr></thead><tbody><tr><td>
                            <code class="code">java.lang.String</code>
                          </td><td>
                            <code class="code">TextControl</code>
                          </td></tr><tr><td><code class="code">java.math.BigInteger</code>,
                          <code class="code">java.lang.Long</code>,
                          <code class="code">java.lang.Integer</code>,
                          <code class="code">java.lang.Short</code>,
                          <code class="code">java.lang.Byte</code></td><td>
                            <code class="code">NumberControl</code>
                          </td></tr><tr><td><code class="code">java.math.BigDecimal</code>,
                          <code class="code">java.lang.Double</code>,
                          <code class="code">java.lang.Float</code></td><td>
                            <code class="code">FloatControl</code>
                          </td></tr><tr><td>Other subclasses of
                          <code class="code">java.lang.Number</code></td><td>
                            <code class="code">FloatControl</code>
                          </td></tr><tr><td><code class="code">java.util.Date</code>,
                          <code class="code">java.sql.Date</code></td><td>
                            <code class="code">DateControl</code>
                          </td></tr><tr><td>
                            <code class="code">java.sql.Time</code>
                          </td><td>
                            <code class="code">TimeControl</code>
                          </td></tr><tr><td>
                            <code class="code">java.sql.Timestamp</code>
                          </td><td>
                            <code class="code">DateTimeControl</code>
                          </td></tr><tr><td>
                            <code class="code">java.lang.Boolean</code>
                          </td><td>
                            <code class="code">CheckboxControl</code>
                          </td></tr><tr><td>All others</td><td>
                            <code class="code">TextControl</code>
                          </td></tr></tbody></table></div></td><td>Call <code class="code">addField(...).xxx(new
                MyCustomControl());</code></td></tr><tr><td>Data</td><td>Corresponds to the type of the associated list
                field.</td><td>Call
                <code class="code">addField(...).useFieldType(MyType.class).xxx(...);</code></td></tr><tr><td>Initial value</td><td>Always <code class="code">null</code> to disable the filter by
                default.</td><td>After adding the field and the filter call
                <code class="code">myList.getForm().setValueByFullName("fieldId",
                customInitialValue);</code> or add a custom
                <code class="code">Formelement</code>.</td></tr><tr><td>Mandatory</td><td>Always <code class="code">false</code> as all search conditions are
                optional.</td><td>After adding the field and the filter call
                <code class="code">myList.getForm().getElementByFullName("fieldId").setMandatory(true);</code>
                or add a custom <code class="code">Formelement</code>.</td></tr><tr><td>FormElement</td><td>See all properties above.</td><td>To use a custom <code class="code">Formelement</code>, call
                <code class="code">addField(...).xxx(new MyCustomFormElement(...));</code>.
                To disable adding it at all, call
                <code class="code">addField(...)._xxx();</code> (notice the
                underscore).</td></tr></tbody></table></div><p> The <code class="code">xxx</code> marks any filter adding method.
      As one can count, there are 6 overridden methods for each list filter: 2
      versions for providing a custom Id or not and 3 versions for providing a
      custom <code class="code">FormElement</code>, <code class="code">Control</code> or neither of
      them. In addition there are methods that start with an
      <code class="literal">_</code> for disabling adding a form element. Using the
      <code class="code">FilterHelper</code> instead of <code class="code">FieldFilterHelper</code> is
      analogous except all filter adding methods take the list field Id as the
      first argument in addition.</p><p>It's import to notice that <code class="code">xxxxConst</code> methods do not
      create a form element because they are independent of the search form at
      all - they are constant. However they can actually take a value Id for
      the defined constants as well. These Ids can be used later to convert
      specific values when creating a database query. Of course non-constant
      filters have the same Ids but just use them mainly to get values from
      the search form. <code class="code">xxxxConst</code> filters have 2 overridden add
      methods depending on whether the custom value Id is provided or not. By
      default it's the same as the field Id.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e11667"></a>6.2.5.&nbsp;Backend Data Provider</h3></div></div></div><p>Now that we have demonstrated defining lists and also creating
      <code class="classname">MemoryBasedListDataProvider</code>, we will discover
      using <code class="classname">BackendListDataProvider</code>. The following
      example code should be in the same widget as constructing of the related
      <code class="classname">ListWidget</code>. </p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">private</span> <span class="syntax8">class</span> MyBackendListDataProvider <span class="syntax6">extends</span> BackendListDataProvider <span class="syntax11">{</span>
  <span class="syntax6">public</span> <span class="syntax9">MyBackendListDataProvider</span>() <span class="syntax11">{</span>
    <span class="syntax4">super</span>(<span class="syntax4">true</span>);
  <span class="syntax11">}</span>
  <span class="syntax6">protected</span> ListItemsData <span class="syntax9">getItemRange</span>(ListQuery query) <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax6">return</span> <span class="syntax9">lookupMyService</span>().<span class="syntax9">findMyModel</span>(query);
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
...
</span></pre></pre><p> The line <code class="literal">super(true)</code> constructs
      <code class="classname">BackendListDataProvider</code> with cache enabled (only
      used when there are no change in <span class="emphasis"><em>query</em></span>). Notice
      that there is no association with any <span class="emphasis"><em>JavaBean</em></span>
      class here. The method <code class="literal">ListItemsData getItemRange(ListQuery
      query)</code> implements loading current item range according to the
      range indexes and filtering and ordering conditions.
      <code class="classname">org.araneaframework.backend.list.mode.ListQuery</code>
      and
      <code class="classname">org.araneaframework.backend.list.mode.ListItemsData</code>
      may be thought as being input and output of each list data query.</p><p><code class="classname">ListQuery</code> is a simple JavaBean that holds
      the following properties: </p><div class="variablelist"><dl><dt><span class="term">List structure (since 1.1)</span></dt><dd>
            	The structure of the list contains all the list fields
            	and static information about the filtering and ordering.
            	(It is constructed once as the <code class="classname">ListWidget</code> is defined.)
            </dd><dt><span class="term">List item range indexes</span></dt><dd>
               This is 0-based start index and items count ( 
              <code class="classname">Long</code>
               objects) that define the range. By default, lists are shown by pages. Although all items can be shown at once also. Then the start index is zero and items count is omitted. 
            </dd><dt><span class="term">Filter and order info (since 1.1)</span></dt><dd>
               These contain the current filter and ordering data as instances of
               <code class="classname">Map</code> and <code class="classname">OrderInfo</code>.
            </dd><dt><span class="term">Filter and order expressions</span></dt><dd>
               These could be thought as an abstraction
               of SQL expressions which are constructed using the info described above
               (even the same instances). 
               These expressions will be used in the
               <code class="literal">WHERE</code> and <code class="literal">ORDER BY</code> clauses.
            </dd></dl></div><p>
        Generally, this whole object is just passed to
      <code class="classname">org.araneaframework.backend.list.helper.ListSqlHelper</code>
      class that is used to generate SQL statements and fetching the results
      from database. Latter is hold in <code class="classname">ListItemsData</code>
      object which is a simple JavaBean that holds the following properties:
      </p><div class="variablelist"><dl><dt><span class="term">List items range</span></dt><dd>
               Model objects that are the result of the 

              <span class="emphasis"><em>query</em></span>

               . 
            </dd><dt><span class="term">Total count</span></dt><dd>
               Total count ( 

              <code class="classname">Long</code>

               object) of the list. This is important information for navigating through the whole list. Notice that this depends only on filtering conditions. 
            </dd></dl></div><p>Notice that <code class="classname">BackendListDataProvider</code>
      actually do not depend on using databases. It just provides a simple
      <span class="emphasis"><em>query</em></span> object and expects a simple result to be
      returned. Thus, you have the power to use it as you like. At the same,
      Aranea provides a very useful class
      <code class="classname">org.araneaframework.backend.list.helper.ListSqlHelper</code>
      that generate SQL statements and fetches the results from database. We
      strongly recommend it together with its subclasses that support
      different database systems. Currently <code class="literal">Oracle</code>
      (<code class="classname">OracleListSqlHelper</code>),
      <code class="literal">Postgre</code> (<code class="literal">PostgreListSqlHelper</code>),
      and <code class="literal">HSQL</code> (<code class="classname">HsqlListSqlHelper</code>)
      databases are supported (they are used similarly because they all
      extend <code class="literal">ListSqlHelper</code>).</p><p>The following example discovers the simplest usage of
      <code class="classname">ListSqlHelper</code>. The following code should be in a
      service class instead of previously discovered Widget: </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MyService <span class="syntax11">{</span>
  ...
  <span class="syntax6">private</span> DataSource dataSource;
  ...
  <span class="syntax6">public</span> ListItemsData <span class="syntax9">findMyModel</span>(ListQuery query) <span class="syntax11">{</span>
    ListSqlHelper helper <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">OracleListSqlHelper</span>(<span class="syntax4">this</span>.dataSource, query);

    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"name"</span>, <span class="syntax3">"NAME"</span>);
    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"surname"</span>, <span class="syntax3">"SURNAME"</span>);
    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"PHONE_NO"</span>);

    helper.<span class="syntax9">setSimpleSqlQuery</span>(<span class="syntax3">"PERSON"</span>);
    <span class="syntax6">return</span> helper.<span class="syntax9">execute</span>(MyModel.<span class="syntax8">class</span>);
  <span class="syntax11">}</span>
  ...
<span class="syntax11">}</span>
</span></pre></pre><p>Method <code class="literal">ListItemsData findMyModel(ListQuery
      query)</code> does the following: </p><div class="variablelist"><dl><dt><span class="term">Constructs and initializes the helper</span></dt><dd>
               The line 

              <code class="literal">ListSqlHelper helper = new
              OracleListSqlHelper(this.dataSource, query)</code>

               constructs 

              <code class="classname">OracleListSqlHelper</code>

               - an Oracle specific 

              <code class="classname">ListSqlHelper</code>

               - and passes it the 

              <code class="classname">DataSource</code>

               and 

              <code class="classname">ListQuery</code>

               data. 
            </dd><dt><span class="term">Adds column mappings</span></dt><dd>
               The line 

              <code class="literal">helper.addMapping("name", "NAME")</code>

               defines that identifier of column "name" will be converted into 

              <code class="literal">"NAME"</code>

               when used in an SQL statement. There may be lot of differnece between JavaBean properties names and database fields names. The same database identifier ( 

              <code class="literal">"NAME"</code>

               ) is used when fetching data from 

              <code class="classname">ResultSet</code>

               by default. This could also have another identifier set by providing it as the third argument. 
            </dd><dt><span class="term">Provides the helper with a simple SQL query</span></dt><dd>
               The line 

              <code class="literal">helper.setSimpleSqlQuery("PERSON")</code>

               sets the whole SQL query with parameters using only the given database table name. Filtering and ordering is added automatically according to the 

              <code class="classname">ListQuery</code>

               data. 
            </dd><dt><span class="term">Executes the query and retrieve the data</span></dt><dd>
               The line 

              <code class="literal">return helper.execute(MyModel.class)</code>

               executes and retrieves data of both total count and items range queries. The 

              <code class="classname">ResultSet</code>

               is read using the default 

              <code class="classname">BeanResultReader</code>

               . 
            </dd></dl></div><p>The following example discovers the custom usage of
      <code class="classname">ListSqlHelper</code>. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MyService <span class="syntax11">{</span>
  ...
  <span class="syntax6">private</span> DataSource dataSource;
  ...
  <span class="syntax6">public</span> ListItemsData <span class="syntax9">findMyModel</span>(ListQuery query) <span class="syntax11">{</span>
    ListSqlHelper helper <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">OracleListSqlHelper</span>(<span class="syntax4">this</span>.dataSource, query);

    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"name"</span>, <span class="syntax3">"NAME"</span>);
    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"surname"</span>, <span class="syntax3">"SURNAME"</span>);
    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"PHONE_NO"</span>);

    StringBuffer s <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">StringBuffer</span>();
    s.<span class="syntax9">append</span>(<span class="syntax3">"SELECT "</span>);
    s.<span class="syntax9">append</span>(helper.<span class="syntax9">getDatabaseFields</span>());
    s.<span class="syntax9">append</span>(<span class="syntax3">" FROM PERSONS"</span>);
    s.<span class="syntax9">append</span>(helper.<span class="syntax9">getDatabaseFilterWith</span>(<span class="syntax3">" WHERE "</span>, <span class="syntax3">""</span>));
    s.<span class="syntax9">append</span>(helper.<span class="syntax9">getDatabaseOrderWith</span>(<span class="syntax3">" ORDER BY "</span>, <span class="syntax3">""</span>));

    helper.<span class="syntax9">setSqlQuery</span>(s.<span class="syntax9">toString</span>());
    helper.<span class="syntax9">addStatementParams</span>(helper.<span class="syntax9">getDatabaseFilterParams</span>());
    helper.<span class="syntax9">addStatementParams</span>(helper.<span class="syntax9">getDatabaseOrderParams</span>());

    <span class="syntax6">return</span> helper.<span class="syntax9">execute</span>(MyModel.<span class="syntax8">class</span>);
  <span class="syntax11">}</span>
  ...
<span class="syntax11">}</span>
</span></pre></pre><p>Method <code class="literal">ListItemsData findMyModel(ListQuery
      query)</code> does the following: </p><div class="variablelist"><dl><dt><span class="term">Constructs and initializes the helper</span></dt><dd>
               The line 

              <code class="literal">ListSqlHelper helper = new
              OracleListSqlHelper(this.dataSource, query)</code>

               constructs 

              <code class="classname">OracleListSqlHelper</code>

               - an Oracle specific 

              <code class="classname">ListSqlHelper</code>

               - and passes it the 

              <code class="classname">DataSource</code>

               and 

              <code class="classname">ListQuery</code>

               data. 
            </dd><dt><span class="term">Adds column mappings</span></dt><dd>
               The line 

              <code class="literal">helper.addMapping("name", "NAME")</code>

               defines that identifier of column "name" will be converted into 

              <code class="literal">"NAME"</code>

               when used in an SQL statement. There may be lot of differnece between JavaBean properties names and database fields names. The same database identifier ( 

              <code class="literal">"NAME"</code>

               ) is used when fetching data from 

              <code class="classname">ResultSet</code>

               by default. This could also have another identifier set by providing it as the third argument. 
            </dd><dt><span class="term">Gets SQL substrings from the helper</span></dt><dd>
               The line 

              <code class="literal">helper.getDatabaseFields()</code>

               returns just the comma-separated list of database column identifiers that were just defined in the mapping. This does not depend on the original set of list columns at all. The line 

              <code class="literal">helper.getDatabaseFilterWith(" WHERE ", "")</code>

               returns the 

              <code class="literal">WHERE</code>

               clause body with the provided prefix and suffix. It returns an empty string if there is no filter condition currently set (it does not mean there are no filters defined). Notice that we only deal with SQL strings here. As 

              <code class="classname">ListSqlHelper</code>

               uses 

              <code class="classname">PreparedStatement</code>

               objects to execute queries, there must be provided statement parameters in addition to the SQL string. This generally provides better performance of executing similar queries. 
            </dd><dt><span class="term">Constructs SQL query string</span></dt><dd><code class="literal">StringBuffer</code>

               is used to construct the whole SQL query string. Notice that the helper does not construct it totally by itself. This lends user more power for complex queries. It is very important that the constructed query is for getting all rows that match with the current filter and order conditions, but not the range conditions. 

              <code class="classname">ListSqlHelper</code>

               always executes two queries: one for getting the items count and another for getting the items range. Generally, both of these can be easily constructed from this one provided query. This implementation depends on the database system and therefore the concrete 

              <code class="classname">ListSqlHelper</code>

               subclass. 
            </dd><dt><span class="term">Gets SQL parameters from the helper</span></dt><dd>
               The line 

              <code class="literal">helper.getDatabaseFilterParams()</code>

               returns SQL parameters of 

              <code class="literal">WHERE</code>

               clause or empty list if there are none. 
            </dd><dt><span class="term">Provides the helper with the SQL query</span></dt><dd>
               The line 

              <code class="literal">helper.setSqlQuery(...)</code>

               sets the SQL string and the line 

              <code class="literal">helper.addStatementParams(...)</code>

               adds the query parameters ( 

              <code class="classname">ListSqlHelper</code>

               uses 

              <code class="classname">PreparedStatement</code>

               s). Of course, the order of parameters must match with the SQL string. 
            </dd><dt><span class="term">Executes the query and retrieve the data</span></dt><dd>
               The line 

              <code class="literal">return helper.execute(MyModel.class)</code>

               executes and retrieves data of both total count and items range queries. The 

              <code class="classname">ResultSet</code>

               is read using the default 

              <code class="classname">BeanResultReader.</code></dd></dl></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12003"></a>ListSqlHelper mappings and converters</h4></div></div></div><p>All Aranea List filters that are propagated with values from the
        filter form construct an expression chain. This chain is built each
        time any condition is changed. E.g if one is searching for persons
        whose birthday is between July 6th, 1950 and Sept 2nd, 1990 then
        there's one value 'Birthday' and two values 'July 6th, 1950' and 'Sept
        2nd, 1990' which have 'Birthday_start' and 'Birthday_end' as names.
        Ordering the list is done the same. When retrieving data from database
        all these information must be considered to build an appropriate
        query. Therefore all these variables must be mapped to database
        fields. When reading the query results Bean fields must be mapped to
        <code class="code">ResultSet</code> columns. In general, these Bean fields match
        exactly with the variables. But considering more specific cases, they
        are not assumed to be the same.</p><p>The following list covers the terms that are used when
        configuring <code class="code">ListSqlHelper</code>: </p><div class="variablelist"><dl><dt><span class="term">List field</span></dt><dd>
                 Each list has a set of fields (or columns) that are displayed.
                 All fields are listed up in the <code class="code">SELECT</code> clause.
                 Some of them can be used for filtering and ordering as well.
                 Field name can be e.g "birthday" or "group.name".
              </dd><dt><span class="term">Expression value</span></dt><dd>
                 Values are the temporary information in the list filtering. '1980-08-21' is a value.
                 'Birthday_start' is a name of that value.
                 In simple cases one list field matches with one value.
                 In case of the range filter two different values (start and end of the range) are used.
                 Also one value can be used together with two or more fields.
                 A value identifier is used for optional converting before using it in a query.
                 This is done by adding a <code class="code">Converter</code> object to <code class="code">ListSqlHelper</code>.
                 E.g. booleans have to be converted into numeric (0 or 1) values. 
              </dd><dt><span class="term">Database column</span></dt><dd>
                 Database column can be for example 'age' or 'company.name' as well as 'MAX(price)' or '(SELECT(COUNT(*) FROM document WHERE userId = user.id)' (an inner SELECT) - any expression that is part of a SQL string. 
              </dd><dt><span class="term">Database column alias</span></dt><dd>
                 Database field alias is for example 'name', 'total_price' etc.
                 It's just an identifier not a whole expression.
                 In 
                <code class="code">ListSqlHelper</code>
                 one can assign an alias for each database field or have it automatically generated. The result of a query is a table - a 
                <code class="code">ResultSet</code>
                 - which columns have the same names as the aliases in the query. An alias can also be used in a custom filter condition (WHERE clause) to identify the same database field or expression that was added in the SELECT clause. 
              </dd></dl></div><p><code class="literal">ListSqlHelper</code> methods for configuring
        mappings: </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Method</th><th>Purpose</th></tr></thead><tbody><tr><td><code class="literal">addMapping(String fieldName, String columnName, String columnAlias)</code></td><td>
                  Adds a <span class="emphasis"><em>field name</em></span> to database <span class="emphasis"><em>column name</em></span>
                  and <span class="emphasis"><em>column alias</em></span> mapping.
                  A given field is listed in the <code class="code">SELECT</code> and is read from the <code class="code">ResultSet</code>.
                  </td></tr><tr><td><code class="literal">addMapping(String fieldName, String columnName)</code></td><td>
                  Adds a <span class="emphasis"><em>field name</em></span> to database <span class="emphasis"><em>column name</em></span>
                  and <span class="emphasis"><em>column alias</em></span> mapping.
                  A given field is listed in the <code class="code">SELECT</code> and is read from the <code class="code">ResultSet</code>.
                  The corresponding <span class="emphasis"><em>column alias</em></span> is generated automatically.
                  </td></tr><tr><td><code class="literal">addDatabaseFieldMapping(String fieldName, String columnName, String columnAlias)</code></td><td>
                  Adds a <span class="emphasis"><em>field name</em></span> to database <span class="emphasis"><em>column name</em></span>
                  and <span class="emphasis"><em>column alias</em></span> mapping.
                  A given field is listed in the <code class="code">SELECT</code> but is not read from the <code class="code">ResultSet</code>.
                  </td></tr><tr><td><code class="literal">addDatabaseFieldMapping(String fieldName, String columnName)</code></td><td>
                  Adds a <span class="emphasis"><em>field name</em></span> to database <span class="emphasis"><em>column name</em></span>
                  mapping.
                  A given field is listed in the <code class="code">SELECT</code> but is not read from the <code class="code">ResultSet</code>.
                  The corresponding <span class="emphasis"><em>column alias</em></span> is generated automatically.
                  </td></tr><tr><td><code class="literal">addResultSetMapping(String fieldName, String columnAlias)</code></td><td>
                  Adds a <span class="emphasis"><em>field name</em></span> to database <span class="emphasis"><em>column alias</em></span>
                  mapping.
                  A given field is not listed in the <code class="code">SELECT</code> but is read from the <code class="code">ResultSet</code>.
                  </td></tr></tbody></table></div><p><code class="literal">ListSqlHelper</code> methods for configuring
        converters: </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Method</th><th>Purpose</th></tr></thead><tbody><tr><td><code class="literal">addDatabaseFieldConverter(String value,
                  Converter converter)</code></td><td>Adds converter for expression value.</td></tr><tr><td><code class="literal">addResultSetDeconverterForBeanField(String
                  beanField, Converter converter)</code></td><td>Adds deconverter for <code class="code">ResultSet</code> column by
                  list field that is mapped with that Column.</td></tr><tr><td><code class="literal">addResultSetDeconverterForColumn(String
                  rsColumn, Converter converter)</code></td><td>Adds deconverter for <code class="code">ResultSet</code>
                  column.</td></tr></tbody></table></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12211"></a>ListSqlHelper naming strategies</h4></div></div></div><p>Since Aranea MVC 1.1 ListSqlHelper also support naming strategies.
        This means that one do not need to define database column names and aliases
        for all list fields.
        Instead only list fields are listed up and they can be transformed into
        database column names and aliases using a <span class="emphasis"><em>strategy</em></span>.
        </p><p>A <span class="emphasis"><em>strategy</em></span> is defined by the following interface. 
<code class="classname">NamingStrategy</code>. </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> NamingStrategy <span class="syntax11">{</span>
        String <span class="syntax9">fieldToColumnName</span>(String fieldName);
        String <span class="syntax9">fieldToColumnAlias</span>(String fieldName);
<span class="syntax11">}</span>
</span></pre></pre><p>
			To set or get a <span class="emphasis"><em>strategy</em></span> use methods
			<code class="code">ListSqlHelper.setNamingStrategy(NamingStrategy namingStrategy)</code> or
			<code class="code">ListSqlHelper.getNamingStrategy()</code> respectfully.
		</p><p>
        The standard implementation <code class="classname">StandardNamingStrategy</code>
        adds underscores to all names (e.g. "firstName" -&gt; "first_name").
        
        For an alias all dots are converted into underscores
        (e.g. "parent.friend.age" -&gt; "parent_friend_age").
        For a name all dots except the last are converted into underscores
        (e.g. "parent.friend.age" -&gt; "parent_friend.age", so "parent_friend" is expected to be a table alias).
        </p><p>
        	If one wishes to define table aliases for the naming strategy
        	<code class="classname">PrefixMapNamingStrategy</code> (enabled by default) can be used.
        	By using method <code class="code">addPrefix(String fieldNamePrefix, String columnNamePrefix)</code>
        	one can add a custom prefix for database columns and aliases.
        	An instance of <code class="classname">PrefixMapNamingStrategy</code> can be retrieved by
        	method <code class="code">ListSqlHelper.getPrefixMapNamingStrategy()</code>.
        </p><p>
        	As naming strategies still expect a set of list fields to be defined
        	there is a way to add list fields without any mappings. 
        </p><p>A set of fields are provided by following interface.
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> Fields <span class="syntax11">{</span>
        Collection <span class="syntax9">getNames</span>();
        Collection <span class="syntax9">getResultSetNames</span>();
<span class="syntax11">}</span>
</span></pre></pre><p>
			To set or get a <span class="emphasis"><em>fields provider</em></span> use methods
			<code class="code">ListSqlHelper.setFields(Fields fields)</code> or
			<code class="code">ListSqlHelper.getFields()</code> respectfully.
		</p><p>
			A standard implementation <code class="classname">StandardFields</code>
			enables to add fields using the following methods.
		</p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Method</th><th>Purpose</th></tr></thead><tbody><tr><td><code class="literal">addField(String field)</code></td><td>Adds a field by its name.</td></tr><tr><td><code class="literal">addFields(String[] fields)</code></td><td>Adds a set of fields by their names.</td></tr><tr><td><code class="literal">addFields(Collection fields)</code></td><td>Adds a set of fields by their names.</td></tr><tr><td><code class="literal">addFields(Class beanClass)</code></td><td>Adds all the fields of the Bean class.</td></tr><tr><td><code class="literal">addFields(ListStructure structure)</code></td><td>Adds all the fields defined in the <span class="emphasis"><em>list structure</em></span>.</td></tr></tbody></table></div><p>
          		There are also corresponding methods to add fields using a prefix and
          		methods to remove the fields (using a prefix or not).
          </p><p>
          		To get the <code class="classname">StandardFields</code> call
          		<code class="code">ListSqlHelper.getStandardFields()</code>.
          </p><p>The following example shows how to just list up the fields
      (the corresponding column names and aliases are generated by the naming strategy).
      Because the column "phone" has a "non-standard" column name, it is set separately.
      </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MyService <span class="syntax11">{</span>
  ...
  <span class="syntax6">public</span> ListItemsData <span class="syntax9">findMyModel</span>(ListQuery query) <span class="syntax11">{</span>
    ListSqlHelper helper <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">OracleListSqlHelper</span>(<span class="syntax4">this</span>.dataSource, query);

    StandardFields fields <span class="syntax11">=</span> helper.<span class="syntax9">getStandardFields</span>();
    fields.<span class="syntax9">addField</span>(<span class="syntax3">"name"</span>);
    fields.<span class="syntax9">addField</span>(<span class="syntax3">"surname"</span>);

    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"PHONE_NO"</span>);

    helper.<span class="syntax9">setSimpleSqlQuery</span>(<span class="syntax3">"PERSON"</span>);
    <span class="syntax6">return</span> helper.<span class="syntax9">execute</span>(MyModel.<span class="syntax8">class</span>);
  <span class="syntax11">}</span>
  ...
<span class="syntax11">}</span>
</span></pre></pre><p>If all fields described for the <code class="classname">ListWidget</code> should be used
      they can be added using the <code class="classname">ListStructure</code>
      contained in the <code class="classname">ListQuery</code>:
      </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> MyService <span class="syntax11">{</span>
  ...
  <span class="syntax6">public</span> ListItemsData <span class="syntax9">findMyModel</span>(ListQuery query) <span class="syntax11">{</span>
    ListSqlHelper helper <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">OracleListSqlHelper</span>(<span class="syntax4">this</span>.dataSource, query);

    helper.<span class="syntax9">getStandardFields</span>().<span class="syntax9">addFields</span>(query.<span class="syntax9">getListStructure</span>());
    
    helper.<span class="syntax9">addMapping</span>(<span class="syntax3">"phone"</span>, <span class="syntax3">"PHONE_NO"</span>);

    helper.<span class="syntax9">setSimpleSqlQuery</span>(<span class="syntax3">"PERSON"</span>);
    <span class="syntax6">return</span> helper.<span class="syntax9">execute</span>(MyModel.<span class="syntax8">class</span>);
  <span class="syntax11">}</span>
  ...
<span class="syntax11">}</span>
</span></pre></pre></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12353"></a>6.2.6.&nbsp;Quick Overview on How to Use</h3></div></div></div></div><p>Here is a quick summary on how one can create and use a list,
		based on the material described in this chapter.
			</p><div class="orderedlist"><ol type="1" compact><li><span class="emphasis"><em>Create a data query.</em></span> This basically means a service layer method
		      that takes at least a <code class="literal">ListQuery</code> for its argument, executes the
		      database query, and returns <code class="literal">ListItemsData</code>. To execute the query,
		      one must also specify the binding between model object fields and query result set fields.
		    </li><li><span class="emphasis"><em>Create a list widget.</em></span> The (bean) list widget is used to define
		      the columns and its labels together with sorting and filtering information. Also, one
		      must define a data provider &#8212; either memory-based or back-end &#8212; that invokes
		      the data query created previously. Note that the data provider implementation
		      provides the <code class="literal">ListQuery</code> object (containing information about the list,
		      the constraints, and the rows expected) for the query, and expects a
		      <code class="literal">ListItemsData</code> object as a result. Finally, the created list must be
		      added by its creator widget simply like following:
		      <code class="code">this.addWidget("myList", createdList);</code></li><li><span class="emphasis"><em>Describe the layout in JSP.</em></span> Here you can use the list tags
		      provided by Aranea. These are described below.
		    </li></ol></div><p>
		</p></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="SelectingListRows"></a>6.3.&nbsp;Selecting List Rows</h2></div></div></div><p>
    This section shows how a user can choose list rows with a check box or a radio button.
    The solution described here is also integrated into Aranea lists, so it is quite easy to use.
    Firstly, Aranea provides a check box tag (<code class="literal">&lt;ui:listRowCheckBox/&gt;</code>)
    and a radio button tag (<code class="literal">&lt;ui:listRowRadioButton/&gt;</code>) for list rows.
    These are meant for the user to check multiple rows or just one row to submit them
    once the user clicks on a button. Usually, these tags don't require any attributes
    (unless one needs to customize style or javascript), and work only with the list where they
    are used, even if there are multiple lists on the page.
    </p><p>
		In addition, Aranea provides a tag that selects or unselects all row check boxes in
		the list. It is named <code class="literal">&lt;ui:listSelectAllCheckBox/&gt;</code>. Again, it
		requires zero configuration.
		</p><p>
		Now, these tags are useful because the next step is just getting the model objects from
		the list with the <code class="literal">ListWidget.getSelectedRows()</code> method. Or, if a
		radio button was used, and, therefore, only one selected row is expected, the
		<code class="literal">ListWidget.getSelectedRow()</code> method can be used. If no rows were
		selected then <code class="literal">getSelectedRows()</code> would return an empty list, and
		<code class="literal">getSelectedRow()</code> would return <code class="literal">null</code>.
		</p><p>
		There is also an advanced feature in case the list row check boxes are used. One
		can make the list remember the selected rows in case the user switches between
		the (list) pages. It can be achieved by calling
		<code class="literal">list.setSelectFromMultiplePages(true)</code> (by default it is
		<code class="literal">false</code>). Once enabled, the list and the tags use the
		<code class="literal">equals()</code> method of the list row data object to know whether
		the row must be checked or unchecked. Therefore, when the user goes back to the
		list page where some rows were selected before then they would still appear selected. 
		</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
		Enabling the <code class="literal">selectFromMultiplePages</code> option, that makes list
		remember previously selected rows, requires caution because the data model objects
		needs to have the <code class="literal">equals()</code> to correctly compare them. Otherwise,
		the "same" object could appear several times in the returned selected rows list.
		This is the reason why it is turned off by default.
		</div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="ListJSPTags"></a>6.4.&nbsp;List JSP Tags</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12442"></a>6.4.1.&nbsp;&lt;ui:list&gt;</h3></div></div></div><p>Starts a list context. List view model, list sequence view model
      and list id are made accessible to inner tags as EL variables.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12447"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>no</em></span></td><td>List widget id.</td></tr><tr><td>varSequence</td><td><span class="emphasis"><em>no</em></span></td><td>Name of variable that represents list sequence info (by
                default <span class="emphasis"><em>listSequence</em></span>).</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12483"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>list</td><td>View model of list.</td><td align="center"><code class="literal">ListWidget.ViewModel</code></td></tr><tr><td>listSequence (unless changed with
                <span class="emphasis"><em>varSequence</em></span> attribute).</td><td>View model of list sequence info.</td><td align="center"><code class="literal">SequenceHelper.ViewModel</code></td></tr><tr><td>listId</td><td>Id of list.</td><td align="center"><code class="literal">String</code></td></tr><tr><td>listFullId</td><td>Full id of list.</td><td align="center"><code class="literal">String</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12535"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
    ...
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12540"></a>6.4.2.&nbsp;&lt;ui:listFilter&gt;</h3></div></div></div><p>Represents list filter. Introduces an implicit form
      (&lt;ui:form&gt;), so one can place form elements under it.</p><p><span class="emphasis"><em>This tag has no attributes.</em></span></p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12548"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput id</span>=<span class="syntax3">"field1Filter"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:textInput id</span>=<span class="syntax3">"field2Filter"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>

        ...

    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12553"></a>6.4.3.&nbsp;&lt;ui:listFilterButton&gt; and &lt;ui:listFilterClearButton&gt;</h3></div></div></div><p>
       <code class="literal">&lt;ui:listFilterButton&gt;</code> 
       renders list's filter form filtering activation button and registers a keyboard handler, so that 
       pressing <code class="literal">ENTER</code> key in any filter form field activates list filtering. 
       <code class="literal">&lt;ui:listFilterClearButton&gt;</code> 
       renders list's filter form clearing button, pressing it sends server-side event that clears all active list filters.
       </p><p>
       Both of these tags must be used inside <code class="literal">&lt;ui:listFilter&gt;</code>
       tag. 
       </p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12572"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>renderMode</td><td><span class="emphasis"><em>no</em></span></td><td>Possible values are <code class="literal">button</code>, <code class="literal">input</code>&#8212;filter button is rendered with corresponding HTML tags, or <code class="literal">empty</code> in which case JSP author must provide suitable content for this tag by themself (with an image, for example). Default rendermode is <code class="literal">button</code>.</td></tr><tr><td>onClickPrecondition</td><td><span class="emphasis"><em>no</em></span></td><td>Precondition for deciding whether registered onclick
                event should go server side or not. If left unspecified, this
                is considered to be <code class="literal">true</code>.</td></tr><tr><td>showLabel</td><td><span class="emphasis"><em>no</em></span></td><td>Indicates whether button label is shown.Value should be
                <code class="literal">true</code> or <code class="literal">false</code>, default
                is <code class="literal">false</code>&#8212;using <code class="literal">true</code> is pointless with these particular tags, it only has some effect
                when specified <code class="literal">renderMode</code> is <code class="literal">empty</code> and tags body is left empty too.</td></tr></tbody></table></div><span class="emphasis"><em>Also have all common form element rendering attributes plus standard <code class="literal">style</code> and <code class="literal">styleClass</code> attributes.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12654"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
...
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
      <span class="syntax1">&lt;!-- Bunch of filter fields in cells --&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listFilterButton/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listFilterClearButton/</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12659"></a>6.4.4.&nbsp;&lt;ui:listRows&gt;</h3></div></div></div><p>Iterating tag that gives access to each row on the current list
      page. The row is by default accessible as EL variable
      <span class="emphasis"><em>row</em></span>.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12667"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>var</td><td><span class="emphasis"><em>no</em></span></td><td>Name of variable that represents individual row (by
                default "row").</td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12692"></a>Variables</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col align="center"></colgroup><thead><tr><th>Variable</th><th>Description</th><th align="center">Type</th></tr></thead><tbody><tr><td>row (unless changed with <span class="emphasis"><em>var</em></span>
                attribute).</td><td>Object held in current row.</td><td align="center"><code class="literal">Object</code></td></tr></tbody></table></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12720"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
    ...
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
  
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listRows</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
        <span class="syntax1">&lt;!-- In each row, object in this list row is accessible --&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:out value</span>=<span class="syntax3">"${row.field1}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>

        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
            <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:out value</span>=<span class="syntax3">"${row.field2}"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>

        ...
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listRows</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12725"></a>6.4.5.&nbsp;&lt;ui:listRowButton&gt;</h3></div></div></div><p>Represents an HTML form button (not tied to any
      <code class="literal">Control</code> or <code class="literal">FormElement</code>). Default
      <code class="literal">styleClass="aranea-button"</code>, rendered with HTML
      <code class="literal">&lt;button ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12742"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>eventId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Event triggered when button is clicked.</td></tr><tr><td>id</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Button id, allows to access button from
                JavaScript.</td></tr><tr><td>labelId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Id of button label.</td></tr><tr><td>onClickPrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether onclick event should
                go server side or not. If left unspecified this is set to
                <code class="literal">return true;</code>.</td></tr><tr><td>tabindex</td><td><span class="emphasis"><em>no</em></span></td><td>This attribute specifies the position of the current element in the tabbing order for the current document. This value must be a number between 0 and 32767.</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">styleClass</code>,
        <code class="literal">updateRegions</code> and
        <code class="literal">globalUpdateRegions</code> attributes.</em></span></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12821"></a>6.4.6.&nbsp;&lt;ui:listRowLinkButton&gt;</h3></div></div></div><p>Represents a HTML link with an <code class="literal">onClick</code>
      JavaScript event. Default
      <code class="literal">styleClass="aranea-link-button"</code>, rendered with HTML
      <code class="literal">&lt;a href="javascript:" ...&gt;</code> tag.</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12835"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>eventId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Event triggered when link is clicked.</td></tr><tr><td>id</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Link id, allows to access link from JavaScript.</td></tr><tr><td>labelId</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Id of link label.</td></tr><tr><td>onClickPrecondition</td><td>
                  <span class="emphasis"><em>no</em></span>
                </td><td>Precondition for deciding whether onclick event should
                go server side or not. If left unspecified this is set to
                <code class="literal">return true;</code>.</td></tr><tr><td>tabindex</td><td><span class="emphasis"><em>no</em></span></td><td>This attribute specifies the position of the current element in the tabbing order for the current document. This value must be a number between 0 and 32767.</td></tr></tbody></table></div><span class="emphasis"><em>Also has standard <code class="literal">styleClass</code>,
        <code class="literal">updateRegions</code> and
        <code class="literal">globalUpdateRegions</code> attributes.</em></span></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12914"></a>Examples</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
  ...  
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listRows</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
      ...
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listRowLinkButton eventId</span>=<span class="syntax3">"edit"</span><span class="syntax10">&gt;</span>
          <span class="syntax10">&lt;</span><span class="syntax10">img src</span>=<span class="syntax3">"editButton.png"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listRowLinkButton</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
      ...
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listRows</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e12919"></a>6.4.7.&nbsp;&lt;ui:listRowCheckBox&gt; And &lt;ui:listRowRadioButton&gt;</h3></div></div></div><p>
      Represents a list row check box and a list row radio button that are bound to
      the list row. The <code class="literal">&lt;ui:listRowCheckBox&gt;</code> accompanies
      with the <code class="literal">&lt;ui:listSelectAllCheckBox&gt;</code> that lets the
      user mark all list row check boxes (in the same list) checked or unchecked.
      </p><p>
			Both <code class="literal">&lt;ui:listRowCheckBox&gt;</code> and
			<code class="literal">&lt;ui:listRowRadioButton&gt;</code> usually require no configuration. 
			However, if one needs to change something, the tags provide similar attributes.
			</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e12938"></a>Attributes</h4></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>value</td><td><span class="emphasis"><em>no</em></span></td><td>(Check box only!) Specifies a custom value (when it is submitted).
                Default value is <code class="literal">selected</code>.</td></tr><tr><td>labelId</td><td><span class="emphasis"><em>no</em></span></td><td>Specifies a custom label for the check box or the radio button.</td></tr><tr><td>disabled</td><td><span class="emphasis"><em>no</em></span></td><td>Specifies whether the input should be rendered as disabled. Default is active state.</td></tr><tr><td>onclick</td><td><span class="emphasis"><em>no</em></span></td><td>Specifies custom <code class="literal">onclick</code> event. Default is none.</td></tr><tr><td>accessKey</td><td><span class="emphasis"><em>no</em></span></td><td>Specifies custom <code class="literal">acceskey</code> (defined by HTML). Default is none.</td></tr><tr><td>checked</td><td><span class="emphasis"><em>no</em></span></td><td>Specifies the initial state of the check box or radio button. Default is unchecked.</td></tr><tr><td>tabindex</td><td><span class="emphasis"><em>no</em></span></td><td>This attribute specifies the position of the current element in the tabbing order for the current document. This value must be a number between 0 and 32767.</td></tr><tr><td>style</td><td><span class="emphasis"><em>no</em></span></td><td>Inline (CSS) style for HTML tag.</td></tr><tr><td>styleClass</td><td><span class="emphasis"><em>no</em></span></td><td>CSS class for the tag.</td></tr><tr><td>onChangeEventId</td><td><span class="emphasis"><em>no</em></span></td><td>The event handler name (in the parent widget of the list) that wants to know when a row selection changes. The parameter for the event handler is the <code class="literal">rowRequestId</code>.</td></tr><tr><td>eventPrecondition</td><td><span class="emphasis"><em>no</em></span></td><td>A JavaScript event precondition on whether the <code class="literal">onchange</code> event should go server-side.</td></tr></tbody></table></div></div><p>
				See also <a href="#SelectingListRows" title="6.3.&nbsp;Selecting List Rows">Section&nbsp;6.3, &#8220;Selecting List Rows&#8221;</a>
			</p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="EditableLists"></a>6.5.&nbsp;Editable Lists</h2></div></div></div><p>
     <code class="literal">EditableListWidget</code> and <code class="literal">EditableBeanListWidget</code> are <code class="literal">ListWidgets</code> 
     wrapped around <code class="literal">FormListWidget</code> (See <a href="#form_lists" title="5.3.&nbsp;Form Lists">Section&nbsp;5.3, &#8220;Form Lists&#8221;</a> about it) which gathers data 
     with the help from <code class="literal">ListWidget</code>.
     </p><p>
     Both editable list widgets have just one constructor and one additional getter (compared to <code class="literal">ListWidget</code>):
     </p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax9">EditableListWidget</span>(FormRowHandler rowHandler);
<span class="syntax6">public</span> <span class="syntax9">EditableBeanListWidget</span>(FormRowHandler rowHandler, Class beanClass);

<span class="syntax1">// gets the wrapped form list</span>
<span class="syntax6">public</span> BeanFormListWidget <span class="syntax9">getFormList</span>();
</span></pre></pre><p>
</p><p>
        Most important component of editable lists is <code class="literal">FormListWidget</code>'s <code class="literal">RowHandler</code>, refer to <a href="#form_lists" title="5.3.&nbsp;Form Lists">Section&nbsp;5.3, &#8220;Form Lists&#8221;</a>
        about implementing that interface. Other than required implementation of <code class="literal">RowHandler</code>, editable lists do not
        differ from <code class="literal">ListWidget</code>s.
    </p><p>
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">class</span> SampleEditableListWidget <span class="syntax11">{</span>
  <span class="syntax6">private</span> EditableBeanListWidget list;
  
  <span class="syntax6">protected</span> <span class="syntax8">void</span> <span class="syntax9">init</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax9">setViewSelector</span>(<span class="syntax3">"sampleEditableListView"</span>);
    
    list <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">EditableBeanListWidget</span>(<span class="syntax9">buildFormRowHandler</span>(), SomeBean.<span class="syntax8">class</span>);
    list.<span class="syntax9">setDataProvider</span>(<span class="syntax9">buildListDataProvider</span>());
    list.<span class="syntax9">setOrderableByDefault</span>(<span class="syntax4">true</span>);
    <span class="syntax1">// list has only two columns of which only one is editable</span>
    list.<span class="syntax9">addField</span>(<span class="syntax3">"immutable"</span>, <span class="syntax3">"#ImmutableColumnLabel"</span>, <span class="syntax4">false</span>);
    list.<span class="syntax9">addField</span>(<span class="syntax3">"mutable"</span>, <span class="syntax3">"#MutableColumnLabel"</span>).<span class="syntax9">like</span>();

    <span class="syntax9">addWidget</span>(<span class="syntax3">"sampleEditableList"</span>, list);
  <span class="syntax11">}</span>
  
  <span class="syntax6">private</span> FormRowHandler <span class="syntax9">buildFormRowHandler</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax1">// return formRowHandler, see the form list example</span>
  <span class="syntax11">}</span>;
  
  <span class="syntax6">private</span> <span class="syntax6">private</span> ListDataProvider <span class="syntax9">buildListDataProvider</span>() <span class="syntax6">throws</span> Exception <span class="syntax11">{</span>
    <span class="syntax1">// return data provider</span>
  <span class="syntax11">}</span>
<span class="syntax11">}</span>
</span></pre></pre><p>
    </p><p>
        JSP view for this sample widget is presented below:
</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax11">&lt;</span>ui:formList id<span class="syntax11">=</span><span class="syntax3">"sampleEditableList"</span><span class="syntax11">&gt;</span>
  <span class="syntax11">&lt;!--</span> List filter definition, usual <span class="syntax11">--&gt;</span>
  <span class="syntax11">&lt;!--</span> Editable lists body <span class="syntax11">--&gt;</span>
  <span class="syntax11">&lt;</span>ui:formListRows<span class="syntax11">&gt;</span>
    <span class="syntax11">&lt;</span>ui:row<span class="syntax11">&gt;</span>
      <span class="syntax11">&lt;</span>ui:cell<span class="syntax11">&gt;</span>
        <span class="syntax11">&lt;!--</span> Row object is accessible as <span class="syntax3">'row'</span> just as in lists <span class="syntax11">--&gt;</span>
        <span class="syntax11">&lt;</span>c:out value<span class="syntax11">=</span><span class="syntax3">"${row.immutable}"</span><span class="syntax11">/&gt;</span>
      <span class="syntax11">&lt;/</span>ui:cell<span class="syntax11">&gt;</span>
      <span class="syntax11">&lt;</span>ui:cell<span class="syntax11">&gt;</span>
        <span class="syntax11">&lt;!--</span> But the implicit form tag <span class="syntax6">for</span> current row form is also present, so... <span class="syntax11">--&gt;</span>
        <span class="syntax11">&lt;</span>ui:formElement id<span class="syntax11">=</span><span class="syntax3">"mutable"</span><span class="syntax11">&gt;</span>
          <span class="syntax11">&lt;</span>ui:textInput<span class="syntax11">/&gt;</span>
        <span class="syntax11">&lt;/</span>ui:formElement<span class="syntax11">&gt;</span>
      <span class="syntax11">&lt;/</span>ui:cell<span class="syntax11">&gt;</span>
    <span class="syntax11">&lt;/</span>ui:row<span class="syntax11">&gt;</span>
  <span class="syntax11">&lt;/</span>ui:formListRows<span class="syntax11">&gt;</span>
<span class="syntax11">&lt;/</span>ui:formList<span class="syntax11">&gt;</span>
...
</span></pre></pre><p>
    </p><p>
      Full editable list example is bundled with Aranea examples.
    </p></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="uilibwchapter"></a>Chapter&nbsp;7.&nbsp;Other Uilib Widgets</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="trees"></a>7.1.&nbsp;Trees</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="treewidget_and_treenodewidget"></a>7.1.1.&nbsp;TreeWidget &amp; TreeNodeWidget</h3></div></div></div><p>
           	<code class="classname">org.araneaframework.uilib.tree.TreeWidget</code> allows representation of hierarchical data in a manner that has become 
			traditional in GUIs, as an expandable/collapsable tree. <code class="literal">TreeWidget</code> represents trees' root node, which is special 
			in that it is not usually really rendered on-screen but serves as point where child nodes are attached. 
			Child nodes of <code class="literal">TreeWidget</code>
			are <code class="literal">TreeNodeWidget</code>s acquired from associated <code class="literal">TreeDataProvider</code> or could be attached by the developer.
			The <code class="literal">TreeWidget</code> supports expanding and collapsing of all those nodes.
           </p><p>
           <code class="literal">TreeDataProvider</code> is a simple interface with ability to return data belonging to any given node of the tree.
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">public</span> <span class="syntax8">interface</span> TreeDataProvider <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>
  <span class="syntax2">/**</span>
<span class="syntax2">   * Returns a list of child nodes for specified parent node.</span>
<span class="syntax2">   </span><span class="syntax2">*/</span>
  List<span class="syntax11">&lt;</span>TreeNodeWidget<span class="syntax11">&gt;</span> <span class="syntax9">getChildren</span>(TreeNodeContext parent);

  <span class="syntax2">/**</span>
<span class="syntax2">   * Returns whether the specified tree node has any children.</span>
<span class="syntax2">   </span><span class="syntax2">*/</span>
  <span class="syntax8">boolean</span> <span class="syntax9">hasChildren</span>(TreeNodeContext parent);
<span class="syntax11">}</span>
</span></pre></pre><p>
           </p><p>
           	As is apparent from the definition of <code class="literal">TreeDataProvider</code>, descendants of the <code class="literal">TreeWidget</code>
           	that are to be presented in a tree, must be of type <code class="literal">TreeNodeWidget</code>. <code class="literal">TreeNodeWidget</code>
           	is the superclass of <code class="literal">TreeWidget</code> that also has child nodes and will be rendered too. Node rendering is done with
           	display widget that is passed to <code class="literal">TreeNodeWidget</code> in its constructor. 
           	
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax2">/**</span><span class="syntax2"> Childless collapsed node, rendered by display widget. </span><span class="syntax2">*/</span>
<span class="syntax6">public</span> <span class="syntax9">TreeNodeWidget</span>(Widget display);
<span class="syntax2">/**</span><span class="syntax2"> Node with children. Expanded by default. </span><span class="syntax2">*/</span>
<span class="syntax6">public</span> <span class="syntax9">TreeNodeWidget</span>(Widget display, List nodes);
<span class="syntax2">/**</span><span class="syntax2"> Node with children, expand/collapse state can be set with corresponding flag. </span><span class="syntax2">*/</span>
<span class="syntax6">public</span> <span class="syntax9">TreeNodeWidget</span>(Widget display, List nodes, <span class="syntax8">boolean</span> collapsed);
</span></pre></pre><p>

			Display widget can be any widget that can render itself, it is rendered in the place of tree node instead of
			<code class="literal">TreeNodeWidget</code>, which is just a data holder. Very often, display widget is <code class="literal">BaseUIWidget</code>
			 which renders itself according to some JSP template.
           	
           	<code class="literal">TreeNodeWidget</code> does not accept independent <code class="literal">TreeDataProvider</code>, its children are acquired 
           	from <code class="literal">TreeWidget</code>'s <code class="literal">TreeDataProvider</code>.
           </p><p>
           		<code class="literal">TreeWidget</code> enriches the <code class="literal">Environment</code> with <code class="literal">TreeContext</code>.
           		<code class="literal">TreeNodeWidget</code> enriches the <code class="literal">Environment</code> of its display widget
           		with <code class="literal">TreeNodeContext</code>. Through these contexts display widgets have access to
           		owning tree node and root of the tree.
           </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="treeJSPtags"></a>7.1.2.&nbsp;Tree JSP tags</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e13222"></a>&lt;ui:tree&gt;</h4></div></div></div><p>Renders tree with given id.</p><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e13227"></a>Attributes</h5></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>ID of the tree widget.</td></tr></tbody></table></div></div><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e13252"></a>Examples</h5></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:tree id</span>=<span class="syntax3">"simpleTree"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax1">&lt;!-- nothing more required, nodes' display widgets will take care of rendering the tree nodes.&gt;</span>
</span></pre></pre></div></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tabs"></a>7.2.&nbsp;Tabs</h2></div></div></div>
     Tabs provide the tabbed interface for switching between different content. 

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="TabContainerWidget"></a>7.2.1.&nbsp;TabContainerWidget</h3></div></div></div><p>
		<code class="literal">TabContainerWidget</code> manages widgets that are to be displayed and manipulated in separate tabs.
		It provides basic operations like adding, removing, disabling, enabling and switching between tabs. 
		Its main operation mode is stateful, where switching between tabs preserves state in inactive tabs. It can be 
		made to operate statelessly (or with custom state management) by constructing new tab with <code class="literal">WidgetFactory</code>
		instead of <code class="literal">Widget</code>.
		</p><p>
		Following methods are available for adding tabs:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">void</span> <span class="syntax9">addTab</span>(String id, String labelId, Widget contentWidget);
<span class="syntax8">void</span> <span class="syntax9">addTab</span>(String id, Widget labelWidget, Widget contentWidget);
<span class="syntax8">void</span> <span class="syntax9">addTab</span>(String id, String labelId, WidgetFactory contentWidgetFactory);
<span class="syntax8">void</span> <span class="syntax9">addTab</span>(String id, Widget labelWidget, WidgetFactory contentWidgetFactory);
</span></pre></pre><p>
		</p><p>
			And for common tab operations:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax8">boolean</span> <span class="syntax9">removeTab</span>(String id);
<span class="syntax8">boolean</span> <span class="syntax9">disableTab</span>(String id);
<span class="syntax8">boolean</span> <span class="syntax9">enableTab</span>(String id);
<span class="syntax8">boolean</span> <span class="syntax9">selectTab</span>(String id);
</span></pre></pre><p>
		</p><p>
			For its children, TabContainerWidget is accessible from <code class="literal">Environment</code> as <code class="literal">TabContainerContext</code>.
		</p><p>
			Since Aranea 1.2.2, one can also add a tab switch listener. The listener is invoked right before the current tab is about to be
			replaced with a new tab. Here note that the current tab may be <code class="literal">null</code> (when the <code class="literal">selectTab()</code>
			method was not called before). The listener is defined as a sub-interface of <code class="literal">TabContainerContext</code>:
		</p><pre class="programlisting"><pre><span class="syntax0">
  <span class="syntax2">/**</span>
<span class="syntax2">   * An interface for tab switch listeners. Tab switch occurs when the currently</span>
<span class="syntax2">   * selected tab changes.</span>
<span class="syntax2">   * </span><span class="syntax5">@since</span><span class="syntax2"> 1.2.2</span>
<span class="syntax2">   </span><span class="syntax2">*/</span>
  <span class="syntax8">interface</span> TabSwitchListener <span class="syntax6">extends</span> Serializable <span class="syntax11">{</span>

    <span class="syntax2">/**</span>
<span class="syntax2">     * A listener for tab switching. Before the selected tab will be replaced</span>
<span class="syntax2">     * with a new one, this method is called to check whether the switch is</span>
<span class="syntax2">     * allowed. Note that the </span><span class="syntax10">&lt;</span><span class="syntax10">code</span><span class="syntax10">&gt;</span><span class="syntax2">selectedTab</span><span class="syntax10">&lt;</span><span class="syntax10">/code</span><span class="syntax10">&gt;</span><span class="syntax2"> parameter may be</span>
<span class="syntax2">     * </span><span class="syntax10">&lt;</span><span class="syntax10">code</span><span class="syntax10">&gt;</span><span class="syntax2">null</span><span class="syntax10">&lt;</span><span class="syntax10">/code</span><span class="syntax10">&gt;</span><span class="syntax2"> if no tab is currently selected.</span>
<span class="syntax2">     * </span><span class="syntax10">&lt;</span><span class="syntax10">p</span><span class="syntax10">&gt;</span>
<span class="syntax2">     * The last parameter is a tab switch closure that is executed only when the</span>
<span class="syntax2">     * listener returns </span><span class="syntax10">&lt;</span><span class="syntax10">code</span><span class="syntax10">&gt;</span><span class="syntax2">true</span><span class="syntax10">&lt;</span><span class="syntax10">/code</span><span class="syntax10">&gt;</span><span class="syntax2"> or when the listener executes it</span>
<span class="syntax2">     * itself. Therefore, this closure can also be used with</span>
<span class="syntax2">     * {</span><span class="syntax5">@link</span><span class="syntax2"> ConfirmationContext#confirm(Closure, String)}.</span>
<span class="syntax2">     * </span>
<span class="syntax2">     * </span><span class="syntax5">@param</span><span class="syntax2"> selectedTab The currently selected tab. May be </span><span class="syntax10">&lt;</span><span class="syntax10">code</span><span class="syntax10">&gt;</span><span class="syntax2">null</span><span class="syntax10">&lt;</span><span class="syntax10">/code</span><span class="syntax10">&gt;</span><span class="syntax2">.</span>
<span class="syntax2">     * </span><span class="syntax5">@param</span><span class="syntax2"> newTab The tab that will replace the current one.</span>
<span class="syntax2">     * </span><span class="syntax5">@param</span><span class="syntax2"> switchClosure A closure that handles tab switch.</span>
<span class="syntax2">     * </span><span class="syntax5">@return</span><span class="syntax2"> </span><span class="syntax10">&lt;</span><span class="syntax10">code</span><span class="syntax10">&gt;</span><span class="syntax2">true</span><span class="syntax10">&lt;</span><span class="syntax10">/code</span><span class="syntax10">&gt;</span><span class="syntax2">, if the switch is allowed.</span>
<span class="syntax2">     </span><span class="syntax2">*/</span>
    <span class="syntax8">boolean</span> <span class="syntax9">onSwitch</span>(TabWidget selectedTab, TabWidget newTab, Closure switchClosure);

  <span class="syntax11">}</span>     
</span></pre></pre><p>
		The default implementation is <code class="literal">DefaultTabSwitchListener</code>, which basically corresponds to the default behaviour.
		However, one can easily write and set their own handler for a tab container. In addition, the <code class="literal">switchClosure</code> parameter
		helps integrating this solution with the <a href="#ConfirmationContext" title="2.8.7.&nbsp;ConfirmationContext">ConfirmationContext</a>.
	</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="TabJsptags"></a>7.2.2.&nbsp;Tab JSP tags</h3></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="uitabcontainer"></a>&lt;ui:tabContainer&gt;</h4></div></div></div><p>
				Opens the tab container context and renders the labels for all tabs inside this container.
			</p><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="uitabcontainerattrs"></a>Attributes</h5></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>ID of the tab container widget.</td></tr></tbody></table></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="uitabbody"></a>&lt;ui:tabBody&gt;</h4></div></div></div><p>
    			Renders the body of currently active (selected) tab. Must be used inside tab container context.
    		</p></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="uitabs"></a>&lt;ui:tabs&gt;</h4></div></div></div><p>
    			Renders specified tab container fully&#8212;writes out tab labels and active tab's content.
    		</p><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="uitabsattrs"></a>Attributes</h5></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>ID of the tab container widget.</td></tr></tbody></table></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="tabtagexamples"></a>Usage of tab tags in JSP templates.</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:tabs id</span>=<span class="syntax3">"tabContainer"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>

<span class="syntax1">&lt;!-- equivalent to previous, but one could add custom content before and after tab body --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:tabContainer id</span>=<span class="syntax3">"tabContainer"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:tabBody/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:tabContainer</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="contextmenu"></a>7.3.&nbsp;Context Menu</h2></div></div></div>
     Context menu is the menu that pops up when mouse right-click is made 
     on some item (widget) in an UI.

    <div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ContextMenuWidget_ContextMenuItem"></a>7.3.1.&nbsp;ContextMenuWidget &amp; ContextMenuItem</h3></div></div></div><p>
			Widget that represents context menu content is called <code class="literal">ContextMenuWidget</code>. By convention, it is
			usually added to component hierarchy as a child of the widget for which it provides context menu.
</p><pre class="programlisting"><pre><span class="syntax0">widgetWithContextMenu.<span class="syntax9">addWidget</span>(<span class="syntax3">"contextmenu"</span>, <span class="syntax6">new</span> <span class="syntax9">ContextMenuWidget</span>(...));
</span></pre></pre><p>	
		</p><p>
			<code class="literal">ContextMenuWidget</code> sole constructor has a single <code class="literal">ContextMenuItem</code> parameter.
			<code class="literal">ContextMenuItem</code> is a hierarchical container for menu items, consisting of menu entries and entry
			labels. There are two types of menu entries: <code class="literal">ContextMenuEventEntry</code> and <code class="literal">ContextMenuActionEntry</code> 
			&#8212;which respectively produce events (see  <a href="#EventListeners" title="2.7.2.&nbsp;Event Listeners">Section&nbsp;2.7.2, &#8220;Event Listeners&#8221;</a>) or actions (see <a href="#actionlisteners" title="2.7.3.&nbsp;Action Listeners">Section&nbsp;2.7.3, &#8220;Action Listeners&#8221;</a>)  
			upon selection of context menu item. Except for produced event type, these entries are constructed identically.
			
			Creating context menu entry which tries to invoke widget event listener of <code class="literal">someWidget</code> without supplying
			any event parameters is done as follows:</p><pre class="programlisting"><pre><span class="syntax0">ContextMenuEntry entry <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">ContextMenuEventEntry</span>(<span class="syntax3">"someEvent"</span>, someWidget);
</span></pre></pre><p>
		</p><p>
			When menu entry produced event requires some parameters, 
			javascript function must be defined that returns desired parameters. When left undefined,
			<code class="literal">function() { return null; }</code> is used. Sample javascript function which always
			returns value of some fixed DOM element as event parameter looks like this:
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax6">var</span> contextMenuEventParameterSupplier <span class="syntax11">=</span> <span class="syntax6">function</span>() <span class="syntax11">{</span>
  <span class="syntax1">// make sure that function call was really triggered by menu selection</span>
  <span class="syntax6">if</span> (araneaContextMenu<span class="syntax11">.</span><span class="syntax9">getTriggeringElement</span>()) <span class="syntax11">{</span>
    <span class="syntax1">// supply value of DOM element 'someElement' as event parameter</span>
    <span class="syntax6">return</span> <span class="syntax9">$</span>(<span class="syntax3">'someElement'</span>)<span class="syntax11">.</span>value<span class="syntax11">;</span>
  <span class="syntax11">}</span>
  <span class="syntax6">return</span> <span class="syntax4">null</span><span class="syntax11">;</span>
<span class="syntax11">};</span>
</span></pre></pre><p>
		</p><p>Corresponding menu entry which detects and submits event parameters is created similarly to previous:
		</p><pre class="programlisting"><pre><span class="syntax0">ContextMenuEntry entry <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">ContextMenuEventEntry</span>(<span class="syntax3">"someEvent"</span>, someWidget, <span class="syntax3">"contextMenuEventParameterSupplier"</span>);
</span></pre></pre><p>
		</p><p>
			Whole construction of single multi-element and multi-level <code class="literal">ContextMenuWidget</code> will look similar to this:
</p><pre class="programlisting"><pre><span class="syntax0">ContextMenuItem root <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">ContextMenuItem</span>();
<span class="syntax1">// entry that produces event when clicked on</span>
ContextMenuItem firstEntry <span class="syntax11">=</span> 
  <span class="syntax6">new</span> <span class="syntax9">ContextMenuItem</span>(
    <span class="syntax9">getL10nCtx</span>().<span class="syntax9">localize</span>(<span class="syntax3">"someLabel"</span>), <span class="syntax1">// label </span>
    <span class="syntax6">new</span> <span class="syntax9">ContextMenuEventEntry</span>(<span class="syntax3">"someEvent"</span>, <span class="syntax4">this</span>));
<span class="syntax1">// entry that just functions as submenu</span>
ContextMenuItem secondEntry <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">ContextMenuItem</span>(<span class="syntax9">getL10nCtx</span>().<span class="syntax9">localize</span>(<span class="syntax3">"submenu"</span>));
<span class="syntax1">// action producing entry in a submenu</span>
ContextMenuItem thirdEntry <span class="syntax11">=</span> 
  <span class="syntax6">new</span> <span class="syntax9">ContextMenuItem</span>(
    <span class="syntax9">getL10nCtx</span>().<span class="syntax9">localize</span>(<span class="syntax3">"someOtherLabel"</span>), 
    <span class="syntax6">new</span> <span class="syntax9">ContextMenuActionEntry</span>(<span class="syntax3">"someAction"</span>, <span class="syntax4">this</span>, <span class="syntax3">"contextMenuActionParameterSupplier"</span>));
secondEntry.<span class="syntax9">addMenuItem</span>(thirdEntry);
root.<span class="syntax9">addMenuItem</span>(firstEntry);
root.<span class="syntax9">addMenuItem</span>(secondEntry);
</span></pre></pre><p>
		</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="ContextMenuJSP"></a>7.3.2.&nbsp;Rendering context menus with JSP template</h3></div></div></div>
    	
    	To get functional context menus on client-side, template must define the sections belonging to a widget which has the context
    	menu and register the context menu. Context menus are known to work in Internet Explorer and Mozilla Firefox browsers.

    	<div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="uicontextmenu"></a>&lt;ui:contextMenu&gt;</h4></div></div></div><p>
    			Registers the context menu in current template for widget with <code class="literal">id</code>.
    		</p><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="uicontextmenuattrs"></a>Attributes</h5></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>ID of the <code class="literal">ContextMenuWidget</code></td></tr><tr><td>updateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Regions which should be updated when context menu event has been processed.</td></tr><tr><td>globalUpdateRegions</td><td><span class="emphasis"><em>no</em></span></td><td>Global regions which should be updated when context menu event has been processed.</td></tr></tbody></table></div></div></div><p>
    	As one widget might be rendered in separate sections in a template, all these sections need to be identified so that
    	correct context menu can be detected at all times. This is done with <code class="literal">&lt;ui:widgetMarker&gt;</code> tag
    	surrounding the widget sections.
    	</p><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="uiwidgetmarker"></a>&lt;ui:widgetMarker&gt;</h4></div></div></div><p>
    			Defines the surrounded section as belonging to a widget with <code class="code">id</code>. It writes out some
    			HTML tag with <code class="literal">class</code> attribute value set to <code class="literal">widgetMarker</code>.
    		</p><div class="sect4" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="uiwidgetmarkerattrs"></a>Attributes</h5></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Attribute</th><th>Required</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td><span class="emphasis"><em>yes</em></span></td><td>ID of the widget which section is surrounded by this marker tag.</td></tr><tr><td>tag</td><td><span class="emphasis"><em>no</em></span></td><td>HTML tag to render the marker with. Default is HTML <code class="literal">div</code>.</td></tr></tbody></table></div></div></div><div class="sect3" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="contextmenuexamples"></a>Example: JSP template containing context menu.</h4></div></div></div><pre class="programlisting"><pre><span class="syntax0"><span class="syntax1">&lt;!-- Defines context menu for a ListWidget "list" --&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:list id</span>=<span class="syntax3">"list"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span> ... <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listFilter</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:listRows</span><span class="syntax10">&gt;</span>
    <span class="syntax1">&lt;!-- marker surrounding widget with identifier "list" --&gt;</span>  
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:widgetMarker id</span>=<span class="syntax3">"list"</span><span class="syntax10"> tag</span>=<span class="syntax3">"tbody"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row id</span>=<span class="syntax3">"${listFullId}.row${rowRequestId}"</span><span class="syntax10">&gt;</span>
                <span class="syntax1">&lt;!-- cells --&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:widgetMarker</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:listRows</span><span class="syntax10">&gt;</span>

  <span class="syntax1">&lt;!-- Context menu widget with conventional id --&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:contextMenu id</span>=<span class="syntax3">"list.contextmenu"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:list</span><span class="syntax10">&gt;</span>
</span></pre></pre></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="PartialRendering"></a>7.4.&nbsp;Partial Rendering</h2></div></div></div><p>
	Imagine that you have a big web page with input form, and you want certain input controls
	to update something on that page as user changes the value of the control. Now, would it be
	efficient if the value changes, its <code class="code">onchange</code> event submits the data so that an
	<code class="code">OnChangeEventListener</code> could read it and return the same page with slight changes?
	The main problem here is that a small change should not force the user wait until the page
	reloads. Here is the part where partial rendering comes in.
	</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
		Partial rendering is more thoroughly described by Alar Kvell's bachelor thesis
		<a href="http://www.araneaframework.org/docs/kvell-aranea-ajax.pdf" target="_top">Aranea Ajax</a>.
		This section concentrates mostly on how a programmer can make partial rendering work.
		</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="The_Two_Steps"></a>7.4.1.&nbsp;The Two Steps</h3></div></div></div><p>
		First of all, a page must have a part (parts) that needs to be updated when an event occurs.
		These regions are marked with the <code class="code">&lt;ui:updateRegion&gt;</code> tag by also indicating
		its ID to reference it later.
		</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
			It is not possible to update an HTML table cell. One needs to update the
			entire row by using the <code class="code">&lt;ui:updateRegionRows&gt;</code> tag. 
			</p></div><p>
		Next, one needs to specify the <code class="code">updateRegions</code> attribute of the input control
		that has an event registered. The attribute value should contain a comma-separated list of
		update region IDs that need to be update due to the event. It is important for this value to
		be specified, because otherwise the entire page would be posted to the server.
		</p><p>
		When the input control has the <code class="code">updateRegions</code> attribute defined, Aranea will use
		Ajax to send the form data to the server, invoke the <code class="code">OnEventListener</code> associated
		with the event, and return the parts of the pages defined as update regions. Finally,
		the script on the client side will replace the update regions on the page with the received
		ones. For everything else on the same page, it will remain the same.
		</p><p>
		Note that these two steps described above are all that need to be taken to make partial rendering
		possible with Aranea.
		</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="Partial_Rendering_Example"></a>7.4.2.&nbsp;Partial Rendering Example</h3></div></div></div><p>
		Now let's take a look at a short example where partial rendering is used. The following is the code
		snippet from Aranea demo application component <span class="emphasis"><em>Easy AJAX w/ 'update regions'</em></span>.

		</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"beastSelection"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell styleClass</span>=<span class="syntax3">"name"</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:label /</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:select updateRegions</span>=<span class="syntax3">"ajaxBeasts"</span><span class="syntax10">/</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>

<span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:updateRegionRows id</span>=<span class="syntax3">"ajaxBeasts"</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax5">c</span><span class="syntax10">:if test</span>=<span class="syntax3">"${not empty form.elements['concreteBeastControl']}"</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:formElement id</span>=<span class="syntax3">"concreteBeastControl"</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell styleClass</span>=<span class="syntax3">"centered-name"</span><span class="syntax10">&gt;</span>
          <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:label /</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
          <span class="syntax10">&lt;</span><span class="syntax5">ui</span><span class="syntax10">:checkboxMultiSelect type</span>=<span class="syntax3">"vertical"</span><span class="syntax10"> /</span><span class="syntax10">&gt;</span>
        <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:cell</span><span class="syntax10">&gt;</span>
      <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:formElement</span><span class="syntax10">&gt;</span>
    <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:row</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">c</span><span class="syntax10">:if</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/</span><span class="syntax5">ui</span><span class="syntax10">:updateRegionRows</span><span class="syntax10">&gt;</span>
</span></pre></pre><p>

		In the example, you can see that it does not matter in which order the update region
		is declared and referenced. Also, because data (form elements) is displayed using table rows,
		we must use <code class="code">&lt;ui:updateRegionRows&gt;</code> tag here to make it work. However,
		the most important part of this example is that the <code class="code">&lt;ui:select&gt;</code>
		control defines the update region it wishes to update.
		</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
			Currently file upload inputs don't work with update regions because the JavaScript cannot
			read the unsubmitted file and serialize it to send it to the server. Therefore, if you
			provide the <code class="code">updateRegions</code> attribute for a file upload input, the file won't
			reach the server. We hope to find a solution to this limitation in near future.
			</p></div></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="integration"></a>Chapter&nbsp;8.&nbsp;Third-party Integration</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13641"></a>8.1.&nbsp;Spring Application Framework</h2></div></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13644"></a>8.1.1.&nbsp;BeanFactory, ApplicationContext, WebApplicationContext</h3></div></div></div><p><code class="literal">AraneaSpringDispatcherServlet</code> will always add a
      BeanFactory to the environment. It can be retrieved as follows: </p><pre class="programlisting"><pre><span class="syntax0">BeanFactory beanFactory <span class="syntax11">=</span> 
  (BeanFactory) <span class="syntax9">getEnvironment</span>().<span class="syntax9">getEntry</span>(BeanFactory.<span class="syntax8">class</span>)
</span></pre></pre><p>Or using the method <code class="literal">getBeanFactory()</code> in
      <code class="literal">BaseUIWidget</code>. By default it will contain only beans
      configured by Aranea, however if one also uses usual Spring
      configuration:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax10">&lt;</span><span class="syntax10">context-param</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">param-name</span><span class="syntax10">&gt;</span>contextConfigLocation<span class="syntax10">&lt;</span><span class="syntax10">/param-name</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">param-value</span><span class="syntax10">&gt;</span> 
    /WEB-INF/services.xml
  <span class="syntax10">&lt;</span><span class="syntax10">/param-value</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/context-param</span><span class="syntax10">&gt;</span>
...
<span class="syntax10">&lt;</span><span class="syntax10">listener</span><span class="syntax10">&gt;</span>
  <span class="syntax10">&lt;</span><span class="syntax10">listener-class</span><span class="syntax10">&gt;</span>
    org.springframework.web.context.ContextLoaderListener
  <span class="syntax10">&lt;</span><span class="syntax10">/listener-class</span><span class="syntax10">&gt;</span>
<span class="syntax10">&lt;</span><span class="syntax10">/listener</span><span class="syntax10">&gt;</span>
...
</span></pre></pre><p>Then the <code class="literal">AraneaSpringDispatcherServlet</code> will
      integrate with Spring and make <code class="literal">BeanFactory</code> provide
      all of the configure beans, as well as add
      <code class="literal">ApplicationContext</code> and
      <code class="literal">WebApplicationContext</code> to the environment.</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p><code class="literal">AraneaSpringDispatcherServlet</code> must be
        initialized after Spring context loader listener or servlet to
        integrate with Spring successfully.</p></div></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="araneaLocalizationFilter"></a>8.1.2.&nbsp;Spring Localization Filter</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td align="right"><span class="bold"><strong>Java
              class:</strong></span></td><td><code class="literal">SpringLocalizationFilterService</code></td></tr><tr><td align="right"><span class="bold"><strong>Default configuration
              name:</strong></span></td><td>-</td></tr><tr><td align="right"><span class="bold"><strong>Provides:</strong></span></td><td><code class="literal">LocalizationContext</code>,
              <code class="literal">SpringLocalizationContext</code></td></tr><tr><td align="right"><span class="bold"><strong>Depends
              on:</strong></span></td><td><code class="literal">WebApplicationContext</code></td></tr></tbody></table></div><p>Provides localization services, see <a href="#LocalizationContext" title="2.8.2.&nbsp;LocalizationContext">Section&nbsp;2.8.2, &#8220;LocalizationContext&#8221;</a>. The difference from the <a href="#araneaLocalizationFilter" title="8.1.2.&nbsp;Spring Localization Filter">usual localization filter</a> is
      that this one delegates the actual localization to a Spring
      <code class="literal">MessageSource</code>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e13730"></a>8.1.3.&nbsp;Widget Dependency Injection</h3></div></div></div><p>Aranea does not by default support configuring widgets with
      Spring, as they are assumed to be created by the programmer and their
      life-cycle is managed by Aranea. The main problem however is that
      widgets are assumed to be serializable and Spring beans are often not
      (especially since they often are proxies with references to bean factory
      and so on). As a solution we provide a utility class SpringInjectionUtil
      that allows to inject Spring beans after a following convention:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax9">injectSomeSpringBean</span>(ISomeBean someBean) <span class="syntax11">{</span>
  <span class="syntax4">this</span>.someBean <span class="syntax11">=</span> someBean;
<span class="syntax11">}</span>
...
</span></pre></pre><p>This method is similar to a setter method, but starts with
      "inject". The remainder of the method name is interpreted as the name of
      Spring bean to be injected, with the first letter lowercase (in the case
      of our example bean named "someSpringBean" would be injected). To
      actually inject the beans to all similarly called methods in the current
      widget call <code class="literal">injectBeans()</code> in widget
      <code class="literal">init()</code> method as follows:</p><pre class="programlisting"><pre><span class="syntax0">...
<span class="syntax6">protected</span> <span class="syntax9">init</span>() <span class="syntax11">{</span>
  ...
  SpringInjectionUtil.<span class="syntax9">injectBeans</span>(<span class="syntax9">getEnvironment</span>(), <span class="syntax4">this</span>);
<span class="syntax11">}</span>
...
</span></pre></pre><p>You may even put this call into the base widget of your
      application to ensure that all application widgets would get their
      dependencies injected.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The injected bean must be an interface, as Aranea will construct
        an indirection proxy. This will ensure that the referenced object will
        be serializable (and small for that matter), but will also introduce
        a small performance penalty (we believe to be negligible next to the
        proxies of Spring itself).</p></div></div></div></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="javascript"></a>Chapter&nbsp;9.&nbsp;Javascript Libraries</h2></div></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e13756"></a>9.1.&nbsp;Third-party Javascript Libraries</h2></div></div></div><p>
           Aranea distribution includes some third party Javascript libraries. Most of these are not needed for using Aranea 
           functionality, but extend the functionality of both framework and <span class="emphasis"><em>UiLib</em></span>.
           </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><span class="emphasis"><em>Behaviour</em></span> library was removed since 1.2.1 because it was out-of-date and because
				<span class="emphasis"><em>Prototype</em></span> can now do its work. To reduce the scripts on the client-side, it was
				reasonable to avoid <span class="emphasis"><em>Behaviour</em></span>.</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="dhtmlcalendar"></a>9.1.1.&nbsp;The DHTML Calendar (<a href="http://www.dynarch.com/projects/calendar/" target="_top">http://www.dynarch.com/projects/calendar/</a>)</h3></div></div></div><p>
               Nice DHTML calendar, required if one wants to use Aranea JSP <span class="emphasis"><em>&lt;ui:dateInput&gt;</em></span> or <span class="emphasis"><em>&lt;ui:dateTimeInput&gt;</em></span> tags.
            </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="prototype"></a>9.1.2.&nbsp;Prototype (<a href="http://www.prototypejs.org/" target="_top">http://www.prototypejs.org/</a>)</h3></div></div></div><p>
               Prototype is a JavaScript framework that aims to ease development of dynamic web applications. Aranea partial rendering
               model uses its <span class="emphasis"><em>XMLHttpRequest</em></span> facilities for generating requests and defining update callbacks. 
               It is also needed for using Uilib's <span class="emphasis"><em>AutoCompleteTextControl</em></span> and action-enabled 
               <span class="emphasis"><em>TreeWidget</em></span> components.
            </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="scriptaculous"></a>9.1.3.&nbsp;script.aculo.us (<a href="http://script.aculo.us/" target="_top">http://script.aculo.us/</a>)</h3></div></div></div><p>
               script.aculo.us provides easy-to-use, cross-browser user interface JavaScript libraries. Only subset of script.aculo.us
               libraries are included&#8212; JSP tags that depends on them are <span class="emphasis"><em>&lt;ui:autoCompleteTextInput&gt;</em></span>
               and <span class="emphasis"><em>&lt;ui:tooltip&gt;</em></span>.
            </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="tinymce"></a>9.1.4.&nbsp;TinyMCE (<a href="http://tinymce.moxiecode.com/" target="_top">http://tinymce.moxiecode.com/</a>)</h3></div></div></div><p>
               TinyMCE is a platform independent web based Javascript HTML WYSIWYG editor control. Required for using Aranea 
               JSP <span class="emphasis"><em>&lt;ui:richTextarea&gt;</em></span> tag.
            </p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="prototip"></a>9.1.5.&nbsp;Prototip (<a href="http://www.nickstakenburg.com/projects/prototip/" target="_top">http://www.nickstakenburg.com/projects/prototip/</a>)</h3></div></div></div><p>
          	  Prototip allows to easily create both simple and complex tooltips using the Prototype javascript 
          	  framework. If one also uses Scriptaculous some nice effects can be added. This is required when
          	  using JSP <span class="emphasis"><em>&lt;ui:tooltip&gt;</em></span> tag.
          	</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="modalbox"></a>9.1.6.&nbsp;ModalBox (<a href="http://www.wildbit.com/labs/modalbox/" target="_top">http://www.wildbit.com/labs/modalbox/</a>)</h3></div></div></div><p>
          	  ModalBox is a JavaScript technique for creating modern modal dialogs or even wizards 
          	  (sequences of dialogs) without using conventional popups and page reloads.
          	</p></div><div class="sect2" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="log4javascript"></a>9.1.7.&nbsp;log4javascript (<a href="http://log4javascript.org/" target="_top">http://log4javascript.org/</a>)</h3></div></div></div><p>
	            Note that this is now deprecated in favour of <a href="http://www.getfirebug.com/" target="_top">Firebug's</a> built in 
	            logging facilities. Logging to Firebug console is enabled with <span class="emphasis"><em>AraneaPage.setFirebugLogger()</em></span>.
            </p><p>
               log4javascript is a JavaScript logging framework similar to Java logging framework log4j. 
               Include log4javascript
               scripts and call <span class="emphasis"><em>araneaPage().setDefaultLogger()</em></span> to receive a popup window where
               Aranea JS debug output is logged. When <a href="www.getfirebug.com" target="_top">Firebug</a> is active, its 
               logging to its console can be activated with <span class="emphasis"><em>AraneaPage.setFirebugLogger()</em></span>.
            </p></div></div><div class="sect1" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aranea_clientside_js"></a>9.2.&nbsp;Aranea Clientside Javascript</h2></div></div></div><p>
			Aranea uses javascript to do form submits. The code is sent to the client-side in compressed form. The script
			enables AJAX enabled webapps and provides more control over form submitting logic. Each page served by Aranea has
			associated <span class="emphasis"><em>AraneaPage</em></span> object:
		</p><p>
</p><pre class="programlisting"><pre><span class="syntax0"><span class="syntax1">/**</span>
<span class="syntax1"> *  Exactly one AraneaPage object is present on each page served by Aranea and</span>
<span class="syntax1"> *  contains common functionality for setting page related variables, events and</span>
<span class="syntax1"> *  functions.</span>
<span class="syntax1"> */</span>

<span class="syntax1">// Servlet URL is set on every page load.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getServletURL</span>()<span class="syntax11">;</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setServletURL</span>(url)<span class="syntax11">;</span>

<span class="syntax1">// If servlet URL is not enough for some purposes, encoding function should be overwritten.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">encodeURL</span>(url)

<span class="syntax1">// Indicates whether the page is completely loaded or not. Page is considered to</span>
<span class="syntax1">// be loaded when all system onload events have completed execution.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">isLoaded</span>()
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setLoaded</span>(b)

<span class="syntax1">// Dummy logger is practically no logger.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setDummyLogger</span>()

<span class="syntax1">// Makes Aranea scripts use log4javascript logger.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setDefaultLogger</span>()

<span class="syntax1">// Makes Aranea scripts use Firebug logger.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setFirebugLogger</span>()

<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setLogger</span>(theLogger)
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getLogger</span>()

<span class="syntax1">// locale - should be used only for server-side reported locale.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getLocale</span>()
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setLocale</span>(locale)

<span class="syntax1">// Indicates whether some form on page is (being) submitted already</span>
<span class="syntax1">// by traditional HTTP request.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">isSubmitted</span>()
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setSubmitted</span>()

<span class="syntax1">// Returns the active system form in this AraneaPage</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getSystemForm</span>()

<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setSystemForm</span>(_systemForm)
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setSystemFormEncoding</span>(encoding)

<span class="syntax1">// Returns the path of the component who should receive events generated by DOM element.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getEventTarget</span>(element)

<span class="syntax1">// Returns event id that should be sent to server when event(element) is called.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getEventId</span>(element) <span class="syntax11">{</span>

<span class="syntax1">// Returns event parameter that should be sent to server when event(element) is called.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getEventParam</span>(element)

<span class="syntax1">// Returns update regions that should be sent to server when event(element) is called.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getEventUpdateRegions</span>(element)

<span class="syntax1">// Returns closure that should be evaluated when event(element) is called and</span>
<span class="syntax1">// needs to decide whether server-side event invocation is needed.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getEventPreCondition</span>(element)

<span class="syntax1">// Adds a load event listener that is executed once when the page loaded.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">addSystemLoadEvent</span>(event)

<span class="syntax1">// Adds a load event listener that is executed once when the page or part of it is loaded.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">addClientLoadEvent</span>(event)

<span class="syntax1">// Adds a unload event listener that is executed once when the page unloaded.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">addSystemUnLoadEvent</span>(event)

<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">onload</span>()
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">onunload</span>()

<span class="syntax1">// Adds callback executed before next form submit. */</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">addSubmitCallback</span>(callback)

<span class="syntax1">// Add callback executed before form with given id is submitted next time.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">addSystemFormSubmitCallback</span>(systemFormId<span class="syntax11">,</span> callback) <span class="syntax11">{</span>

<span class="syntax1">// Executes all callbacks that should run before submitting the form with given id.</span>
<span class="syntax1">// Executed callbacks are removed.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">executeCallbacks</span>(systemFormId)

<span class="syntax1">// Chooses appropriate submitting method and submittable form given the HTML element</span>
<span class="syntax1">// that initiated the submit request. Applies the appropriate parameter values</span>
<span class="syntax1">// and submits the systemForm which owns the element.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">event</span>(element)

<span class="syntax1">// Returns either form submitter, AJAX submitter, or overlay submitter.</span>
<span class="syntax1">// This function can be overwritten to support additional submit methods.</span>
<span class="syntax1">// It is called by event() to determine the appropriate form submitter.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">findSubmitter</span>(element<span class="syntax11">,</span> systemForm)

<span class="syntax1">// Another submit function, takes all params that are possible to use with Aranea JSP currently.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">event_6</span>(systemForm<span class="syntax11">,</span> eventId<span class="syntax11">,</span> eventTarget<span class="syntax11">,</span> eventParam<span class="syntax11">,</span> eventPrecondition<span class="syntax11">,</span> eventUpdateRegions)

<span class="syntax1">// Returns URL that can be used to invoke full HTTP request with some predefined request parameters.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getSubmitURL</span>(topServiceId<span class="syntax11">,</span> threadServiceId<span class="syntax11">,</span> araTransactionId<span class="syntax11">,</span> extraParams)

<span class="syntax1">// Returns URL that can be used to make server-side action-invoking</span>
<span class="syntax1">// XMLHttpRequest with some predefined request parameters.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getActionSubmitURL</span>(systemForm<span class="syntax11">,</span> actionId<span class="syntax11">,</span> actionTarget<span class="syntax11">,</span> actionParam<span class="syntax11">,</span> sync<span class="syntax11">,</span> extraParams)

<span class="syntax1">// Invokes server-side action listener by performing XMLHttpRequest with correct parameters.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">action</span>(element<span class="syntax11">,</span> actionId<span class="syntax11">,</span> actionTarget<span class="syntax11">,</span> actionParam<span class="syntax11">,</span> actionCallback<span class="syntax11">,</span> options<span class="syntax11">,</span> sync<span class="syntax11">,</span> extraParams)

<span class="syntax1">// Invokes server-side action listener by performing XMLHttpRequest with correct parameters.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">action_6</span>(systemForm<span class="syntax11">,</span> actionId<span class="syntax11">,</span> actionTarget<span class="syntax11">,</span> actionParam<span class="syntax11">,</span> actionCallback<span class="syntax11">,</span> options<span class="syntax11">,</span> sync<span class="syntax11">,</span> extraParams)

<span class="syntax1">// Method to log a message at DEBUG level.</span>
<span class="syntax1">// A shortcut for araneaPage().getLogger().debug(message).</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">debug</span>(message)

<span class="syntax1">// Adds keepalive function f that is executed periodically after time milliseconds has passed.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span>addKeepAlive<span class="syntax11">:</span> <span class="syntax6">function</span>(f<span class="syntax11">,</span> time)

<span class="syntax1">// Clears/removes all registered keepalive functions.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">clearKeepAlives</span>()

<span class="syntax1">// Returns the flag that determines whether background validation is used by</span>
<span class="syntax1">// for all forms (FormWidgets) in the application.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">getBackgroundValidation</span>()

<span class="syntax1">// Proivdes a way to turn on/off background validation. The parameter is a boolean.</span>
<span class="syntax9">araneaPage</span>()<span class="syntax11">.</span><span class="syntax9">setBackgroundValidation</span>(useAjax)

<span class="syntax1">// ============================================================================</span>
<span class="syntax1">//                           STATIC METHODS</span>
<span class="syntax1">// ============================================================================</span>

<span class="syntax1">// Returns a default keepalive function -- to make periodical requests to</span>
<span class="syntax1">// expiring thread or top level services.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">getDefaultKeepAlive</span>(topServiceId<span class="syntax11">,</span> threadServiceId<span class="syntax11">,</span> keepAliveKey)

<span class="syntax1">// Searches for widget marker around the given element. If found, returns the</span>
<span class="syntax1">// marker DOM element, else returns null.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">findWidgetMarker</span>(element)

<span class="syntax1">// Random request ID generator. Sent only with XMLHttpRequests which apply to</span>
<span class="syntax1">// certain update regions. Currently its only purpose is easier debugging</span>
<span class="syntax1">// (identifying requests).</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">getRandomRequestId</span>()

<span class="syntax1">// Returns the full URL for importing given file.</span>
<span class="syntax1">// The same URL that &lt;ui:importScripts&gt; outputs.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">getFileImportString</span>(filename)

<span class="syntax1">// Page initialization function, it is called upon page load.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">init</span>()

<span class="syntax1">// Page deinitialization function, it is called upon page unload.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">deinit</span>()

<span class="syntax1">// Searches for system form in HTML page and registers it in the current</span>
<span class="syntax1">// AraneaPage object as active systemForm. Also returns the found form.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">findSystemForm</span>()

<span class="syntax1">// RSH initialization for state versioning. Has effect only when "aranea-rsh.js"</span>
<span class="syntax1">// is also included in the page.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">initRSHURL</span>()

<span class="syntax1">// Properties for loading message:</span>
AraneaPage<span class="syntax11">.</span>loadingMessageContent<span class="syntax11">:</span> <span class="syntax3">'Loading...'</span><span class="syntax11">,</span>
AraneaPage<span class="syntax11">.</span>loadingMessageId<span class="syntax11">:</span> <span class="syntax3">'aranea-loading-message'</span><span class="syntax11">,</span>
AraneaPage<span class="syntax11">.</span>reloadOnNoDocumentRegions<span class="syntax11">:</span> <span class="syntax4">false</span><span class="syntax11">,</span>

<span class="syntax1">// Add a handler that is invoked for custom data region in updateregions AJAX</span>
<span class="syntax1">// request. process() function will be invoked on the handler</span>
<span class="syntax1">// during processing the response. Data specific to this handler will be</span>
<span class="syntax1">// passed as the first parameter to that function (String).</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">addRegionHandler</span>(key<span class="syntax11">,</span> handler)

<span class="syntax1">// Process response of an updateregions AJAX request. Should be called only</span>
<span class="syntax1">// on successful response. Invokes registered region handlers.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">processResponse</span>(responseText)

AraneaPage<span class="syntax11">.</span><span class="syntax9">handleRequestException</span>(request<span class="syntax11">,</span> exception)

<span class="syntax1">// Create or show loading message at the top corner of the document. Called</span>
<span class="syntax1">// before initiating an updateregions Ajax.Request.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">showLoadingMessage</span>()

<span class="syntax1">// Hide loading message. Called after the completion of updateregions Ajax.Request.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">hideLoadingMessage</span>()

<span class="syntax1">// Builds the loading message that is by default shown in the right-top corner.</span>
<span class="syntax1">// The default loading message built here also depends on aranea.css.</span>
<span class="syntax1">// This method is always called during AJAX request. You are free to override it.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">buildLoadingMessage</span>()

<span class="syntax1">// Perform positioning of loading message (if needed in addition to CSS).</span>
<span class="syntax1">// Called before making the message element visible. This implementation</span>
<span class="syntax1">// provides workaround for IE 6, which doesn't support</span>
<span class="syntax1">// &lt;code&gt;position: fixed&lt;/code&gt; CSS attribute; the element is manually</span>
<span class="syntax1">// positioned at the top of the document. If you don't need this, overwrite</span>
<span class="syntax1">// this with an empty function:</span>
<span class="syntax1">// </span>
</span></pre><code class="code">Object.extend(AraneaPage, { positionLoadingMessage: Prototype.emptyFunction });</code><pre><span class="syntax0">
AraneaPage<span class="syntax11">.</span><span class="syntax9">positionLoadingMessage</span>(element)

<span class="syntax1">// The default request callback used by AraneaPage.downloadFile, which receives URL or 'error' to</span>
<span class="syntax1">// do something with it. By default, the URL is used to load that file, and nothing is done with</span>
<span class="syntax1">// 'error'. This can be customized, of course.</span>
<span class="syntax1">// transport - The Prototype AJAX request object to read server response.</span>
<span class="syntax1">// Returns always false.</span>
<span class="syntax1">// Since 1.2.3</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">fileDownloadActionCallback</span>(transport)

<span class="syntax1">// This method handles file downloading with AJAX (action) request. This expects that there is an</span>
<span class="syntax1">// FileDownloadActionListener registered on the server side, and the given data is sent to invoke</span>
<span class="syntax1">// that listener. The callback method used is AraneaPage.fileDownloadActionCallback, however, it</span>
<span class="syntax1">// can be redefined.</span>
<span class="syntax1">// Since 1.2.3</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">downloadFile</span>(actionId<span class="syntax11">,</span> actionTarget<span class="syntax11">,</span> actionParam)

<span class="syntax1">// ============================================================================</span>
<span class="syntax1">//                           FORM SUBMITTERS</span>
<span class="syntax1">// ============================================================================</span>

<span class="syntax1">// Here are three submitter classes for the standard HTTP submit, AJAX update</span>
<span class="syntax1">// region submit, and AJAX overlay submit.</span>

<span class="syntax1">// The standard HTTP submitter. Whether it's POST or GET depends on the</span>
<span class="syntax1">// "method" attribute of the "form" element. (The default is GET submit.)</span>
<span class="syntax6">var</span> DefaultAraneaSubmitter <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(

  <span class="syntax1">// Local variables:</span>

  systemForm<span class="syntax11">:</span> <span class="syntax4">null</span><span class="syntax11">,</span>

  widgetId<span class="syntax11">:</span> <span class="syntax4">null</span><span class="syntax11">,</span>

  eventId<span class="syntax11">:</span> <span class="syntax4">null</span><span class="syntax11">,</span>

  eventParam<span class="syntax11">:</span> <span class="syntax4">null</span><span class="syntax11">,</span>

  <span class="syntax1">// Constructor:</span>

  <span class="syntax9">initialize</span>(form)

  <span class="syntax1">// Methods:</span>

  <span class="syntax1">// "Private" method that is called by event to store event data in local</span>
  <span class="syntax1">// variables.</span>
  <span class="syntax9">storeEventData</span>(element)

  <span class="syntax1">// Starts a submitting process. Here data is collected. Main work is done by</span>
  <span class="syntax1">// event_4().</span>
  <span class="syntax9">event</span>(element)

  <span class="syntax1">// Does a plain form submit using given parameters.</span>
  <span class="syntax9">event_4</span>(systemForm<span class="syntax11">,</span> eventId<span class="syntax11">,</span> widgetId<span class="syntax11">,</span> eventParam)
<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// This class extends the default submitter, and overrides event() to initiate</span>
<span class="syntax1">// an AJAX request and to process result specifically for the overlay mode.</span>
<span class="syntax1">// It expects that aranea-modalbox.js is successfully loaded.</span>
<span class="syntax6">var</span> DefaultAraneaOverlaySubmitter <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(DefaultAraneaSubmitter<span class="syntax11">,</span> <span class="syntax11">{</span>

  <span class="syntax9">event</span>(element)

  <span class="syntax9">event_7</span>(systemForm<span class="syntax11">,</span> eventId<span class="syntax11">,</span> eventTarget<span class="syntax11">,</span> eventParam<span class="syntax11">,</span> eventPrecondition<span class="syntax11">,</span> eventUpdateRegions)

<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// This class extends the default submitter, and overrides event() to initiate</span>
<span class="syntax1">// an AJAX request and to process result specifically for update regions.</span>
<span class="syntax6">var</span> DefaultAraneaAJAXSubmitter <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(DefaultAraneaSubmitter<span class="syntax11">,</span> <span class="syntax11">{</span>

  <span class="syntax1">// Local variable:</span>
  updateRegions<span class="syntax11">:</span> <span class="syntax4">null</span><span class="syntax11">,</span>

  <span class="syntax9">event</span>(element)

  <span class="syntax9">event_5</span>(systemForm<span class="syntax11">,</span> eventId<span class="syntax11">,</span> widgetId<span class="syntax11">,</span> eventParam<span class="syntax11">,</span> updateRegions)

  <span class="syntax1">// Returns AJAX parameters for the request.</span>
  <span class="syntax9">getAjaxParameters</span>(neededAraTransactionId<span class="syntax11">,</span> ajaxRequestId<span class="syntax11">,</span>
                  updateRegions<span class="syntax11">,</span> neededAraClientStateId)

  <span class="syntax1">// Is called when the request completes successfully.</span>
  <span class="syntax9">onAjaxSuccess</span>(ajaxRequestId<span class="syntax11">,</span> transport)

  <span class="syntax1">// Is called when the request is completed.</span>
  <span class="syntax9">onAjaxComplete</span>(transport)

  <span class="syntax1">// Is called when the request fails.</span>
  <span class="syntax9">onAjaxFailure</span>(transport)

  <span class="syntax1">// Is called when an exception is called during request.</span>
  <span class="syntax9">onAjaxException</span>(request<span class="syntax11">,</span> exception)

<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// The delay after which Ajax.Request onComplete expects all the DOM updates</span>
<span class="syntax1">// to have taken place, in milliseconds.</span>
DefaultAraneaAJAXSubmitter<span class="syntax11">.</span>contentUpdateWaitDelay <span class="syntax11">=</span> <span class="syntax12">30</span>

<span class="syntax1">// An HTTP transport processor looking for state versioning info.</span>
DefaultAraneaAJAXSubmitter<span class="syntax11">.</span><span class="syntax9">ResponseHeaderProcessor</span>(transport)

<span class="syntax1">// Region handler that updates transaction id of system form.</span>
AraneaPage<span class="syntax11">.</span>TransactionIdRegionHandler <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(<span class="syntax11">{</span>
  <span class="syntax9">process</span>(content)
<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// The Region handler that updates DOM element content.</span>
AraneaPage<span class="syntax11">.</span>DocumentRegionHandler <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(<span class="syntax11">{</span>
  <span class="syntax9">process</span>(content)
<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// Does DOM cleanup to avoid memory leaks when content is updated. An</span>
<span class="syntax1">// "invisible" second parameter is used to detect whether the clean-up is</span>
<span class="syntax1">// done with the element or not. If arguments.length = 1 then the input</span>
<span class="syntax1">// element is not changed, only its child-elements will be checked.</span>
<span class="syntax1">// Override this method (Object.extend()) to create your own cleanups.</span>
AraneaPage<span class="syntax11">.</span>DocumentRegionHandler<span class="syntax11">.</span><span class="syntax9">doDOMCleanup</span>(element)

<span class="syntax1">// Handles messages that came with an AJAX request. These are the messages from</span>
<span class="syntax1">// the MessageContext. You do not need to put "messages" into your update</span>
<span class="syntax1">// regions if you have marked your messages with class "aranea-messages" and</span>
<span class="syntax1">// attribute "arn-msgs-type" with value of message type, because this handler</span>
<span class="syntax1">// knows how to update these messages.</span>
<span class="syntax1">// You may also override certain functionality to customize this class for your</span>
<span class="syntax1">// own needs.</span>
AraneaPage<span class="syntax11">.</span>MessageRegionHandler <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(<span class="syntax11">{</span>

  regionClass<span class="syntax11">:</span> <span class="syntax3">'.aranea-messages'</span>

  regionTypeAttribute<span class="syntax11">:</span> <span class="syntax3">'arn-msgs-type'</span>

  messageSeparator<span class="syntax11">:</span> <span class="syntax3">'&lt;br/&gt;'</span>

  <span class="syntax9">process</span>(content)

  <span class="syntax1">// The input parameter is a map of messages by message type. This method goes</span>
  <span class="syntax1">// through all elements where class="aranea-messages", adds new messages to</span>
  <span class="syntax1">// them or hides messages if they were not in the response data.</span>
  <span class="syntax9">updateRegions</span>(messagesByType)

  <span class="syntax1">// This method adds messages (array) to given region (element).</span>
  <span class="syntax9">showMessageRegion</span>(region<span class="syntax11">,</span> messages)

  <span class="syntax1">// Hides given message region, and changes its content if necessary.</span>
  <span class="syntax9">hideMessageRegion</span>(region)

  <span class="syntax1">// Looks up the element that contains messages in given region.</span>
  <span class="syntax1">// Its content will be updated with new messages.</span>
  <span class="syntax9">findContentElement</span>(region)

  <span class="syntax1">// Looks up the element of the region that is intented for wrapping the messages.</span>
  <span class="syntax1">// It will be hidden, if no messages were in the response data.</span>
  <span class="syntax9">findDisplayElement</span>(region)

  <span class="syntax1">// Formats the messages (array) and returns them as String where messages are</span>
  <span class="syntax1">// separated by messageSeparator. The result is used to update the content of</span>
  <span class="syntax1">// content element (findContentElement(region)).</span>
  <span class="syntax9">buildRegionContent</span>(messages)
<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// Region handler that opens popup windows.</span>
AraneaPage<span class="syntax11">.</span>PopupRegionHandler <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(<span class="syntax11">{</span>

  <span class="syntax9">process</span>(content)

  <span class="syntax9">openPopups</span>(popups)

<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// Region handler that forces a reload of the page by submitting the system</span>
<span class="syntax1">// form.</span>
AraneaPage<span class="syntax11">.</span>ReloadRegionHandler <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(<span class="syntax11">{</span>
  <span class="syntax9">process</span>(content)
<span class="syntax11">}</span>)<span class="syntax11">;</span>

<span class="syntax1">// A region handler for form background validation.</span>
AraneaPage<span class="syntax11">.</span>FormBackgroundValidationRegionHandler <span class="syntax11">=</span> Class<span class="syntax11">.</span><span class="syntax9">create</span>(<span class="syntax11">{</span>

  <span class="syntax9">process</span>(content)

  <span class="syntax9">getParentSpan</span>(formelement)

  <span class="syntax9">getLabelSpan</span>(formelement)

  <span class="syntax9">getParentElement</span>(el<span class="syntax11">,</span> tagName<span class="syntax11">,</span> className)

<span class="syntax11">}</span>)<span class="syntax11">;</span>


<span class="syntax1">// Aranea page object is accessible in two ways: _ap and araneaPage().</span>
<span class="syntax6">var</span> _ap <span class="syntax11">=</span> <span class="syntax6">new</span> <span class="syntax9">AraneaPage</span>()<span class="syntax11">;</span>
<span class="syntax6">function</span> <span class="syntax9">araneaPage</span>() <span class="syntax11">{</span>
  <span class="syntax6">return</span> _ap<span class="syntax11">;</span>
<span class="syntax11">}</span>
</span></pre></pre><p>
      </p><p>
			Since Aranea 1.2.2, the JavaScript API also includes submit callback API, which can be
			used to provide more control over submitting. It contains methods that can be overridden
			to change or add some some behaviour.
		</p><p>
			</p><pre class="programlisting"><pre><span class="syntax0">
<span class="syntax1">/**</span>
<span class="syntax1"> * A common callback for requests. The callback handles common data manipulation and validation.</span>
<span class="syntax1"> * This callback should be used to add some custom features to submit data or submit response.</span>
<span class="syntax1"> */</span>

<span class="syntax1">// An internal method that is used to create request data object, which has following properties:</span>
<span class="syntax1">// type - (AraneaPage.)TYPE_REQ_ACTION, TYPE_REQ_SUBMIT, TYPE_REQ_AJAX, TYPE_REQ_OVERLAY.</span>
<span class="syntax1">// id - the event/action id.</span>
<span class="syntax1">// targetId - the event/action listener full path.</span>
<span class="syntax1">// param - an optional parameter for the event/action listener.</span>
<span class="syntax1">// form - the system form that is used to handle the request.</span>
<span class="syntax1">// element - the event source element (available only when the type is event)</span>
<span class="syntax1">// eventUpdateRgns - specified update regions (as string, available only when the type is event).</span>
<span class="syntax1">// actionCallback - a function that is called after action request completes.</span>
<span class="syntax1">// actionOptions - options that are passed to action Ajax.Request (see Prototype doc).</span>
<span class="syntax1">// actionSync - a boolean indication whether the action request should be synchronous (default: false).</span>
<span class="syntax1">// actionExtraParams - a string specifying additional action request params (e.g. 'p1=v1&amp;p2=v2').</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">getData</span>(args)<span class="syntax11">;</span>

<span class="syntax1">// The only method that element-submitters should call. It takes the type of request, the form</span>
<span class="syntax1">// containing the element to be submitted, and the function that does the submit work.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">doRequest</span>(type<span class="syntax11">,</span> form<span class="syntax11">,</span> element<span class="syntax11">,</span> eventHandler)
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">doRequest</span>(type<span class="syntax11">,</span> form<span class="syntax11">,</span> eventId<span class="syntax11">,</span> targetId<span class="syntax11">,</span> eventParam<span class="syntax11">,</span> eventHandler)
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">doRequest</span>(type<span class="syntax11">,</span> form<span class="syntax11">,</span> actionId<span class="syntax11">,</span> targetId<span class="syntax11">,</span> actionParam<span class="syntax11">,</span> actionCallback<span class="syntax11">,</span>
        actionOptions<span class="syntax11">,</span> sync<span class="syntax11">,</span> extraParams)

<span class="syntax1">// A callback to optionally modify data that is passed to request handlers.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">processRequestHandlerData</span>(data)<span class="syntax11">;</span>

<span class="syntax1">// This method is called to return the result of element-submit. Here is a nice place to implement</span>
<span class="syntax1">// custom features depending on the element or request type. Feel free to override.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">getRequestHandlerResult</span>(type<span class="syntax11">,</span> element<span class="syntax11">,</span> result)<span class="syntax11">;</span>

<span class="syntax1">// The method that is called by submitters to store submit data in the form.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">prepare</span>(type<span class="syntax11">,</span> form<span class="syntax11">,</span> id<span class="syntax11">,</span> targetId<span class="syntax11">,</span> param)

<span class="syntax1">// Processes the request data. It calls following methods of this RequestCallback class:</span>
<span class="syntax1">// 1. processRequestData - to optionally modify the submit data; </span>
<span class="syntax1">// 2. storeRequestData - to store the submit data in the form (if submit is allowed).</span>
<span class="syntax1">// 3. Adds isRequestAllowed, beforeRequest, afterRequest callbacks to data.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">prepareData</span>(data)

<span class="syntax1">// A callback to optionally modify request data.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">processRequestData</span>(data)

<span class="syntax1">// A callback to store request data in the form.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">storeRequestData</span>(data)

<span class="syntax1">// A callback that is checked to enable or disable request. Feel free to override.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">isRequestAllowed</span>(data) <span class="syntax11">{</span>

<span class="syntax1">// A callback that is called always before each request (no matter whether it is AJAX or not).</span>
<span class="syntax1">// This method includes default behaviour. Feel free to override.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">beforeRequest</span>(data)

<span class="syntax1">// A callback that is called after each request (no matter whether it is AJAX or not).</span>
<span class="syntax1">// This method includes default behaviour. Feel free to override.</span>
AraneaPage<span class="syntax11">.</span>RequestCallback<span class="syntax11">.</span><span class="syntax9">afterRequest</span>(data)
                        
</span></pre></pre><p>
		</p><p>
			The Aranea 1.2.2 release also introduced automatic file upload JavaScript API. You
			usually don't have to modify it except for the upload options part, especially the
			<code class="literal">onComplete</code> function. However, here's the entire API.
		</p><pre class="programlisting"><pre><span class="syntax0">
<span class="syntax1">// This method returns the URL where to submit the file. The element parameter is not used, but</span>
<span class="syntax1">// you can modify the method to use the parameter. </span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">getAjaxUploadURL</span>(element)<span class="syntax11">;</span>

<span class="syntax1">// This method provides the data as { formField1: value1, formField2: value2, ...} that will be</span>
<span class="syntax1">// added to the form later. This data should be needed in the query.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">getAjaxUploadFormData</span>(systemForm<span class="syntax11">,</span> element)

<span class="syntax1">// This method is called by AraneaPage.init() to initialize file inputs with AJAX uplaod features.</span>
<span class="syntax1">// You can modify here the logic that is used for file input lookup.</span>
AraneaPage<span class="syntax11">.</span><span class="syntax9">ajaxUploadInit</span>()

<span class="syntax1">// These are the default options that are used with the AJAX file upload. Feel free to override them.</span>
AraneaPage<span class="syntax11">.</span>AjaxUploadOptions <span class="syntax11">=</span> <span class="syntax11">{</span>
        disabled<span class="syntax11">:</span> <span class="syntax4">false</span><span class="syntax11">,</span>
        autoSubmit<span class="syntax11">:</span> <span class="syntax4">true</span><span class="syntax11">,</span>
        onChange<span class="syntax11">:</span> <span class="syntax6">function</span>(file<span class="syntax11">,</span> extension<span class="syntax11">,</span> options) <span class="syntax11">{},</span>
        onSubmit<span class="syntax11">:</span> <span class="syntax6">function</span>(file<span class="syntax11">,</span> extension<span class="syntax11">,</span> options) <span class="syntax11">{},</span>
        onComplete<span class="syntax11">:</span> <span class="syntax6">function</span>(file<span class="syntax11">,</span> responseText<span class="syntax11">,</span> failMsg<span class="syntax11">,</span> options) <span class="syntax11">{</span>
                _ap<span class="syntax11">.</span><span class="syntax9">debug</span>(<span class="syntax3">'File upload completed. File="'</span> <span class="syntax11">+</span> file <span class="syntax11">+</span> <span class="syntax3">'"; response="'</span> <span class="syntax11">+</span> responseText <span class="syntax11">+</span> <span class="syntax3">'".'</span>)<span class="syntax11">;</span>
                <span class="syntax6">if</span> (responseText <span class="syntax11">==</span> <span class="syntax3">'OK'</span>) <span class="syntax11">{</span> <span class="syntax1">// Otherwise responseText == 'FAIL'</span>
                        <span class="syntax1">// Hides the file input and shows a link instead with the file name. Once the link is</span>
                        <span class="syntax1">// clicked, the link will be removed and the file input will be shown again.</span>
                        <span class="syntax9">$</span>(options<span class="syntax11">.</span>target)<span class="syntax11">.</span><span class="syntax9">hide</span>()<span class="syntax11">.</span><span class="syntax9">insert</span>(<span class="syntax11">{</span>after<span class="syntax11">:</span>
                                <span class="syntax3">'&lt;a href="#" onclick="$(this).previous().show().next().remove(); return false;"&gt;'</span> <span class="syntax11">+</span> file <span class="syntax11">+</span> <span class="syntax3">'&lt;/a&gt;'</span><span class="syntax11">}</span>)<span class="syntax11">;</span>
                <span class="syntax11">}</span> <span class="syntax6">else</span> <span class="syntax11">{</span>
                        <span class="syntax6">if</span> (<span class="syntax11">!</span>failMsg) <span class="syntax11">{</span>
                                failMsg <span class="syntax11">=</span> <span class="syntax3">'Uploading file "'</span> <span class="syntax11">+</span> file <span class="syntax11">+</span> <span class="syntax3">'" failed. There could have been a '</span>
                                        <span class="syntax11">+</span> <span class="syntax3">'problem\nwith the connection or the file was too big. Please try again!'</span><span class="syntax11">;</span>
                        <span class="syntax11">}</span>
                        <span class="syntax9">alert</span>(failMsg)<span class="syntax11">;</span>
                <span class="syntax11">}</span>
        <span class="syntax11">}</span>
<span class="syntax11">}</span>
                
</span></pre></pre></div></div></div></body></html>